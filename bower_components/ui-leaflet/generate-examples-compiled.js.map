{"version":3,"sources":["generate-examples.js"],"names":[],"mappings":"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","file":"generate-examples-compiled.js","sourcesContent":["#!/usr/bin/env node\n\n'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar mkdirp = require('mkdirp');\nvar jsdom = require('jsdom');\nvar Q = require('q');\n\nvar onlyStandAlone = [\n    \"0117-basic-routing-show-hide-map-example.html\"\n];\n\nvar isAnExample = function(filename) {\n    if (filename === '0000-viewer.html') {\n      return false;\n    }\n    return /[0-9][0-9][0-9][0-9].*\\.html/.test(filename);\n};\n\nvar isJavascript = function(filename) {\n    return /.*\\.js/.test(filename);\n};\n\nvar deleteFileIfJavascript = function(filename) {\n    var df = Q.defer();\n    if (isJavascript(filename)) {\n        fs.unlink(filename, function() {\n            df.resolve();\n        });\n    } else {\n        df.resolve();\n    }\n\n    return df.promise;\n};\n\nvar cleanJavascriptFilesFromControllersDirectory = function(dir) {\n    var df = Q.defer();\n    fs.readdir(dir, function(err, list) {\n        var l = [];\n        var files = list.map(function(file) {\n            return path.join(dir, file);\n        });\n        files.forEach(deleteFileIfJavascript);\n        Q.allSettled(l).then(function(result) {\n            df.resolve();\n        });\n    });\n    return df.promise;\n};\n\nvar writeController = function(script, examplefile, controllers_directory) {\n    var df = Q.defer();\n    var scriptLines = script.split('\\n');\n    var outfilename;\n    var outScript = [];\n    for (var i = 0; i < scriptLines.length; i++) {\n\n        var line = scriptLines[i];\n\n        // Remove empty lines\n        if (line.replace(/^\\s+|\\s+$/g, '') === '') {\n            continue;\n        }\n\n        // Remove the module initializacion line\n        if (line.search('angular.module') !== -1) {\n            continue;\n        }\n\n        // Extract controller name\n        if (line.search('app.controller') !== -1 && !outfilename) {\n            var controller = line.match(/app.controller\\((\\'|\\\")([^'\"]*)/);\n            if (controller && controller.length > 2 && controller[2]) {\n                outfilename = controller[2] + '.js';\n            }\n        }\n\n        outScript.push(line);\n    }\n\n    if (outfilename) {\n        outfilename = path.join(controllers_directory, outfilename);\n        if (!fs.existsSync(outfilename)) {\n            fs.writeFile(outfilename, outScript.join('\\n'), function() {\n                df.resolve();\n            });\n        } else {\n            console.log('The controller name is duplicated: ' + outfilename)\n            df.reject();\n        }\n    } else {\n        console.log('Can\\'t identify the controller name in the example ' + examplefile)\n        df.reject();\n    }\n\n    return df.promise;\n};\n\nvar generateControllersFromExamples = function(examples_directory, controllers_directory) {\n    var df = Q.defer();\n    fs.readdir(examples_directory, function(err, list) {\n        var l = [];\n        list.forEach(function(filename) {\n            if (isAnExample(filename)) {\n                var html = fs.readFileSync(path.join(__dirname, 'examples', filename));\n                jsdom.env({\n                    html: html.toString(),\n                    done: function(err, window) {\n                        var scripts = window.document.getElementsByTagName('script');\n                        var last = scripts.length -1;\n                        var script = scripts[last].innerHTML;\n                        l.push(writeController(script, filename, controllers_directory));\n                    }\n                });\n            }\n        });\n\n        Q.allSettled(l).then(function() {\n            df.resolve();\n        });\n    });\n\n    return df.promise;\n};\n\nvar extractId = function(filename) {\n    var arr = filename.replace('.html', '').split('-');\n    arr.splice(0,2);\n    return arr.join('-');\n};\n\nvar extractTitle = function(filename) {\n    var html = fs.readFileSync(path.join(__dirname, 'examples', filename));\n    var title;\n    var arr = html.toString().split('\\n');\n\n    for (var i = 0; i< arr.length; i++) {\n        var line = arr[i];\n\n        if (line.search('<h1>') !== -1) {\n            title = line.replace('<h1>', '').replace('</h1>', '').replace(/^ */, '');\n        }\n    }\n\n    return title;\n};\n\nvar extractDescription = function(filename) {\n\n};\n\nvar extractDate = function(filename) {\n    var stats = fs.statSync(filename);\n    return stats.mtime;\n};\n\nvar generateExamplesJSONFile = function(examples_directory, json_file) {\n    var df = Q.defer();\n    var examples = {};\n    fs.readdir(examples_directory, function(err, list) {\n        list.forEach(function(filename) {\n            if (isAnExample(filename)) {\n                var section = filename.split('-')[1];\n                var id = extractId(filename);\n                var extUrl = filename;\n                var title = extractTitle(filename);\n                var description = extractDescription(filename);\n                var date = extractDate(path.join(examples_directory, filename));\n\n                if (!(section in examples)) {\n                    examples[section] = [];\n                }\n                examples[section].push({\n                    date: date,\n                    section: section,\n                    onlyStandAlone: onlyStandAlone.indexOf(extUrl) !== -1,\n                    id: '/' + section + '/' + id,\n                    extUrl: extUrl,\n                    title: title,\n                    description: description\n                });\n            }\n        });\n\n        fs.writeFile(json_file, JSON.stringify(examples, null, 4), function(err) {\n            df.resolve();\n        });\n    });\n\n    return df.promise;\n};\n\nvar controllers_directory = path.join(__dirname, 'examples', 'js', 'controllers');\nmkdirp(controllers_directory, function(err) {\n    cleanJavascriptFilesFromControllersDirectory(controllers_directory).then(function() {\n        var examples_directory = path.join(__dirname, 'examples');\n        generateControllersFromExamples(examples_directory, controllers_directory).then(function() {\n            var json_file = path.join(__dirname, 'examples', 'json', 'examples.json');\n            generateExamplesJSONFile(examples_directory, json_file);\n        });\n    });\n});\n"]}