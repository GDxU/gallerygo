{"version":3,"sources":["ui-leaflet_dev_mapped.js"],"names":[],"mappings":"+NAAA;;;;EAKC,UAAS,OAAT,CAAiB,CAClB,aACA,aAEA,QAAQ,MAAR,CAAe,YAAf,CAA6B,CAAC,YAAD,CAA7B,EAA6C,SAA7C,CAAuD,SAAvD,CAAkE,SAAU,EAAV,CAAc,WAAd,CAA2B,kBAA3B,CAA+C,cAA/C,CAA+D,gBAA/D,CAAiF,CAC/I,MAAO,CACH,SAAU,IADP,CAEH,QAAS,IAFN,CAGH,MAAO,CACH,OAAQ,GADL,CAEH,SAAU,GAFP,CAGH,SAAU,GAHP,CAIH,UAAW,GAJR,CAKH,OAAQ,GALL,CAMH,QAAS,GANN,CAOH,OAAQ,GAPL,CAQH,QAAS,GARN,CASH,MAAO,GATJ,CAUH,MAAO,GAVJ,CAWH,OAAQ,GAXL,CAYH,SAAU,GAZP,CAaH,YAAa,GAbV,CAcH,eAAgB,GAdb,CAeH,aAAc,GAfX,CAgBH,GAAI,GAhBD,CAHJ,CAqBH,WAAY,IArBT,CAsBH,SAAU,kEAtBP,CAuBH,WAAY,QAAS,WAAT,CAAoB,MAApB,CAA4B,CACpC,KAAK,WAAL,CAAmB,GAAG,KAAH,EAAnB,CACA,KAAK,MAAL,CAAc,UAAY,CACtB,MAAO,MAAK,WAAL,CAAiB,OAAxB,CACH,CAFD,CAIA,KAAK,eAAL,CAAuB,UAAY,CAC/B,MAAO,OAAP,CACH,CAFD,CAGH,CAhCE,CAkCH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,IAArC,CAA2C,CAC7C,GAAI,WAAY,eAAe,SAA/B,CACI,SAAW,mBAAmB,WAAnB,CAA+B,MAAM,QAArC,CAA+C,MAAM,EAArD,CADf,CAEI,UAAY,iBAAiB,qBAAjB,EAFhB,CAGI,UAAY,iBAAiB,SAHjC,CAKA,MAAM,KAAN,CAAc,MAAM,EAApB,CACA,YAAY,oBAAZ,CAAiC,EAAjC,CAAqC,MAAM,EAA3C,EAEA;AACA,QAAS,YAAT,EAAuB,CACnB,GAAI,MAAM,MAAM,KAAZ,CAAJ,CAAwB,CACpB,QAAQ,GAAR,CAAY,OAAZ,CAAqB,MAAM,KAA3B,EACH,CAFD,IAEO,CACH,QAAQ,GAAR,CAAY,OAAZ,CAAqB,MAAM,KAAN,CAAc,IAAnC,EACH,CACJ,CAED,QAAS,aAAT,EAAwB,CACpB,GAAI,MAAM,MAAM,MAAZ,CAAJ,CAAyB,CACrB,QAAQ,GAAR,CAAY,QAAZ,CAAsB,MAAM,MAA5B,EACH,CAFD,IAEO,CACH,QAAQ,GAAR,CAAY,QAAZ,CAAsB,MAAM,MAAN,CAAe,IAArC,EACH,CACJ,CAED;AACA,GAAI,KAAM,GAAI,GAAE,GAAN,CAAU,QAAQ,CAAR,CAAV,CAAsB,mBAAmB,sBAAnB,CAA0C,MAAM,EAAhD,CAAtB,CAAV,CACA,KAAK,WAAL,CAAiB,OAAjB,CAAyB,GAAzB,EAEA;AACA;AACA,GAAI,UAAU,MAAM,KAAhB,CAAJ,CAA4B,CACxB,cAEA,MAAM,MAAN,CAAa,UAAY,CACrB,MAAO,SAAQ,CAAR,EAAW,YAAX,CAAwB,OAAxB,CAAP,CACH,CAFD,CAEG,UAAY,CACX,cACA,IAAI,cAAJ,GACH,CALD,EAMH,CAED;AACA;AACA,GAAI,UAAU,MAAM,MAAhB,CAAJ,CAA6B,CACzB,eAEA,MAAM,MAAN,CAAa,UAAY,CACrB,MAAO,SAAQ,CAAR,EAAW,YAAX,CAAwB,QAAxB,CAAP,CACH,CAFD,CAEG,UAAY,CACX,eACA,IAAI,cAAJ,GACH,CALD,EAMH,CAED,GAAI,CAAC,UAAU,MAAM,MAAhB,CAAD,EAA4B,CAAC,UAAU,MAAM,QAAhB,CAAjC,CAA4D,CACxD,IAAI,OAAJ,CAAY,CAAC,SAAS,MAAT,CAAgB,GAAjB,CAAsB,SAAS,MAAT,CAAgB,GAAtC,CAAZ,CAAwD,SAAS,MAAT,CAAgB,IAAxE,EACH,CAED;AACA,GAAI,CAAC,UAAU,MAAM,KAAhB,CAAD,EAA2B,CAAC,UAAU,MAAM,MAAhB,CAAhC,CAAyD,CACrD,GAAI,cAAe,EAAE,SAAF,CAAY,SAAS,SAArB,CAAgC,SAAS,gBAAzC,CAAnB,CACA,aAAa,KAAb,CAAmB,GAAnB,EACA,YAAY,QAAZ,CAAqB,YAArB,CAAmC,MAAM,EAAzC,EACH,CAED;AACA,GAAI,UAAU,IAAI,WAAd,GAA8B,UAAU,SAAS,mBAAnB,CAAlC,CAA2E,CACvE,IAAI,WAAJ,CAAgB,WAAhB,CAA4B,SAAS,mBAArC,EACH,CAED,GAAI,UAAU,IAAI,WAAd,GAA8B,SAAS,WAAT,GAAyB,KAA3D,CAAkE,CAC9D,IAAI,WAAJ,CAAgB,UAAhB,CAA2B,GAA3B,EACH,CAED,GAAI,UAAU,IAAI,iBAAd,GAAoC,UAAU,SAAS,iBAAnB,CAApC,EAA6E,SAAS,iBAAT,GAA+B,KAAhH,CAAuH,CACnH,IAAI,iBAAJ,CAAsB,UAAtB,CAAiC,GAAjC,EACH,CAED;AACA,GAAI,CAAC,UAAU,MAAM,cAAhB,CAAL,CAAsC,CAClC,GAAI,OAAQ,WAAZ,CACA,UAAU,GAAV,CAAe,MAAM,EAArB,CAAyB,SAAzB,CAAoC,WAApC,CAAiD,KAAjD,CAAwD,KAAxD,EACH,CAED;AACA,IAAI,SAAJ,CAAc,UAAY,CACtB,YAAY,MAAZ,CAAmB,GAAnB,CAAwB,MAAM,EAA9B,EACH,CAFD,EAIA,MAAM,GAAN,CAAU,UAAV,CAAsB,UAAY,CAC9B,mBAAmB,KAAnB,GACA,IAAI,MAAJ,GACA,YAAY,YAAZ,CAAyB,MAAM,EAA/B,EACH,CAJD,EAMA;AACA;AACA;AACA,MAAM,GAAN,CAAU,gBAAV,CAA4B,UAAY,CACpC,IAAI,cAAJ,GACH,CAFD,EAGH,CAzIE,CAAP,CA2IH,CA5ID,EA8IA,aAEA,CAAC,UAAY,CACT,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,cAArC,CAAqD,CAAC,UAAY,CAC9D,GAAI,cAAe,QAAS,aAAT,EAAwB,CACvC,KAAK,SAAL,CAAiB,EAAjB,CACH,CAFD,CAIA,aAAa,SAAb,CAAyB,CACrB,iBAAkB,QAAS,iBAAT,CAA0B,IAA1B,CAAgC,QAAhC,CAA0C,KAA1C,CAAiD,CAC/D,GAAI,MAAO,EAAX,CACA,GAAI,WAAY,UAAU,MAA1B,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,SAApB,CAA+B,GAA/B,CAAoC,CAChC,KAAK,IAAL,CAAU,UAAU,CAAV,CAAV,EACH,CACD,KAAO,KAAK,MAAL,CAAc,CAAd,CAAkB,KAAK,MAAL,CAAY,CAAZ,CAAe,KAAK,MAAL,CAAc,CAA7B,CAAlB,CAAoD,EAA3D,CACA,GAAI,MAAO,MAAK,SAAL,CAAe,IAAf,CAAP,GAAgC,WAApC,CAAiD,CAC7C,KAAK,SAAL,CAAe,IAAf,EAAqB,IAArB,CAA0B,CAAE,MAAO,KAAT,CAAgB,SAAU,QAA1B,CAAoC,KAAM,IAA1C,CAA1B,EACH,CAFD,IAEO,CACH,KAAK,SAAL,CAAe,IAAf,EAAuB,CAAC,CAAE,MAAO,KAAT,CAAgB,SAAU,QAA1B,CAAoC,KAAM,IAA1C,CAAD,CAAvB,CACH,CACJ,CAboB,CAcrB,oBAAqB,QAAS,oBAAT,CAA6B,IAA7B,CAAmC,QAAnC,CAA6C,KAA7C,CAAoD,CACrE,GAAI,MAAO,MAAK,SAAL,CAAe,IAAf,CAAP,GAAgC,WAApC,CAAiD,CAC7C,GAAI,gBAAiB,KAAK,SAAL,CAAe,IAAf,EAAqB,MAA1C,CACA,GAAI,UAAW,EAAf,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,cAApB,CAAoC,GAApC,CAAyC,CACrC,GAAI,UAAW,KAAK,SAAL,CAAe,IAAf,EAAqB,CAArB,CAAf,CACA,GAAI,SAAS,KAAT,GAAmB,KAAnB,EAA4B,SAAS,QAAT,GAAsB,QAAtD,CAAgE,CAAE,CAAlE,IAAwE,CACpE,SAAS,IAAT,CAAc,QAAd,EACH,CACJ,CACD,KAAK,SAAL,CAAe,IAAf,EAAuB,QAAvB,CACH,CACJ,CA1BoB,CA2BrB,iBAAkB,QAAS,iBAAT,CAA0B,IAA1B,CAAgC,QAAhC,CAA0C,KAA1C,CAAiD,CAC/D,GAAI,MAAO,MAAK,SAAL,CAAe,IAAf,CAAP,GAAgC,WAApC,CAAiD,CAC7C,GAAI,gBAAiB,KAAK,SAAL,CAAe,IAAf,EAAqB,MAA1C,CACA,GAAI,WAAa,SAAb,EAA0B,QAAU,SAAxC,CAAmD,CAC/C,MAAO,gBAAiB,CAAxB,CACH,CACD,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,cAApB,CAAoC,GAApC,CAAyC,CACrC,GAAI,UAAW,KAAK,SAAL,CAAe,IAAf,EAAqB,CAArB,CAAf,CACA,GAAI,CAAC,MAAQ,SAAS,KAAT,GAAmB,KAA3B,CAAmC,IAApC,GAA6C,SAAS,QAAT,GAAsB,QAAvE,CAAiF,CAC7E,MAAO,KAAP,CACH,CACJ,CACJ,CACD,MAAO,MAAP,CACH,CAzCoB,CA0CrB,SAAU,QAAS,SAAT,CAAkB,IAAlB,CAAwB,MAAxB,CAAgC,CACtC,GAAI,gBAAiB,CAArB,CACA,GAAI,OAAQ,CACR,KAAM,IADE,CAER,OAAQ,MAFA,CAAZ,CAIA,GAAI,MAAO,EAAX,CACA,GAAI,WAAY,UAAU,MAA1B,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,SAApB,CAA+B,GAA/B,CAAoC,CAChC,KAAK,IAAL,CAAU,UAAU,CAAV,CAAV,EACH,CACD,KAAO,KAAK,MAAL,CAAc,CAAd,CAAkB,KAAK,MAAL,CAAY,CAAZ,CAAe,KAAK,MAAL,CAAc,CAA7B,CAAlB,CAAoD,EAA3D,CACA,KAAO,CAAC,KAAD,EAAQ,MAAR,CAAe,IAAf,CAAP,CACA,GAAI,MAAO,MAAK,SAAL,CAAe,IAAf,CAAP,GAAgC,WAApC,CAAiD,CAC7C,GAAI,gBAAiB,KAAK,SAAL,CAAe,IAAf,EAAqB,MAA1C,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,cAApB,CAAoC,GAApC,CAAyC,CACrC,GAAI,UAAW,KAAK,SAAL,CAAe,IAAf,EAAqB,CAArB,CAAf,CACA,GAAI,UAAY,SAAS,QAAzB,CAAmC,CAC/B,GAAI,YAAa,KAAK,MAAL,CAAY,SAAS,IAArB,CAAjB,CACA,SAAS,QAAT,CAAkB,KAAlB,CAAwB,SAAS,KAAjC,CAAwC,UAAxC,EACA,gBAAkB,CAAlB,CACH,CACJ,CACJ,CACJ,CAlEoB,CAmErB,UAAW,QAAS,UAAT,EAAqB,CAC5B,GAAI,KAAM,EAAV,CACA,IAAK,GAAI,KAAT,GAAiB,MAAK,SAAtB,CAAiC,CAC7B,GAAI,gBAAiB,KAAK,SAAL,CAAe,IAAf,EAAqB,MAA1C,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,cAApB,CAAoC,GAApC,CAAyC,CACrC,GAAI,UAAW,KAAK,SAAL,CAAe,IAAf,EAAqB,CAArB,CAAf,CACA,KAAO,SAAS,KAAT,EAAkB,SAAS,KAAT,CAAe,SAAjC,CAA6C,SAAS,KAAT,CAAe,SAA5D,CAAwE,WAA/E,CACA,KAAO,gBAAkB,IAAlB,CAAyB,KAAhC,CACH,CACJ,CACD,MAAO,IAAP,CACH,CA9EoB,CAAzB,CAgFA,MAAO,aAAP,CACH,CAtFoD,CAArD,EAsFI,OAtFJ,CAsFY,cAtFZ,CAsF4B,SAAU,YAAV,CAAwB,CAChD,MAAO,IAAI,aAAJ,EAAP,CACH,CAxFD,EAyFH,CA1FD,IA4FA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,sBAArC,CAA6D,SAAU,aAAV,CAAyB,cAAzB,CAAyC,CAElG,GAAI,SAAU,eAAe,OAA7B,CACI,SAAW,eAAe,QAD9B,CAEI,WAAa,eAAe,UAFhC,CAGI,UAAY,eAAe,SAH/B,CAII,KAAO,aAJX,CAMA,QAAS,eAAT,CAAwB,MAAxB,CAAgC,CAC5B,MAAO,SAAQ,SAAR,CAAkB,MAAlB,GAA6B,QAAQ,SAAR,CAAkB,OAAO,SAAzB,CAA7B,EAAoE,QAAQ,SAAR,CAAkB,OAAO,SAAzB,CAApE,EAA2G,QAAQ,QAAR,CAAiB,OAAO,SAAP,CAAiB,GAAlC,CAA3G,EAAqJ,QAAQ,QAAR,CAAiB,OAAO,SAAP,CAAiB,GAAlC,CAArJ,EAA+L,QAAQ,QAAR,CAAiB,OAAO,SAAP,CAAiB,GAAlC,CAA/L,EAAyO,QAAQ,QAAR,CAAiB,OAAO,SAAP,CAAiB,GAAlC,CAAhP,CACH,CAED,MAAO,CACH,oBAAqB,QAAS,oBAAT,CAA6B,MAA7B,CAAqC,CACtD,GAAI,eAAe,MAAf,CAAJ,CAA4B,CACxB,MAAO,GAAE,YAAF,CAAe,CAAC,OAAO,SAAP,CAAiB,GAAlB,CAAuB,OAAO,SAAP,CAAiB,GAAxC,CAAf,CAA6D,CAAC,OAAO,SAAP,CAAiB,GAAlB,CAAuB,OAAO,SAAP,CAAiB,GAAxC,CAA7D,CAAP,CACH,CACJ,CALE,CAOH,cAAe,cAPZ,CASH,sBAAuB,QAAS,sBAAT,CAA+B,WAA/B,CAA4C,CAC/D,GAAI,EAAE,QAAQ,WAAR,GAAwB,YAAY,MAAZ,GAAuB,CAA/C,EAAoD,QAAQ,YAAY,CAAZ,CAAR,CAApD,EAA+E,QAAQ,YAAY,CAAZ,CAAR,CAA/E,EAA0G,YAAY,CAAZ,EAAe,MAAf,GAA0B,CAApI,EAAyI,YAAY,CAAZ,EAAe,MAAf,GAA0B,CAAnK,EAAwK,SAAS,YAAY,CAAZ,EAAe,CAAf,CAAT,CAAxK,EAAuM,SAAS,YAAY,CAAZ,EAAe,CAAf,CAAT,CAAvM,EAAsO,SAAS,YAAY,CAAZ,EAAe,CAAf,CAAT,CAAtO,EAAqQ,SAAS,YAAY,CAAZ,EAAe,CAAf,CAAT,CAAvQ,CAAJ,CAAyS,CACrS,KAAK,KAAL,CAAW,sDAAX,EACA,OACH,CAED,MAAO,CACH,UAAW,CACP,IAAK,YAAY,CAAZ,EAAe,CAAf,CADE,CAEP,IAAK,YAAY,CAAZ,EAAe,CAAf,CAFE,CADR,CAKH,UAAW,CACP,IAAK,YAAY,CAAZ,EAAe,CAAf,CADE,CAEP,IAAK,YAAY,CAAZ,EAAe,CAAf,CAFE,CALR,CAAP,CAUH,CAzBE,CA2BH,wBAAyB,QAAS,wBAAT,CAAiC,QAAjC,CAA2C,CAChE,GAAI,EAAE,UAAU,QAAV,GAAuB,WAAW,SAAS,YAApB,CAAvB,EAA4D,WAAW,SAAS,YAApB,CAA9D,CAAJ,CAAsG,CAClG,KAAK,KAAL,CAAW,+DAAX,EACA,OACH,CAED,GAAI,WAAY,SAAS,YAAT,EAAhB,CACI,UAAY,SAAS,YAAT,EADhB,CAGA,MAAO,CACH,UAAW,CACP,IAAK,UAAU,GADR,CAEP,IAAK,UAAU,GAFR,CADR,CAKH,UAAW,CACP,IAAK,UAAU,GADR,CAEP,IAAK,UAAU,GAFR,CALR,CAAP,CAUH,CA9CE,CAAP,CAgDH,CA5DD,EA8DA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,uBAArC,CAA8D,SAAU,UAAV,CAAsB,aAAtB,CAAqC,cAArC,CAAqD,mBAArD,CAA0E,kBAA1E,CAA8F,CACxJ,GAAI,WAAY,eAAe,SAA/B,CACI,SAAW,eAAe,QAD9B,CAEI,YAAc,oBAAoB,WAFtC,CAGI,UAAY,EAHhB,CAII,YAAc,eAAe,WAAf,CAA6B,cAJ/C,CAKI,KAAO,aALX,CAOA,GAAI,6BAA8B,QAAS,4BAAT,CAAqC,UAArC,CAAiD,QAAjD,CAA2D,KAA3D,CAAkE,CAChG,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,KAA/B,CAAf,CACA,GAAI,CAAC,SAAS,QAAT,CAAkB,MAAlB,CAAyB,OAA9B,CAAuC,CACnC,MAAO,MAAP,CACH,CAED,GAAI,kCAAmC,KAAvC,CAEA,GAAI,SAAS,UAAT,CAAJ,CAA0B,CACtB,OAAO,IAAP,CAAY,UAAZ,EAAwB,OAAxB,CAAgC,SAAU,GAAV,CAAe,CAC3C,GAAI,OAAQ,WAAW,GAAX,CAAZ,CACA,GAAI,CAAC,UAAU,MAAM,YAAhB,CAAD,EAAkC,MAAM,YAAN,CAAmB,cAAnB,GAAsC,KAA5E,CAAmF,CAC/E,iCAAmC,IAAnC,CACH,CACJ,CALD,EAMH,CAED,GAAI,SAAS,QAAT,CAAJ,CAAwB,CACpB,OAAO,IAAP,CAAY,QAAZ,EAAsB,OAAtB,CAA8B,SAAU,GAAV,CAAe,CACzC,GAAI,OAAQ,SAAS,GAAT,CAAZ,CACA,GAAI,CAAC,UAAU,MAAM,WAAhB,CAAD,EAAiC,MAAM,WAAN,CAAkB,cAAlB,GAAqC,KAA1E,CAAiF,CAC7E,iCAAmC,IAAnC,CACH,CACJ,CALD,EAMH,CAED,MAAO,iCAAP,CACH,CA3BD,CA6BA,GAAI,sBAAuB,QAAS,qBAAT,CAA8B,KAA9B,CAAqC,CAC5D,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,KAA/B,CAAf,CACA,GAAI,gBAAiB,CACjB,UAAW,SAAS,QAAT,CAAkB,MAAlB,CAAyB,SADnB,CAEjB,SAAU,SAAS,QAAT,CAAkB,MAAlB,CAAyB,QAFlB,CAGjB,WAAY,KAHK,CAArB,CAMA,QAAQ,MAAR,CAAe,cAAf,CAA+B,SAAS,QAAT,CAAkB,MAAlB,CAAyB,OAAxD,EAEA,GAAI,QAAJ,CACA,GAAI,SAAS,QAAT,CAAkB,MAAlB,EAA4B,UAAU,SAAS,QAAT,CAAkB,MAAlB,CAAyB,OAAnC,CAAhC,CAA6E,CACzE,QAAU,SAAS,QAAT,CAAkB,MAAlB,CAAyB,OAAzB,CAAiC,KAAjC,CAAuC,IAAvC,CAA6C,CAAC,EAAD,CAAK,EAAL,CAAS,cAAT,CAA7C,CAAV,CACH,CAFD,IAEO,CACH,QAAU,GAAI,GAAE,OAAF,CAAU,MAAd,CAAqB,EAArB,CAAyB,EAAzB,CAA6B,cAA7B,CAAV,CACH,CAED,MAAO,QAAP,CACH,CAlBD,CAoBA,GAAI,cAAe,CACf,KAAM,CACF,eAAgB,QAAS,eAAT,EAA0B,CACtC,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,IAA5B,CAAL,CAAwC,CACpC,KAAK,KAAL,CAAW,YAAc,6BAAzB,EACA,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAPC,CAQF,iBAAkB,QAAS,iBAAT,EAA4B,YAAY,CACtD,MAAO,KAAP,CACH,CAVC,CAWF,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,MAAO,IAAI,GAAE,OAAF,CAAU,IAAd,CAAmB,MAAnB,CAAP,CACH,CAbC,CADS,CAgBf,MAAO,CACH,eAAgB,QAAS,eAAT,EAA0B,CACtC,MAAO,KAAP,CACH,CAHE,CAIH,iBAAkB,QAAS,iBAAT,EAA4B,YAAY,CACtD,MAAO,KAAP,CACH,CANE,CAOH,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,MAAO,IAAI,GAAE,OAAF,CAAU,KAAd,CAAoB,MAApB,CAAP,CACH,CATE,CAhBQ,CA2Bf,WAAY,CACR,eAAgB,QAAS,eAAT,EAA0B,CACtC,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,UAA5B,CAAL,CAA8C,CAC1C,KAAK,KAAL,CAAW,YAAc,mCAAzB,EACA,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAPO,CAQR,iBAAkB,QAAS,iBAAT,EAA4B,YAAY,CACtD,MAAO,KAAP,CACH,CAVO,CAWR,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,MAAO,IAAI,GAAE,OAAF,CAAU,UAAd,CAAyB,MAAzB,CAAP,CACH,CAbO,CA3BG,CA0Cf,OAAQ,CACJ,eAAgB,QAAS,eAAT,EAA0B,CACtC,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,MAA5B,CAAL,CAA0C,CACtC,KAAK,KAAL,CAAW,YAAc,+BAAzB,EACA,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAPG,CAQJ,iBAAkB,QAAS,iBAAT,EAA4B,YAAY,CACtD,MAAO,KAAP,CACH,CAVG,CAWJ,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,MAAO,IAAI,GAAE,OAAF,CAAU,MAAd,CAAqB,MAArB,CAAP,CACH,CAbG,CA1CO,CAyDf,OAAQ,EAzDO,CA0Df,QAAS,CACL,eAAgB,QAAS,eAAT,EAA0B,CACtC,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,OAA5B,CAAL,CAA2C,CACvC,KAAK,KAAL,CAAW,YAAc,gCAAzB,EACA,MAAO,MAAP,CACH,CAED,MAAO,KAAP,CACH,CARI,CASL,iBAAkB,QAAS,iBAAT,CAA0B,MAA1B,CAAkC,CAChD,GAAI,CAAC,UAAU,OAAO,KAAjB,CAAL,CAA8B,CAC1B,KAAK,IAAL,CAAU,YAAc,4CAAxB,EACA,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAfI,CAgBL,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,GAAI,OAAQ,YAAY,OAAO,KAAnB,CAAZ,CAEA,GAAI,CAAC,UAAU,KAAV,CAAL,CAAuB,CACnB,KAAK,IAAL,CAAU,YAAc,gDAAxB,EACA,OACH,CAED,MAAO,IAAI,GAAE,OAAF,CAAU,OAAd,CAAsB,KAAtB,CAA6B,MAA7B,CAAP,CACH,CAzBI,CA1DM,CAAnB,CAuFA,MAAO,CACH,2BAA4B,2BADzB,CAGH,mBAAoB,QAAS,mBAAT,CAA4B,IAA5B,CAAkC,CAClD,MAAO,QAAO,IAAP,CAAY,YAAZ,EAA0B,OAA1B,CAAkC,IAAlC,IAA4C,CAAC,CAApD,CACH,CALE,CAOH,cAAe,QAAS,cAAT,CAAuB,IAAvB,CAA6B,MAA7B,CAAqC,CAChD,GAAI,CAAC,aAAa,IAAb,EAAmB,gBAAnB,CAAoC,MAApC,CAAL,CAAkD,CAC9C,OACH,CAED,MAAO,cAAa,IAAb,EAAmB,aAAnB,CAAiC,MAAjC,CAAP,CACH,CAbE,CAeH,oBAAqB,QAAS,oBAAT,CAA6B,GAA7B,CAAkC,KAAlC,CAAyC,MAAzC,CAAiD,UAAjD,CAA6D,QAA7D,CAAuE,aAAvE,CAAsF,CACvG,GAAI,EAAJ,CACA,GAAI,gBAAiB,UAAU,KAAV,CAArB,CACA,GAAI,cAAe,4BAA4B,UAA5B,CAAwC,QAAxC,CAAkD,KAAlD,CAAnB,CAEA,GAAI,UAAU,cAAV,GAA6B,MAAjC,CAAyC,CACrC,IAAK,CAAL,GAAU,eAAc,UAAxB,CAAoC,CAChC,eAAe,WAAf,CAA2B,cAAc,UAAd,CAAyB,CAAzB,CAA3B,EACH,CACD,IAAK,CAAL,GAAU,eAAc,QAAxB,CAAkC,CAC9B,eAAe,WAAf,CAA2B,cAAc,QAAd,CAAuB,CAAvB,CAA3B,EACH,CACD,IAAI,aAAJ,CAAkB,cAAlB,EACA,MAAO,WAAU,KAAV,CAAP,CACH,CAED,GAAI,YAAJ,CAAkB,CACd,eAAiB,qBAAqB,KAArB,CAAjB,CACA,UAAU,KAAV,EAAmB,cAAnB,CACA,IAAK,CAAL,GAAU,WAAV,CAAsB,CAClB,GAAI,gBAAiB,UAAU,WAAW,CAAX,EAAc,YAAxB,GAAyC,WAAW,CAAX,EAAc,YAAd,CAA2B,cAA3B,GAA8C,KAA5G,CACA,GAAI,CAAC,cAAD,EAAmB,UAAU,cAAc,UAAd,CAAyB,CAAzB,CAAV,CAAvB,CAA+D,CAC3D,eAAe,YAAf,CAA4B,cAAc,UAAd,CAAyB,CAAzB,CAA5B,CAAyD,WAAW,CAAX,EAAc,IAAvE,EACH,CACJ,CACD,IAAK,CAAL,GAAU,SAAV,CAAoB,CAChB,GAAI,uBAAwB,UAAU,SAAS,CAAT,EAAY,WAAtB,GAAsC,SAAS,CAAT,EAAY,WAAZ,CAAwB,cAAxB,GAA2C,KAA7G,CACA,GAAI,CAAC,qBAAD,EAA0B,UAAU,cAAc,QAAd,CAAuB,CAAvB,CAAV,CAA9B,CAAoE,CAChE,eAAe,UAAf,CAA0B,cAAc,QAAd,CAAuB,CAAvB,CAA1B,CAAqD,SAAS,CAAT,EAAY,IAAjE,EACH,CACJ,CAED,IAAI,UAAJ,CAAe,cAAf,EACH,CACD,MAAO,aAAP,CACH,CAlDE,CAoDH,wBAAyB,QAAS,wBAAT,CAAiC,KAAjC,CAAwC,CAC7D,MAAO,WAAU,KAAV,CAAP,CACH,CAtDE,CAAP,CAwDH,CAxMD,EA0MA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,aAArC,CAAoD,SAAU,aAAV,CAAyB,EAAzB,CAA6B,cAA7B,CAA6C,CAC7F,GAAI,UAAW,eAAe,QAA9B,CACI,mBAAqB,eAAe,kBADxC,CAEI,iBAAmB,eAAe,gBAFtC,CAGA;AAEA,GAAI,UAAW,EAAf,CACA,GAAI,MAAO,IAAX,CAEA,GAAI,YAAa,QAAS,WAAT,CAAoB,MAApB,CAA4B,CACzC,MAAO,QAAO,MAAP,CAAc,CAAd,EAAiB,WAAjB,GAAiC,OAAO,KAAP,CAAa,CAAb,CAAxC,CACH,CAFD,CAIA,GAAI,eAAgB,CAAC,KAAD,CAAQ,OAAR,CAAiB,QAAjB,CAA2B,OAA3B,CAAoC,SAApC,CAA+C,SAA/C,CAA0D,SAA1D,CAAqE;AACzF,aADoB,CACL,mBADK,CAApB,CAGA;AACA,cAAc,OAAd,CAAsB,SAAU,QAAV,CAAoB,CACtC,SAAS,QAAT,EAAqB,EAArB,CACH,CAFD,EAIA,KAAK,YAAL,CAAoB,SAAU,OAAV,CAAmB,CACnC,GAAI,IAAK,eAAe,oBAAf,CAAoC,SAAS,GAA7C,CAAkD,OAAlD,CAAT,CACA,cAAc,OAAd,CAAsB,SAAU,QAAV,CAAoB,CACtC,SAAS,QAAT,EAAmB,EAAnB,EAAyB,SAAzB,CACH,CAFD,EAGH,CALD,CAOA;AACA,cAAc,OAAd,CAAsB,SAAU,QAAV,CAAoB,CACtC,GAAI,MAAO,WAAW,QAAX,CAAX,CACA,KAAK,MAAQ,IAAb,EAAqB,SAAU,OAAV,CAAmB,OAAnB,CAA4B,CAC7C,GAAI,OAAQ,mBAAmB,SAAS,QAAT,CAAnB,CAAuC,OAAvC,CAAZ,CACA,MAAM,OAAN,CAAc,OAAd,EACA,iBAAiB,SAAS,QAAT,CAAjB,CAAqC,OAArC,EACH,CAJD,CAMA,KAAK,MAAQ,IAAb,EAAqB,SAAU,OAAV,CAAmB,CACpC,GAAI,OAAQ,SAAS,SAAS,QAAT,CAAT,CAA6B,OAA7B,CAAZ,CACA,MAAO,OAAM,OAAb,CACH,CAHD,CAIH,CAZD,EAaH,CA1CD,EA4CA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,iCAArC,CAAwE,SAAU,aAAV,CAAyB,WAAzB,CAAsC,cAAtC,CAAsD,CAC1H,GAAI,YAAa,eAAe,SAAhC,CACI,UAAY,eAAe,QAD/B,CAEI,UAAY,eAAe,QAF/B,CAGI,iBAAmB,eAAe,WAHtC,CAII,KAAO,aAJX,CAMA,GAAI,cAAe,iBAAmB,kCAAtC,CAEA,GAAI,SAAU,QAAS,QAAT,CAAiB,EAAjB,CAAqB,cAArB,CAAqC,QAArC,CAA+C,OAA/C,CAAwD,CAClE,GAAI,WAAY,aAAe,WAA/B,CACA,GAAI,UAAW,EAAf,CACA,GAAI,CAAC,WAAW,cAAX,CAAL,CAAiC,CAC7B,KAAK,KAAL,CAAW,UAAY,oCAAvB,EACA,OACH,CAED,GAAI,UAAU,cAAV,GAA6B,WAAW,QAAX,CAA7B,EAAqD,WAAW,OAAX,CAAzD,CAA8E,CAC1E,SAAS,cAAT,EAA2B,CACvB,OAAQ,QADe,CAEvB,MAAO,OAFgB,CAA3B,CAIH,CALD,IAKO,IAAI,UAAU,cAAV,GAA6B,CAAC,WAAW,QAAX,CAA9B,EAAsD,CAAC,WAAW,OAAX,CAA3D,CAAgF,CACnF,SAAW,cAAX,CACH,CAFM,IAEA,CACH,KAAK,KAAL,CAAW,UAAY,qBAAvB,EACA,OACH,CAED;AACA,YAAY,oBAAZ,GAAmC,IAAnC,CAAwC,SAAU,QAAV,CAAoB,CACxD,QAAQ,MAAR,CAAe,QAAf,CAAyB,QAAzB,EACA,YAAY,oBAAZ,CAAiC,QAAjC,CAA2C,EAA3C,EACH,CAHD,EAIH,CAzBD,CA2BA,MAAO,CACH,OAAQ,OADL,CAAP,CAGH,CAvCD,EAyCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,uBAArC,CAA8D,SAAU,cAAV,CAA0B,gBAA1B,CAA4C,CACtG,GAAI,MAAO,cAAX,CACI,IAAM,gBADV,CAEA,GAAI,OAAQ,QAAS,MAAT,CAAe,GAAf,CAAoB,GAApB,CAAyB,CACjC,KAAK,GAAL,CAAW,GAAX,CACA,KAAK,GAAL,CAAW,GAAX,CACA,MAAO,KAAP,CACH,CAJD,CAMA,GAAI,SAAU,QAAS,QAAT,CAAiB,KAAjB,CAAwB,CAClC,GAAI,MAAM,OAAN,CAAc,KAAd,GAAwB,MAAM,MAAN,GAAiB,CAA7C,CAAgD,CAC5C,MAAO,OAAM,CAAN,CAAP,CACH,CAFD,IAEO,IAAI,KAAK,SAAL,CAAe,MAAM,IAArB,GAA8B,MAAM,IAAN,GAAe,OAAjD,CAA0D,CAC7D,MAAO,CAAC,MAAM,WAAN,CAAkB,CAAlB,CAAR,CACH,CAFM,IAEA,CACH,MAAO,CAAC,MAAM,GAAd,CACH,CACJ,CARD,CAUA,GAAI,SAAU,QAAS,QAAT,CAAiB,KAAjB,CAAwB,CAClC,GAAI,MAAM,OAAN,CAAc,KAAd,GAAwB,MAAM,MAAN,GAAiB,CAA7C,CAAgD,CAC5C,MAAO,OAAM,CAAN,CAAP,CACH,CAFD,IAEO,IAAI,KAAK,SAAL,CAAe,MAAM,IAArB,GAA8B,MAAM,IAAN,GAAe,OAAjD,CAA0D,CAC7D,MAAO,CAAC,MAAM,WAAN,CAAkB,CAAlB,CAAR,CACH,CAFM,IAEA,CACH,MAAO,CAAC,MAAM,GAAd,CACH,CACJ,CARD,CAUA,GAAI,iBAAkB,QAAS,gBAAT,CAAyB,MAAzB,CAAiC,CACnD,GAAI,KAAK,WAAL,CAAiB,MAAjB,CAAJ,CAA8B,CAC1B,MAAO,MAAP,CACH,CACD,GAAI,KAAK,OAAL,CAAa,MAAb,CAAJ,CAA0B,CACtB,GAAI,OAAO,MAAP,GAAkB,CAAlB,EAAuB,KAAK,QAAL,CAAc,OAAO,CAAP,CAAd,CAAvB,EAAmD,KAAK,QAAL,CAAc,OAAO,CAAP,CAAd,CAAvD,CAAiF,CAC7E,MAAO,KAAP,CACH,CACJ,CAJD,IAIO,IAAI,KAAK,SAAL,CAAe,OAAO,IAAtB,CAAJ,CAAiC,CACpC,GAAI,OAAO,IAAP,GAAgB,OAAhB,EAA2B,KAAK,OAAL,CAAa,OAAO,WAApB,CAA3B,EAA+D,OAAO,WAAP,CAAmB,MAAnB,GAA8B,CAA7F,EAAkG,KAAK,QAAL,CAAc,OAAO,WAAP,CAAmB,CAAnB,CAAd,CAAlG,EAA0I,KAAK,QAAL,CAAc,OAAO,WAAP,CAAmB,CAAnB,CAAd,CAA9I,CAAoL,CAChL,MAAO,KAAP,CACH,CACJ,CAED,GAAI,KAAM,IAAI,GAAJ,CAAQ,CAAC,KAAD,CAAQ,KAAR,CAAR,CAAwB,SAAU,GAAV,CAAe,CAC7C,MAAO,MAAK,SAAL,CAAe,OAAO,GAAP,CAAf,GAA+B,KAAK,QAAL,CAAc,OAAO,GAAP,CAAd,CAAtC,CACH,CAFS,CAAV,CAGA,MAAO,IAAP,CACH,CAlBD,CAoBA,GAAI,YAAa,QAAS,WAAT,CAAoB,KAApB,CAA2B,CACxC,GAAI,CAAC,KAAD,EAAU,CAAC,gBAAgB,KAAhB,CAAf,CAAuC,CACnC,OACH,CACD,GAAI,GAAI,IAAR,CACA,GAAI,MAAM,OAAN,CAAc,KAAd,GAAwB,MAAM,MAAN,GAAiB,CAA7C,CAAgD,CAC5C,EAAI,GAAI,MAAJ,CAAU,MAAM,CAAN,CAAV,CAAoB,MAAM,CAAN,CAApB,CAAJ,CACH,CAFD,IAEO,IAAI,KAAK,SAAL,CAAe,MAAM,IAArB,GAA8B,MAAM,IAAN,GAAe,OAAjD,CAA0D,CAC7D,EAAI,GAAI,MAAJ,CAAU,MAAM,WAAN,CAAkB,CAAlB,CAAV,CAAgC,MAAM,WAAN,CAAkB,CAAlB,CAAhC,CAAJ,CACH,CAFM,IAEA,CACH,MAAO,MAAP,CACH,CACD;AACA,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,CAAtB,CAAP,CAAiC;AACpC,CAdD,CAgBA,MAAO,CACH,OAAQ,OADL,CAEH,OAAQ,OAFL,CAGH,eAAgB,eAHb,CAIH,UAAW,UAJR,CAAP,CAMH,CAvED,EAyEA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,gBAArC,CAAuD,SAAU,EAAV,CAAc,IAAd,CAAoB,QAApB,CAA8B,CACjF,GAAI,cAAe,eAAnB,CACA,GAAI,OAAQ,QAAQ,IAApB,CACA,GAAI,QAAS,KAAb,CACA;;;;;;;;;;;OAYA,GAAI,iBAAkB,QAAS,gBAAT,CAAyB,MAAzB,CAAiC,OAAjC,CAA0C,CAC5D,GAAI,IAAJ,CACA,GAAI,CAAC,MAAD,EAAW,CAAC,QAAQ,QAAR,CAAiB,MAAjB,CAAhB,CAA0C,OAC1C;AACA,GAAI,UAAY,IAAZ,EAAoB,CAAC,QAAQ,QAAR,CAAiB,OAAjB,CAAzB,CAAoD,CAChD,MAAO,QAAP,CACH,CACD,IAAM,MAAN,CACA,QAAQ,KAAR,CAAc,GAAd,EAAmB,OAAnB,CAA2B,SAAU,KAAV,CAAiB,CACxC,GAAI,GAAJ,CAAS,CACL,IAAM,IAAI,KAAJ,CAAN,CACH,CACJ,CAJD,EAKA,MAAO,IAAP,CACH,CAdD,CAgBA;;;;;OAMA,GAAI,qBAAsB,QAAS,oBAAT,CAA6B,OAA7B,CAAsC,CAC5D,MAAO,SAAQ,KAAR,CAAc,GAAd,EAAmB,MAAnB,CAA0B,SAAU,QAAV,CAAoB,OAApB,CAA6B,CAC1D,MAAO,UAAW,IAAX,CAAkB,OAAlB,CAA4B,IAAnC,CACH,CAFM,CAAP,CAGH,CAJD,CAMA;;;;OAKA,GAAI,mBAAoB,QAAS,kBAAT,CAA2B,cAA3B,CAA2C,CAC/D,MAAO,gBAAe,MAAf,CAAsB,SAAU,QAAV,CAAoB,OAApB,CAA6B,CACtD,MAAO,UAAW,GAAX,CAAiB,OAAxB,CACH,CAFM,CAAP,CAGH,CAJD,CAMA,QAAS,sBAAT,CAA+B,CAA/B,CAAkC,KAAlC,CAAyC,CACrC,GAAI,GAAJ,CAAQ,CAAR,CACA,GAAI,CAAC,QAAQ,SAAR,CAAkB,KAAlB,CAAL,CAA+B,CAC3B,GAAI,OAAO,IAAP,CAAY,CAAZ,EAAe,MAAf,GAA0B,CAA9B,CAAiC,CAC7B,GAAK,MAAL,CACH,CAFD,IAEO,IAAI,OAAO,IAAP,CAAY,CAAZ,EAAe,MAAf,EAAyB,CAA7B,CAAgC,CACnC,IAAK,CAAL,GAAU,EAAV,CAAa,CACT,GAAI,EAAE,cAAF,CAAiB,CAAjB,CAAJ,CAAyB,CACrB,GAAK,CAAL,CACH,CACJ,CACJ,CANM,IAMA,CACH,KAAK,KAAL,CAAW,aAAe,mGAA1B,EACH,CACJ,CAZD,IAYO,CACH,GAAK,KAAL,CACH,CAED,MAAO,GAAP,CACH,CAED,QAAS,oBAAT,CAA6B,CAA7B,CAAgC,KAAhC,CAAuC,CACnC,GAAI,IAAK,sBAAsB,CAAtB,CAAyB,KAAzB,CAAT,CACI,KADJ,CAGA,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,EAAF,CAAlB,CAAD,EAA6B,EAAE,EAAF,EAAM,aAAN,GAAwB,IAAzD,CAA+D,CAC3D,MAAQ,GAAG,KAAH,EAAR,CACA,EAAE,EAAF,EAAQ,CACJ,MAAO,KADH,CAEJ,cAAe,KAFX,CAAR,CAIH,CAND,IAMO,CACH,MAAQ,EAAE,EAAF,EAAM,KAAd,CACH,CAED,MAAO,MAAP,CACH,CAED,GAAI,YAAa,QAAS,WAAT,CAAoB,KAApB,CAA2B,CACxC,MAAO,SAAQ,SAAR,CAAkB,KAAlB,GAA4B,QAAU,IAA7C,CACH,CAFD,CAGA,GAAI,cAAe,QAAS,aAAT,CAAsB,KAAtB,CAA6B,CAC5C,MAAO,CAAC,WAAW,KAAX,CAAR,CACH,CAFD,CAIA;AAEA,GAAI,sBAAuB,iBAA3B,CAEA,GAAI,iBAAkB,aAAtB,CAEA,GAAI,eAAgB,uBAApB,CAEA;;;;OAMA,GAAI,WAAY,QAAS,UAAT,CAAmB,IAAnB,CAAyB,CACrC,MAAO,MAAK,OAAL,CAAa,oBAAb,CAAmC,SAAU,CAAV,CAAa,SAAb,CAAwB,MAAxB,CAAgC,MAAhC,CAAwC,CAC9E,GAAI,MAAJ,CAAY,CACR,MAAO,QAAO,WAAP,EAAP,CACH,CAFD,IAEO,CACH,MAAO,OAAP,CACH,CACJ,CANM,EAMJ,OANI,CAMI,eANJ,CAMqB,OANrB,CAAP,CAOH,CARD,CAUA;;;MAKA,GAAI,oBAAqB,QAAS,mBAAT,CAA4B,IAA5B,CAAkC,CACvD,MAAO,WAAU,KAAK,OAAL,CAAa,aAAb,CAA4B,EAA5B,CAAV,CAAP,CACH,CAFD,CAGA;AAEA,GAAI,yBAA0B,EAA9B,CAEA,GAAI,yBAA0B,QAAS,wBAAT,CAAiC,OAAjC,CAA0C,SAA1C,CAAqD,QAArD,CAA+D,CACzF,GAAI,CAAC,OAAL,CAAc,KAAM,IAAI,MAAJ,CAAU,aAAe,sBAAzB,CAAN,CACd,GAAI,CAAC,SAAL,CAAgB,KAAM,IAAI,MAAJ,CAAU,aAAe,wBAAzB,CAAN,CAEhB,QAAQ,SAAR,EAAqB,IAArB,CACA,GAAI,KAAM,UAAV,CACA,SAAS,UAAY,CACjB,QAAQ,SAAR,EAAqB,KAArB,CACH,CAFD,CAEG,uBAFH,EAGA,MAAO,IAAP,CACH,CAVD,CAYA,MAAO,CACH,uBAAwB,uBADrB,CAEH,uBAAwB,uBAFrB,CAGH,UAAW,SAHR,CAIH,mBAAoB,kBAJjB,CAKH,KAAM,KALH,CAMH,MAAO,MANJ,CAOH,YAAa,YAPV,CAQH,eAAgB,eARb,CASH,mBAAoB,mBATjB,CAUH,iBAAkB,iBAVf,CAWH,UAAW,QAAS,UAAT,CAAmB,GAAnB,CAAwB,QAAxB,CAAkC,CACzC,MAAO,YAAW,GAAX,EAAkB,GAAlB,CAAwB,QAA/B,CACH,CAbE,CAcH;AACA,SAAU,QAAS,SAAT,CAAkB,GAAlB,CAAuB,CAC7B,MAAO,OAAQ,MAAR,EAAkB,MAAQ,IAAjC,CACH,CAjBE,CAkBH;AACA,QAAS,QAAS,QAAT,CAAiB,KAAjB,CAAwB,CAC7B,MAAO,QAAO,IAAP,CAAY,KAAZ,EAAmB,MAAnB,GAA8B,CAArC,CACH,CArBE,CAuBH;AACA,mBAAoB,QAAS,mBAAT,CAA4B,KAA5B,CAAmC,CACnD,MAAO,SAAQ,WAAR,CAAoB,KAApB,GAA8B,QAAU,IAAxC,EAAgD,OAAO,IAAP,CAAY,KAAZ,EAAmB,MAAnB,GAA8B,CAArF,CACH,CA1BE,CA4BH;AACA,UAAW,UA7BR,CA8BH,YAAa,YA9BV,CA+BH,SAAU,QAAQ,QA/Bf,CAgCH,SAAU,QAAQ,QAhCf,CAiCH,QAAS,QAAQ,OAjCd,CAkCH,SAAU,QAAQ,QAlCf,CAmCH,WAAY,QAAQ,UAnCjB,CAoCH,OAAQ,QAAQ,MApCb,CAsCH,cAAe,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC1C,MAAO,SAAQ,SAAR,CAAkB,MAAlB,GAA6B,QAAQ,QAAR,CAAiB,OAAO,GAAxB,CAA7B,EAA6D,QAAQ,QAAR,CAAiB,OAAO,GAAxB,CAA7D,EAA6F,QAAQ,QAAR,CAAiB,OAAO,IAAxB,CAApG,CACH,CAxCE,CA0CH,aAAc,QAAS,aAAT,CAAsB,KAAtB,CAA6B,CACvC,GAAI,CAAC,QAAQ,SAAR,CAAkB,KAAlB,CAAL,CAA+B,CAC3B,MAAO,MAAP,CACH,CACD,GAAI,QAAQ,OAAR,CAAgB,KAAhB,CAAJ,CAA4B,CACxB,MAAO,OAAM,MAAN,GAAiB,CAAjB,EAAsB,QAAQ,QAAR,CAAiB,MAAM,CAAN,CAAjB,CAAtB,EAAoD,QAAQ,QAAR,CAAiB,MAAM,CAAN,CAAjB,CAA3D,CACH,CACD,MAAO,SAAQ,QAAR,CAAiB,MAAM,GAAvB,GAA+B,QAAQ,QAAR,CAAiB,MAAM,GAAvB,CAAtC,CACH,CAlDE,CAoDH,kBAAmB,QAAS,kBAAT,CAA2B,WAA3B,CAAwC,GAAxC,CAA6C,CAC5D,GAAI,WAAY,IAAI,SAAJ,EAAhB,CACA,GAAI,MAAO,IAAI,OAAJ,EAAX,CACA,GAAI,YAAY,GAAZ,EAAmB,YAAY,GAA/B,EAAsC,UAAU,GAAV,CAAc,OAAd,CAAsB,CAAtB,IAA6B,YAAY,GAAZ,CAAgB,OAAhB,CAAwB,CAAxB,CAAnE,EAAiG,UAAU,GAAV,CAAc,OAAd,CAAsB,CAAtB,IAA6B,YAAY,GAAZ,CAAgB,OAAhB,CAAwB,CAAxB,CAA9H,EAA4J,OAAS,YAAY,IAArL,CAA2L,CACvL,MAAO,KAAP,CACH,CACD,MAAO,MAAP,CACH,CA3DE,CA6DH,UAAW,QAAS,UAAT,CAAmB,MAAnB,CAA2B,EAA3B,CAA+B,CACtC,GAAI,OAAQ,OAAO,KAAP,CAAa,OAAzB,CACA,GAAI,QAAU,QAAV,EAAsB,QAAU,SAApC,CAA+C,CAC3C,OAAO,KAAP,CAAa,EAAb,EACH,CAFD,IAEO,CACH,OAAO,UAAP,CAAkB,EAAlB,EACH,CACJ,CApEE,CAsEH,qBAAsB,qBAtEnB,CAwEH,SAAU,QAAS,SAAT,CAAkB,CAAlB,CAAqB,KAArB,CAA4B,CAClC,GAAI,IAAK,sBAAsB,CAAtB,CAAyB,KAAzB,CAAT,CACI,KADJ,CAEA,GAAI,CAAC,QAAQ,SAAR,CAAkB,EAAE,EAAF,CAAlB,CAAD,EAA6B,EAAE,EAAF,EAAM,aAAN,GAAwB,KAAzD,CAAgE,CAC5D,MAAQ,oBAAoB,CAApB,CAAuB,KAAvB,CAAR,CACH,CAFD,IAEO,CACH,MAAQ,EAAE,EAAF,EAAM,KAAd,CACH,CACD,MAAO,MAAP,CACH,CAjFE,CAmFH,mBAAoB,mBAnFjB,CAqFH,iBAAkB,QAAS,iBAAT,CAA0B,CAA1B,CAA6B,KAA7B,CAAoC,CAClD,GAAI,IAAK,sBAAsB,CAAtB,CAAyB,KAAzB,CAAT,CACA,EAAE,EAAF,EAAM,aAAN,CAAsB,IAAtB,CACH,CAxFE,CA0FH,iBAAkB,QAAS,iBAAT,EAA4B,CAC1C,GAAI,WAAY,SAAS,aAAT,CAAuB,OAAvB,CAAhB,CACA,UAAU,YAAV,CAAuB,MAAvB,CAA+B,OAA/B,EACA,MAAO,WAAU,IAAV,GAAmB,OAA1B,CACH,CA9FE,CAgGH,wBAAyB,CACrB,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,UAA5B,CAAP,CACH,CAHoB,CAhGtB,CAsGH,qBAAsB,CAClB,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,OAAF,CAAU,OAA5B,CAAP,CACH,CAHiB,CAtGnB,CA4GH,qBAAsB,CAClB,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,cAApB,GAAuC,QAAQ,SAAR,CAAkB,EAAE,cAAF,CAAiB,IAAnC,CAA9C,CACH,CAHiB,CAIlB,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,gBAAgB,GAAE,cAAF,CAAiB,IAAxC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAViB,CAWlB,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CApBiB,CA5GnB,CAmIH,oBAAqB,CACjB,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,aAApB,GAAsC,QAAQ,SAAR,CAAkB,EAAE,aAAF,CAAgB,IAAlC,CAA7C,CACH,CAHgB,CAIjB,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,gBAAgB,GAAE,aAAF,CAAgB,IAAvC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVgB,CAWjB,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CApBgB,CAnIlB,CA0JH,iBAAkB,CACd,SAAU,QAAS,SAAT,EAAoB,CAC1B,GAAI,QAAQ,SAAR,CAAkB,EAAE,UAApB,GAAmC,QAAQ,SAAR,CAAkB,EAAE,UAAF,CAAa,IAA/B,CAAvC,CAA6E,CACzE,MAAO,KAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAPa,CAQd,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,gBAAgB,GAAE,UAAF,CAAa,IAApC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAda,CAed,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAxBa,CA1Jf,CAqLH,wBAAyB,CACrB,SAAU,QAAS,SAAT,EAAoB,CAC1B,GAAI,QAAQ,SAAR,CAAkB,EAAE,iBAApB,CAAJ,CAA4C,CACxC,MAAO,KAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAPoB,CAQrB,GAAI,QAAS,GAAT,CAAY,UAAZ,CAAwB,CACxB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,sBAAsB,GAAE,iBAA/B,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAdoB,CAerB,MAAO,QAAS,MAAT,CAAe,WAAf,CAA4B,WAA5B,CAAyC,CAC5C,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,WAAR,CAAJ,CAA0B,CACtB,MAAO,SAAQ,MAAR,CAAe,WAAf,CAA4B,WAA5B,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAxBoB,CArLtB,CAgNH,kBAAmB,CACf,SAAU,QAAS,SAAT,EAAoB,CAC1B,GAAI,QAAQ,SAAR,CAAkB,EAAE,WAApB,GAAoC,QAAQ,SAAR,CAAkB,EAAE,WAAF,CAAc,IAAhC,CAAxC,CAA+E,CAC3E,MAAO,KAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAPc,CAQf,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,gBAAgB,GAAE,WAAF,CAAc,IAArC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAdc,CAef,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAxBc,CAhNhB,CA0OH,mBAAoB,CAChB,SAAU,QAAS,SAAT,EAAoB,CAC1B,GAAI,QAAQ,SAAR,CAAkB,EAAE,YAApB,GAAqC,QAAQ,SAAR,CAAkB,EAAE,YAAF,CAAe,IAAjC,CAAzC,CAAiF,CAC7E,MAAO,KAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAPe,CAQhB,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,gBAAgB,GAAE,YAAF,CAAe,IAAtC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAde,CAehB,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,CAAC,KAAK,QAAL,EAAL,CAAsB,CAClB,MAAO,MAAP,CACH,CACD,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAxBe,CA1OjB,CAoQH,YAAa,CACT,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,KAApB,CAAP,CACH,CAHQ,CAIT,GAAI,QAAS,GAAT,CAAY,KAAZ,CAAmB,CACnB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,iBAAiB,GAAE,kBAA1B,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVQ,CApQV,CAgRH,oBAAqB,CACjB,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,kBAApB,CAAP,CACH,CAHgB,CAIjB,GAAI,QAAS,GAAT,CAAY,KAAZ,CAAmB,CACnB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,iBAAiB,GAAE,kBAA1B,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVgB,CAhRlB,CA4RH,cAAe,CACX,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,SAAQ,SAAR,CAAkB,EAAE,SAAF,CAAY,OAA9B,CAAP,CACH,CAHU,CAIX,GAAI,QAAS,GAAT,CAAY,KAAZ,CAAmB,CACnB,GAAI,KAAK,QAAL,EAAJ,CAAqB,CACjB,MAAO,iBAAiB,GAAE,SAAF,CAAY,OAApC,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVU,CA5RZ,CAwSH,QAAS,CACL,SAAU,QAAS,SAAT,EAAoB,CAC1B,MAAO,QAAP,CACH,CAHI,CAIL,GAAI,QAAS,GAAT,EAAc,SAAS,CACvB,MAAO,KAAP,CACA;;;;;mBAMH,CAZI,CAxSN,CAsTH,QAAS,CACL,QAAS,CACL,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,MAAO,gBAAgB,GAAE,OAAzB,CACH,CAHI,CAIL,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVI,CADJ,CAaL,KAAM,CACF,GAAI,QAAS,GAAT,CAAY,IAAZ,CAAkB,CAClB,MAAO,gBAAgB,GAAE,IAAzB,CACH,CAHC,CAIF,MAAO,QAAS,MAAT,CAAe,KAAf,CAAsB,KAAtB,CAA6B,CAChC,GAAI,KAAK,EAAL,CAAQ,KAAR,CAAJ,CAAoB,CAChB,MAAO,SAAQ,MAAR,CAAe,KAAf,CAAsB,KAAtB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,MAAP,CACH,CACJ,CAVC,CAbD,CAtTN,CAgVH;;;;;;;WAQA;AACA,aAAc,CACV,KAAM,WADI,CAEV,WAAY,CACR,KAAM,WADE,CAFF,CAzVX,CAAP,CAgWH,CApfD,EAsfA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,kBAArC,CAAyD,SAAU,aAAV,CAAyB,cAAzB,CAAyC,CAEhG,GAAI,MAAO,cAAX,CACI,YAAc,eAAe,WAAf,CAA6B,oBAD/C,CAGA;AACA,GAAI,OAAQ,OAAO,IAAnB,CACA,GAAI,aAAc,KAAK,UAAvB,CACA,GAAI,WAAY,KAAK,QAArB,CACA,GAAI,MAAO,aAAX,CAEA;AACA;AACA;AACA,GAAI,iBAAkB,KAAK,GAAL,CAAS,CAAT,CAAY,EAAZ,EAAkB,CAAxC,CAEA,GAAI,cAAe,QAAS,aAAT,CAAsB,UAAtB,CAAkC,CACnD,GAAI,QAAS,aAAe,IAAf,EAAuB,WAAW,MAA/C,CACA,MAAO,MAAK,QAAL,CAAc,MAAd,GAAyB,QAAU,CAAnC,EAAwC,QAAU,eAAzD,CACD,CAHD,CAKA;AACA,GAAI,WAAY,QAAS,UAAT,CAAmB,KAAnB,CAA0B,CACxC,MAAO,MAAP,CACD,CAFD,CAIA,GAAI,WAAY,QAAS,UAAT,CAAmB,GAAnB,CAAwB,CACtC,MAAO,UAAU,GAAV,CAAe,CACpB,MAAO,OAAQ,IAAR,CAAe,IAAK,EAApB,CAAwB,IAAI,GAAJ,CAA/B,CACD,CAFD,CAGD,CAJD,CAMA;AACA;AACA;AACA,GAAI,YAAa,QAAS,WAAT,CAAoB,IAApB,CAA0B,OAA1B,CAAmC,QAAnC,CAA6C,CAC5D,GAAI,UAAY,IAAK,EAArB,CAAwB,MAAO,KAAP,CACxB,OAAQ,WAAa,IAAb,CAAoB,CAApB,CAAwB,QAAhC,EACE,IAAK,EAAL,CACE,MAAO,UAAU,KAAV,CAAiB,CACtB,MAAO,MAAK,IAAL,CAAU,OAAV,CAAmB,KAAnB,CAAP,CACD,CAFD,CAGF,IAAK,EAAL,CACE,MAAO,UAAU,KAAV,CAAiB,KAAjB,CAAwB,CAC7B,MAAO,MAAK,IAAL,CAAU,OAAV,CAAmB,KAAnB,CAA0B,KAA1B,CAAP,CACD,CAFD,CAGF,IAAK,EAAL,CACE,MAAO,UAAU,KAAV,CAAiB,KAAjB,CAAwB,UAAxB,CAAoC,CACzC,MAAO,MAAK,IAAL,CAAU,OAAV,CAAmB,KAAnB,CAA0B,KAA1B,CAAiC,UAAjC,CAAP,CACD,CAFD,CAGF,IAAK,EAAL,CACE,MAAO,UAAU,WAAV,CAAuB,KAAvB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACtD,MAAO,MAAK,IAAL,CAAU,OAAV,CAAmB,WAAnB,CAAgC,KAAhC,CAAuC,KAAvC,CAA8C,UAA9C,CAAP,CACD,CAFD,CAdJ,CAkBA,MAAO,WAAY,CACjB,MAAO,MAAK,KAAL,CAAW,OAAX,CAAoB,SAApB,CAAP,CACD,CAFD,CAGD,CAvBD,CAyBA;AACA,GAAI,gBAAiB,QAAS,eAAT,CAAwB,QAAxB,CAAkC,aAAlC,CAAiD,CACpE,MAAO,UAAU,GAAV,CAAe,CACpB,GAAI,QAAS,UAAU,MAAvB,CACA,GAAI,OAAS,CAAT,EAAc,MAAQ,IAA1B,CAAgC,MAAO,IAAP,CAChC,IAAK,GAAI,OAAQ,CAAjB,CAAoB,MAAQ,MAA5B,CAAoC,OAApC,CAA6C,CAC3C,GAAI,QAAS,UAAU,KAAV,CAAb,CACI,KAAO,SAAS,MAAT,CADX,CAEI,EAAI,KAAK,MAFb,CAGA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,CAApB,CAAuB,GAAvB,CAA4B,CAC1B,GAAI,KAAM,KAAK,CAAL,CAAV,CACA,GAAI,CAAC,aAAD,EAAkB,IAAI,GAAJ,IAAa,IAAK,EAAxC,CAA2C,IAAI,GAAJ,EAAW,OAAO,GAAP,CAAX,CAC5C,CACF,CACD,MAAO,IAAP,CACD,CAbD,CAcD,CAfD,CAiBA;AACA;AACA,GAAI,WAAJ,CACI,QAAU,IADd,CAEA,WAAa,QAAU,eAAe,KAAf,CAAvB,CAEA;AACA,GAAI,UAAW,QAAS,SAAT,CAAkB,MAAlB,CAA0B,KAA1B,CAAiC,CAC9C,GAAI,MAAO,MAAM,KAAN,CAAX,CACI,OAAS,KAAK,MADlB,CAEA,GAAI,SAAW,IAAf,CAAqB,MAAO,CAAC,MAAR,CACrB,GAAI,KAAM,OAAO,MAAP,CAAV,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,MAApB,CAA4B,GAA5B,CAAiC,CAC/B,GAAI,KAAM,KAAK,CAAL,CAAV,CACA,GAAI,MAAM,GAAN,IAAe,IAAI,GAAJ,CAAf,EAA2B,EAAE,MAAO,IAAT,CAA/B,CAA8C,MAAO,MAAP,CAC/C,CACD,MAAO,KAAP,CACD,CAVD,CAYA;AACA;AACA,GAAI,SAAJ,CACI,SAAW,IADf,CAEA,SAAW,SAAW,QAAS,SAAT,CAAkB,KAAlB,CAAyB,CAC7C,MAAQ,WAAW,EAAX,CAAe,KAAf,CAAR,CACA,MAAO,UAAU,GAAV,CAAe,CACpB,MAAO,UAAS,GAAT,CAAc,KAAd,CAAP,CACD,CAFD,CAGD,CALD,CAOA;AACA;AACA;AACA,GAAI,IAAK,QAAS,GAAT,CAAY,KAAZ,CAAmB,OAAnB,CAA4B,QAA5B,CAAsC,CAC7C,GAAI,QAAU,IAAd,CAAoB,MAAO,UAAP,CACpB,GAAI,YAAY,KAAZ,CAAJ,CAAwB,MAAO,YAAW,KAAX,CAAkB,OAAlB,CAA2B,QAA3B,CAAP,CACxB,GAAI,UAAU,KAAV,CAAJ,CAAsB,MAAO,UAAS,KAAT,CAAP,CACtB,MAAO,WAAU,KAAV,CAAP,CACD,CALD,CAOA,GAAI,OAAJ,CACI,KAAO,IADX,CAEA,OAAS,KAAO,QAAS,KAAT,CAAc,GAAd,CAAmB,SAAnB,CAA8B,OAA9B,CAAuC,CACrD,UAAY,GAAG,SAAH,CAAc,OAAd,CAAZ,CACA,GAAI,MAAO,CAAC,aAAa,GAAb,CAAD,EAAsB,MAAM,GAAN,CAAjC,CACI,OAAS,CAAC,MAAQ,GAAT,EAAc,MAD3B,CAEA,IAAK,GAAI,OAAQ,CAAjB,CAAoB,MAAQ,MAA5B,CAAoC,OAApC,CAA6C,CAC3C,GAAI,YAAa,KAAO,KAAK,KAAL,CAAP,CAAqB,KAAtC,CACA,GAAI,CAAC,UAAU,IAAI,UAAJ,CAAV,CAA2B,UAA3B,CAAuC,GAAvC,CAAL,CAAkD,MAAO,MAAP,CACnD,CACD,MAAO,KAAP,CACD,CATD,CAWA;AAEA,GAAI,YAAa,QAAS,WAAT,CAAoB,UAApB,CAAgC,EAAhC,CAAoC,gBAApC,CAAsD,MAAtD,CAA8D,CAC7E,GAAI,CAAC,gBAAL,CAAuB,CACrB,GAAI,CAAC,KAAK,SAAL,CAAe,UAAf,CAAD,EAA+B,CAAC,KAAK,SAAL,CAAe,EAAf,CAApC,CAAwD,CACtD,MAAO,KAAP,CACD,CACF,CACD,GAAI,CAAC,KAAK,UAAL,CAAgB,EAAhB,CAAL,CAA0B,CACxB,OAAS,KAAK,SAAL,CAAe,EAAf,CAAmB,IAAnB,CAAT,CACA,KAAK,KAAL,CAAW,YAAc,MAAd,CAAuB,oBAAlC,EACA,MAAO,KAAP,CACD,CACD,MAAO,MAAP,CACD,CAZD,CAcA,GAAI,UAAW,QAAS,SAAT,CAAkB,UAAlB,CAA8B,UAA9B,CAA0C,UAA1C,CAAsD,CACnE,GAAI,WAAW,SAAX,CAAsB,UAAtB,CAAkC,IAAlC,CAAwC,YAAxC,CAAJ,CAA2D,CACzD,OACD,CACD,GAAI,CAAC,WAAW,UAAX,CAAuB,UAAvB,CAAL,CAAyC,CACvC,IAAK,GAAI,IAAT,GAAgB,WAAhB,CAA4B,CAC1B,GAAI,WAAW,cAAX,CAA0B,GAA1B,CAAJ,CAAoC,CAClC,WAAW,WAAW,GAAX,CAAX,CAA4B,GAA5B,EACD,CACF,CACF,CACF,CAXD,CAaA;AACA;AACA,GAAI,OAAQ,QAAS,MAAT,CAAe,UAAf,CAA2B,EAA3B,CAA+B,CACzC,SAAS,UAAT,CAAqB,EAArB,CAAyB,SAAU,GAAV,CAAe,GAAf,CAAoB,CAC3C,GAAG,GAAH,CAAQ,GAAR,EACD,CAFD,EAGD,CAJD,CAMA,MAAO,CACL,KAAM,KADD,CAEL,QAAS,KAFJ,CAGL,MAAO,MAHF,CAIL,IAAK,IAJA,CAAP,CAMD,CA9KD,EAgLA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,qBAArC,CAA4D,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,gBAAzD,CAA2E,CACnI,GAAI,SAAU,cAAd,CACA,GAAI,UAAW,eAAe,QAA9B,CACA,GAAI,UAAW,eAAe,QAA9B,CACA,GAAI,SAAU,eAAe,OAA7B,CACA,GAAI,WAAY,eAAe,SAA/B,CACA,GAAI,aAAc,eAAe,WAAjC,CACA,GAAI,KAAM,gBAAV,CACA,GAAI,MAAO,aAAX,CAEA,GAAI,oBAAqB,QAAS,mBAAT,CAA4B,MAA5B,CAAoC,CACzD,GAAI,CAAC,QAAQ,aAAR,CAAsB,QAAtB,EAAL,CAAuC,CACnC,KAAK,KAAL,CAAW,yDAAX,EACA,OACH,CACD,GAAI,SAAU,GAAI,GAAE,OAAN,CAAc,OAAO,GAArB,CAA0B,OAAO,aAAjC,CAAd,CAEA,GAAI,QAAS,CACT,MAAO,OAAO,OADL,CAAb,CAIA;AACA,QAAQ,EAAR,CAAW,WAAX,CAAwB,SAAU,CAAV,CAAa,CACjC,QAAQ,MAAR,CAAe,MAAf,CAAuB,CACnB,aAAc,CADK,CAEnB,cAAe,EAAE,MAFE,CAAvB,EAIA,WAAW,UAAX,CAAsB,sCAAtB,CAA8D,MAA9D,EACH,CAND,EAQA,QAAQ,EAAR,CAAW,UAAX,CAAuB,SAAU,CAAV,CAAa,CAChC,QAAQ,MAAR,CAAe,MAAf,CAAuB,CACnB,aAAc,CADK,CAEnB,cAAe,EAAE,MAFE,CAAvB,EAIA,WAAW,UAAX,CAAsB,qCAAtB,CAA6D,MAA7D,EACH,CAND,EAQA,QAAQ,EAAR,CAAW,OAAX,CAAoB,SAAU,CAAV,CAAa,CAC7B,QAAQ,MAAR,CAAe,MAAf,CAAuB,CACnB,aAAc,CADK,CAEnB,cAAe,EAAE,MAFE,CAAvB,EAIA,WAAW,UAAX,CAAsB,kCAAtB,CAA0D,MAA1D,EACH,CAND,EAQA,QAAQ,EAAR,CAAW,WAAX,CAAwB,SAAU,CAAV,CAAa,CACjC,QAAQ,MAAR,CAAe,MAAf,CAAuB,CACnB,aAAc,CADK,CAEnB,cAAe,EAAE,MAFE,CAAvB,EAIA,WAAW,UAAX,CAAsB,sCAAtB,CAA8D,MAA9D,EACH,CAND,EAQA,MAAO,QAAP,CACH,CA7CD,CA+CA,GAAI,YAAa,CACb,IAAK,CACD,YAAa,IADZ,CAED,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,GAAE,SAAF,CAAY,OAAO,GAAnB,CAAwB,OAAO,OAA/B,CAAP,CACH,CAJA,CADQ,CAOb,QAAS,CACL,YAAa,IADR,CAEL,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,CAAC,QAAQ,aAAR,CAAsB,QAAtB,EAAL,CAAuC,CACnC,OACH,CACD,MAAO,IAAI,GAAE,SAAF,CAAY,OAAhB,CAAwB,OAAO,GAA/B,CAAoC,OAAO,aAA3C,CAA0D,OAAO,OAAjE,CAAP,CACH,CAPI,CAPI,CAgBb,aAAc,CACV,YAAa,KADH,CAEV,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,IAAI,GAAE,OAAN,CAAc,OAAO,IAArB,CAA2B,OAAO,OAAlC,CAAP,CACH,CAJS,CAhBD,CAsBb,qBAAsB,CAClB,YAAa,KADK,CAElB,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,IAAI,GAAE,OAAN,CAAc,OAAO,IAArB,CAA2B,CAC9B,aAAc,QAAS,aAAT,CAAsB,OAAtB,CAA+B,MAA/B,CAAuC,CACjD,MAAO,GAAE,MAAF,CAAS,MAAT,CAAiB,CAAE,KAAM,EAAE,cAAF,CAAiB,IAAjB,CAAsB,OAAO,IAA7B,CAAR,CAAjB,CAAP,CACH,CAH6B,CAA3B,CAAP,CAKH,CARiB,CAtBT,CAgCb,oBAAqB,CACjB,YAAa,KADI,CAEjB,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,IAAI,GAAE,OAAN,CAAc,OAAO,IAArB,CAA2B,CAC9B,aAAc,QAAS,aAAT,CAAsB,OAAtB,CAA+B,MAA/B,CAAuC,CACjD,MAAO,GAAE,MAAF,CAAS,MAAT,CAAiB,CAAE,KAAM,EAAE,aAAF,CAAgB,IAAhB,CAAqB,OAAO,IAA5B,CAAR,CAAjB,CAAP,CACH,CAH6B,CAA3B,CAAP,CAKH,CARgB,CAhCR,CA0Cb,aAAc,CACV,YAAa,IADH,CAEV,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,KAAM,UAAU,OAAO,GAAjB,EAAwB,OAAO,GAAP,CAAa,GAAb,CAAmB,OAAO,IAAlD,CAAyD,KAAO,OAAO,IAAd,CAAqB,cAAxF,CACA,KAAO,eAAiB,OAAO,GAAxB,CAA8B,kBAArC,CACA,MAAO,GAAE,SAAF,CAAY,GAAZ,CAAiB,OAAO,OAAxB,CAAP,CACH,CANS,CA1CD,CAkDb,eAAgB,CACZ,YAAa,IADD,CAEZ,cAAe,IAFH,CAGZ,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,KAAM,UAAU,OAAO,GAAjB,EAAwB,OAAO,GAAP,CAAa,GAAb,CAAmB,OAAO,IAAlD,CAAyD,KAAO,OAAO,IAAd,CAAqB,cAAxF,CACA,OAAO,GAAP,CAAa,IAAM,cAAN,CAAuB,OAAO,GAA9B,CAAoC,GAApC,CAA0C,OAAO,KAAjD,CAAyD,wBAAtE,CACA,MAAO,oBAAmB,MAAnB,CAAP,CACH,CAPW,CAlDH,CA2Db,mBAAoB,CAChB,YAAa,IADG,CAEhB,cAAe,IAFC,CAGhB,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,KAAM,UAAU,OAAO,GAAjB,EAAwB,OAAO,GAAP,CAAa,GAAb,CAAmB,OAAO,IAAlD,CAAyD,KAAO,OAAO,IAAd,CAAqB,cAAxF,CACA,GAAI,UAAW,IAAM,cAAN,CAAuB,OAAO,GAA9B,CAAoC,kBAAnD,CACA,GAAI,WAAY,EAAE,SAAF,CAAY,QAAZ,CAAsB,OAAO,OAA7B,CAAhB,CACA,GAAI,QAAS,CAAC,SAAD,CAAb,CAEA,GAAI,aAAc,QAAS,YAAT,CAAqB,MAArB,CAA6B,MAA7B,CAAqC,KAArC,CAA4C,CAC1D,GAAI,YAAa,QAAQ,IAAR,CAAa,MAAb,CAAjB,CACA,WAAW,GAAX,CAAiB,IAAM,cAAN,CAAuB,WAAW,GAAlC,CAAwC,GAAxC,CAA8C,KAA9C,CAAsD,wBAAvE,CACA,OAAO,IAAP,CAAY,mBAAmB,UAAnB,CAAZ,EACH,CAJD,CAMA,GAAI,QAAQ,OAAO,KAAf,CAAJ,CAA2B,CACvB,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,OAAO,KAAP,CAAa,MAAjC,CAAyC,GAAzC,CAA8C,CAC1C,YAAY,MAAZ,CAAoB,MAApB,CAA4B,OAAO,KAAP,CAAa,CAAb,CAA5B,EACH,CACJ,CAJD,IAIO,CACH,YAAY,MAAZ,CAAoB,MAApB,CAA4B,OAAO,KAAnC,EACH,CACD,MAAO,GAAE,UAAF,CAAa,MAAb,CAAP,CACH,CAvBe,CA3DP,CAoFb,IAAK,CACD,YAAa,IADZ,CAED,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,GAAE,SAAF,CAAY,GAAZ,CAAgB,OAAO,GAAvB,CAA4B,OAAO,OAAnC,CAAP,CACH,CAJA,CApFQ,CA0Fb,KAAM,CACF,YAAa,IADX,CAEF,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,GAAE,SAAF,CAAY,IAAZ,CAAiB,OAAO,GAAxB,CAA6B,OAAO,OAApC,CAAP,CACH,CAJC,CA1FO,CAgGb,MAAO,CACH,YAAa,KADV,CAEH,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,MAAO,EAAX,CACA,IAAI,IAAJ,CAAS,OAAO,OAAP,CAAe,MAAxB,CAAgC,SAAU,CAAV,CAAa,CACzC,KAAK,IAAL,CAAU,aAAa,CAAb,CAAV,EACH,CAFD,EAGA,OAAO,OAAP,CAAe,WAAf,CAA6B,UAAY,CACrC,GAAI,QAAS,EAAb,CACA,GAAI,UAAU,OAAO,OAAP,CAAe,MAAzB,CAAJ,CAAsC,CAClC,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,OAAO,OAAP,CAAe,MAAf,CAAsB,MAA1C,CAAkD,GAAlD,CAAuD,CACnD,GAAI,GAAI,OAAO,OAAP,CAAe,MAAf,CAAsB,CAAtB,EAAyB,YAAzB,CAAsC,WAA9C,CACA,GAAI,UAAU,CAAV,CAAJ,CAAkB,CACd,OAAO,IAAP,CAAY,CAAZ,EACH,CACJ,CACJ,CACD,MAAO,OAAP,CACH,CAXD,CAYA,MAAO,GAAE,UAAF,CAAa,IAAb,CAAP,CACH,CApBE,CAhGM,CAsHb,aAAc,CACV,YAAa,KADH,CAEV,YAAa,QAAS,YAAT,EAAuB,CAChC,MAAO,GAAE,YAAF,EAAP,CACH,CAJS,CAtHD,CA4Hb,cAAe,CACX,YAAa,KADF,CAEX,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,CAAC,QAAQ,mBAAR,CAA4B,QAA5B,EAAL,CAA6C,CACzC,KAAK,IAAL,CAAU,YAAc,0CAAxB,EACA,OACH,CACD,MAAO,IAAI,GAAE,kBAAN,CAAyB,OAAO,OAAhC,CAAP,CACH,CARU,CA5HF,CAsIb,aAAc,CACV,YAAa,IADH,CAEV,eAAgB,IAFN,CAGV,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,GAAE,YAAF,CAAe,OAAO,GAAtB,CAA2B,OAAO,MAAlC,CAA0C,OAAO,OAAjD,CAAP,CACH,CALS,CAtID,CA6Ib,IAAK,CACD,YAAa,IADZ,CAED,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,GAAE,SAAF,CAAY,GAAZ,CAAgB,OAAO,GAAvB,CAA4B,OAAO,OAAnC,CAAP,CACH,CAJA,CA7IQ,CAoJb;AACA;AACA;AACA;AACA,OAAQ,CACJ,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,GAAI,OAAO,KAAP,WAAwB,GAAE,KAA9B,CAAqC,CACjC,MAAO,SAAQ,IAAR,CAAa,OAAO,KAApB,CAAP,CACH,CAFD,IAEO,CACH,KAAK,KAAL,CAAW,8DAAX,EACH,CACJ,CAPG,CAxJK,CAiKb,QAAS,CACL,YAAa,IADR,CAEL,YAAa,QAAS,YAAT,CAAqB,MAArB,CAA6B,CACtC,MAAO,SAAQ,WAAR,CAAoB,OAAO,GAA3B,CAAgC,OAAO,GAAvC,CAAP,CACH,CAJI,CAjKI,CAAjB,CAyKA,QAAS,iBAAT,CAA0B,eAA1B,CAA2C,CACvC;AACA,GAAI,CAAC,SAAS,gBAAgB,IAAzB,CAAL,CAAqC,CACjC,KAAK,KAAL,CAAW,+DAAX,EACA,MAAO,MAAP,CACH,CAED,GAAI,OAAO,IAAP,CAAY,UAAZ,EAAwB,OAAxB,CAAgC,gBAAgB,IAAhD,IAA0D,CAAC,CAA/D,CAAkE,CAC9D,KAAK,KAAL,CAAW,yDAA2D,OAAO,IAAP,CAAY,UAAZ,CAAtE,EACA,MAAO,MAAP,CACH,CAED;AACA,GAAI,WAAW,gBAAgB,IAA3B,EAAiC,WAAjC,EAAgD,CAAC,SAAS,gBAAgB,GAAzB,CAArD,CAAoF,CAChF,KAAK,KAAL,CAAW,qDAAX,EACA,MAAO,MAAP,CACH,CAED,GAAI,WAAW,gBAAgB,IAA3B,EAAiC,YAAjC,EAAiD,CAAC,UAAU,gBAAgB,IAA1B,CAAtD,CAAuF,CACnF,KAAK,KAAL,CAAW,yEAAX,EACA,MAAO,MAAP,CACH,CAED,GAAI,WAAW,gBAAgB,IAA3B,EAAiC,aAAjC,EAAkD,CAAC,UAAU,gBAAgB,KAA1B,CAAvD,CAAyF,CACrF,KAAK,KAAL,CAAW,2CAA6C,gBAAgB,IAA7D,CAAoE,6BAA/E,EACA,MAAO,MAAP,CACH,CAED,GAAI,WAAW,gBAAgB,IAA3B,EAAiC,cAAjC,EAAmD,CAAC,UAAU,gBAAgB,MAA1B,CAAxD,CAA2F,CACvF,KAAK,KAAL,CAAW,2CAA6C,gBAAgB,IAA7D,CAAoE,2BAA/E,EACA,MAAO,MAAP,CACH,CAED,GAAI,WAAW,gBAAgB,IAA3B,EAAiC,WAAjC,EAAgD,CAAC,UAAU,gBAAgB,GAA1B,CAArD,CAAqF,CACjF,KAAK,KAAL,CAAW,2CAA6C,gBAAgB,IAA7D,CAAoE,wBAA/E,EACA,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAED,QAAS,aAAT,CAAsB,eAAtB,CAAuC,CACnC,GAAI,CAAC,iBAAiB,eAAjB,CAAL,CAAwC,CACpC,OACH,CAED,GAAI,CAAC,SAAS,gBAAgB,IAAzB,CAAL,CAAqC,CACjC,KAAK,KAAL,CAAW,qDAAX,EACA,OACH,CACD,GAAI,CAAC,SAAS,gBAAgB,WAAzB,CAAL,CAA4C,CACxC,gBAAgB,WAAhB,CAA8B,EAA9B,CACH,CACD,GAAI,CAAC,SAAS,gBAAgB,YAAzB,CAAL,CAA6C,CACzC,gBAAgB,YAAhB,CAA+B,EAA/B,CACH,CAED;AACA;AACA,IAAK,GAAI,SAAT,GAAqB,iBAAgB,WAArC,CAAkD,CAC9C,gBAAgB,YAAhB,CAA6B,QAA7B,EAAyC,gBAAgB,WAAhB,CAA4B,QAA5B,CAAzC,CACH,CAED,GAAI,QAAS,CACT,IAAK,gBAAgB,GADZ,CAET,KAAM,gBAAgB,IAFb,CAGT,QAAS,gBAAgB,YAHhB,CAIT,MAAO,gBAAgB,KAJd,CAKT,KAAM,gBAAgB,IALb,CAMT,KAAM,gBAAgB,SANb,CAOT,OAAQ,gBAAgB,MAPf,CAQT,IAAK,gBAAgB,GARZ,CAST,OAAQ,gBAAgB,MATf,CAUT,cAAe,gBAAgB,aAVtB,CAWT,KAAM,gBAAgB,IAXb,CAYT,QAAS,eAZA,CAAb,CAeA;AACA,MAAO,YAAW,gBAAgB,IAA3B,EAAiC,WAAjC,CAA6C,MAA7C,CAAP,CACH,CAED,QAAS,aAAT,CAAsB,GAAtB,CAA2B,KAA3B,CAAkC,CAC9B,GAAI,OAAS,MAAO,OAAM,KAAb,GAAuB,UAApC,CAAgD,CAC5C,MAAM,KAAN,CAAY,GAAZ,EACH,CAFD,IAEO,CACH,IAAI,QAAJ,CAAa,KAAb,EACH,CACJ,CAED,QAAS,gBAAT,CAAyB,GAAzB,CAA8B,KAA9B,CAAqC,YAArC,CAAmD,CAC/C,GAAI,UAAU,YAAV,GAA2B,UAAU,aAAa,WAAvB,CAA/B,CAAoE,CAChE,GAAI,QAAQ,UAAR,CAAmB,aAAa,WAAhC,CAAJ,CAAkD,CAC9C,GAAI,QAAS,aAAa,WAAb,EAAb,CACA,KAAK,KAAL,CAAW,iBAAX,CAA8B,MAA9B,EACA,GAAI,OAAQ,OAAO,MAAnB,CACA,GAAI,MAAQ,CAAZ,CAAe,CACX,GAAI,SAAU,QAAS,QAAT,EAAmB,CAC7B,QACA,GAAI,QAAU,CAAd,CAAiB,CACb,IAAI,WAAJ,CAAgB,KAAhB,EACH,CACJ,CALD,CAOA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,OAAO,MAA3B,CAAmC,GAAnC,CAAwC,CACpC,OAAO,CAAP,EAAU,OAAV,CAAkB,IAAlB,CAAuB,OAAvB,EACH,CACJ,CAXD,IAWO,CACH,IAAI,WAAJ,CAAgB,KAAhB,EACH,CACJ,CAlBD,IAkBO,CACH,aAAa,WAAb,CAAyB,OAAzB,CAAiC,IAAjC,CAAsC,UAAY,CAC9C,IAAI,WAAJ,CAAgB,KAAhB,EACH,CAFD,EAGH,CACJ,CAxBD,IAwBO,CACH,IAAI,WAAJ,CAAgB,KAAhB,EACH,CACJ,CAED,GAAI,uBAAwB,QAAS,sBAAT,CAA+B,EAA/B,CAAmC,CAC3D,MAAO,UAAU,EAAV,CAAc,CACjB,GAAI,UAAU,GAAG,UAAb,CAAJ,CAA8B,CAC1B,GAAG,UAAH,CAAc,EAAd,EACH,CACJ,CAJD,CAKH,CAND,CAQA,MAAO,CACH,YAAa,YADV,CAEH,WAAY,UAFT,CAGH,aAAc,YAHX,CAIH,gBAAiB,eAJd,CAKH,sBAAuB,qBALpB,CAAP,CAOH,CAxWD,EA0WA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,sBAArC,CAA6D,SAAU,KAAV,CAAiB,EAAjB,CAAqB,IAArB,CAA2B,cAA3B,CAA2C,CACvG,GAAI,cAAe,EAAnB,CACI,UAAY,eAAe,SAD/B,CAGA,GAAI,WAAY,QAAS,UAAT,CAAmB,KAAnB,CAA0B,CACzC,GAAI,OAAQ,aAAa,KAAb,CAAZ,CACA,GAAI,MAAO,MAAM,CAAN,CAAX,CACA,MAAM,KAAK,CAAX,EAAc,IAAd,CAAmB,SAAU,IAAV,CAAgB,CAClC,MAAM,KAAN,GACA,KAAK,CAAL,CAAO,OAAP,CAAe,IAAf,EACA,GAAI,MAAM,MAAN,CAAe,CAAnB,CAAsB,CACrB,UAAU,KAAV,EACA,CACD,CAND,CAMG,SAAU,GAAV,CAAe,CACjB,MAAM,KAAN,GACA,KAAK,CAAL,CAAO,MAAP,CAAc,GAAd,EACA,GAAI,MAAM,MAAN,CAAe,CAAnB,CAAsB,CACrB,UAAU,KAAV,EACA,CACD,CAZD,EAaA,CAhBD,CAkBA,GAAI,eAAgB,QAAS,cAAT,CAAuB,GAAvB,CAA4B,UAA5B,CAAwC,IAAxC,CAA8C,GAA9C,CAAmD,CACtE,IAAI,SAAJ,CAAgB,EAAhB,CACA,GAAI,WAAW,KAAf,CAAsB,CACrB,IAAI,SAAJ,EAAiB,8CAAgD,WAAW,KAAX,CAAiB,OAAjE,CAA2E,QAA5F,CACA,CAFD,IAEO,CACN,GAAI,OAAS,QAAb,CAAuB,CACtB,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,WAAW,MAAX,CAAkB,MAAtC,CAA8C,GAA9C,CAAmD,CAClD,GAAI,OAAQ,WAAW,MAAX,CAAkB,CAAlB,CAAZ,CACA,IAAI,SAAJ,EAAiB,yCAA2C,MAAM,OAAjD,CAA2D,IAA3D,CAAkE,MAAM,SAAxE,CAAoF,QAArG,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,MAAM,MAAN,CAAa,MAAjC,CAAyC,GAAzC,CAA8C,CAC7C,GAAI,KAAM,MAAM,MAAN,CAAa,CAAb,CAAV,CACA,IAAI,SAAJ,EAAiB,qCAAuC,MAAM,OAA7C,CAAuD,mBAAvD,CAA6E,IAAI,WAAjF,CAA+F,UAA/F,CAA4G,IAAI,SAAhH,CAA4H,YAA5H,CAA2I,wCAA3I,CAAsL,MAAM,OAA5L,CAAsM,IAAtM,CAA6M,IAAI,KAAjN,CAAyN,QAA1O,CACA,CACD,CACD,CATD,IASO,IAAI,OAAS,OAAb,CAAsB,CAC5B,IAAI,SAAJ,CAAgB,aAAe,GAAf,CAAqB,KAArC,CACA,CACD,CACD,CAlBD,CAoBA,GAAI,iBAAkB,QAAS,gBAAT,CAAyB,UAAzB,CAAqC,WAArC,CAAkD,IAAlD,CAAwD,GAAxD,CAA6D,CAClF,MAAO,WAAY,OAAO,CACzB,GAAI,KAAM,EAAE,OAAF,CAAU,MAAV,CAAiB,KAAjB,CAAwB,WAAxB,CAAV,CAEA,GAAI,CAAC,EAAE,OAAF,CAAU,KAAf,CAAsB,CACrB,EAAE,QAAF,CAAW,uBAAX,CAAmC,GAAnC,EACA,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,YAAnB,CAAiC,EAAE,QAAF,CAAW,eAA5C,EACA,CAHD,IAGO,CACN,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,OAAnB,CAA4B,EAAE,QAAF,CAAW,eAAvC,EACA,CACD,cAAc,GAAd,CAAmB,UAAnB,CAA+B,IAA/B,CAAqC,GAArC,EACA,MAAO,IAAP,CACA,CAXD,CAYA,CAbD,CAeA,GAAI,sBAAuB,QAAS,qBAAT,CAA8B,MAA9B,CAAsC,WAAtC,CAAmD,CAC7E,MAAO,WAAY,OAAO,CACzB,GAAI,KAAM,EAAE,OAAF,CAAU,MAAV,CAAiB,KAAjB,CAAwB,WAAxB,CAAV,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,OAAO,MAAP,CAAc,MAAlC,CAA0C,GAA1C,CAA+C,CAC9C,IAAI,SAAJ,EAAiB,6CAA+C,OAAO,MAAP,CAAc,CAAd,CAA/C,CAAkE,cAAlE,CAAmF,0BAAnF,CAAgH,OAAO,MAAP,CAAc,CAAd,CAAhH,CAAmI,QAApJ,CACA,CACD,GAAI,CAAC,EAAE,OAAF,CAAU,KAAf,CAAsB,CACrB,EAAE,QAAF,CAAW,uBAAX,CAAmC,GAAnC,EACA,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,YAAnB,CAAiC,EAAE,QAAF,CAAW,eAA5C,EACA,CAHD,IAGO,CACN,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,OAAnB,CAA4B,EAAE,QAAF,CAAW,eAAvC,EACA,CACD,MAAO,IAAP,CACA,CAZD,CAaA,CAdD,CAgBA,MAAO,CACN,eAAgB,eADV,CAEN,oBAAqB,oBAFf,CAGN,aAAc,aAHR,CAIN,aAAc,QAAS,aAAT,CAAsB,KAAtB,CAA6B,MAA7B,CAAqC,CAClD,GAAI,GAAI,GAAG,KAAH,EAAR,CACA,GAAI,CAAC,UAAU,aAAa,KAAb,CAAV,CAAL,CAAqC,CACpC,aAAa,KAAb,EAAsB,EAAtB,CACA,CACD,aAAa,KAAb,EAAoB,IAApB,CAAyB,CAAE,EAAG,MAAL,CAAa,EAAG,CAAhB,CAAzB,EACA,GAAI,aAAa,KAAb,EAAoB,MAApB,GAA+B,CAAnC,CAAsC,CACrC,UAAU,KAAV,EACA,CACD,MAAO,GAAE,OAAT,CACA,CAdK,CAAP,CAgBA,CAzFD,EA2FA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,oBAArC,CAA2D,SAAU,EAAV,CAAc,cAAd,CAA8B,CACrF,QAAS,aAAT,EAAwB,CACpB,MAAO,CACH,SAAU,IADP,CAEH,SAAU,IAFP,CAGH,cAAe,KAHZ,CAIH,gBAAiB,IAJd,CAKH,gBAAiB,IALd,CAMH,IAAK,IANF,CAOH,UAAW,IAPR,CAQH,YAAa,IARV,CASH,kBAAmB,KAThB,CAUH,oBAAqB,SAVlB,CAWH,mBAAoB,IAXjB,CAYH,SAAU,CACN,OAAQ,CACJ,QAAS,IADL,CAEJ,SAAU,UAFN,CAGJ,UAAW,IAHP,CADF,CAZP,CAmBH,UAAW,CACP,OAAQ,4CADD,CAnBR,CAsBH,IAAK,EAAE,GAAF,CAAM,QAtBR,CAuBH,UAAW,8CAvBR,CAwBH,iBAAkB,CACd,YAAa,wFADC,CAxBf,CA2BH,KAAM,CACF,OAAQ,EADN,CAEF,QAAS,CAFP,CAGF,MAAO,SAHL,CA3BH,CAgCH,OAAQ,CACJ,IAAK,CADD,CAEJ,IAAK,CAFD,CAGJ,KAAM,CAHF,CAhCL,CAqCH,YAAa,IArCV,CAAP,CAuCH,CAED,GAAI,WAAY,eAAe,SAA/B,CACI,SAAW,eAAe,QAD9B,CAEI,qBAAuB,eAAe,oBAF1C,CAGI,SAAW,EAHf,CAKA;AACA,MAAO,CACH,MAAO,QAAS,MAAT,EAAiB,CACpB,SAAW,EAAX,CACH,CAHE,CAIH,YAAa,QAAS,YAAT,CAAqB,OAArB,CAA8B,CACvC,GAAI,OAAQ,qBAAqB,QAArB,CAA+B,OAA/B,CAAZ,CACA,MAAO,UAAS,KAAT,CAAP,CACH,CAPE,CASH,uBAAwB,QAAS,uBAAT,CAAgC,OAAhC,CAAyC,CAC7D,GAAI,OAAQ,qBAAqB,QAArB,CAA+B,OAA/B,CAAZ,CACA,GAAI,GAAI,SAAS,KAAT,CAAR,CAEA,GAAI,aAAc,CACd,QAAS,EAAE,OADG,CAEd,SAAU,EAAE,QAFE,CAGd,SAAU,EAAE,QAHE,CAId,YAAa,EAAE,WAJD,CAKd,gBAAiB,EAAE,eALL,CAMd,gBAAiB,EAAE,eANL,CAOd,IAAK,EAAE,GAPO,CAQd,UAAW,EAAE,SARC,CASd,mBAAoB,EAAE,kBATR,CAUd,cAAe,EAAE,aAVH,CAWd,IAAK,EAAE,GAXO,CAYd,YAAa,EAAE,WAZD,CAAlB,CAeA,GAAI,UAAU,EAAE,OAAZ,CAAJ,CAA0B,CACtB,YAAY,OAAZ,CAAsB,EAAE,OAAxB,CACH,CAED,GAAI,UAAU,EAAE,aAAZ,CAAJ,CAAgC,CAC5B,YAAY,aAAZ,CAA4B,EAAE,aAA9B,CACH,CAED,GAAI,UAAU,EAAE,aAAZ,CAAJ,CAAgC,CAC5B,YAAY,aAAZ,CAA4B,EAAE,aAA9B,CACH,CAED,GAAI,UAAU,EAAE,mBAAZ,CAAJ,CAAsC,CAClC,YAAY,mBAAZ,CAAkC,EAAE,mBAApC,CACH,CAED,GAAI,EAAE,GAAN,CAAW,CACP,IAAK,GAAI,OAAT,GAAmB,GAAE,GAArB,CAA0B,CACtB,YAAY,MAAZ,EAAsB,EAAE,GAAF,CAAM,MAAN,CAAtB,CACH,CACJ,CAED,MAAO,YAAP,CACH,CAnDE,CAqDH,YAAa,QAAS,YAAT,CAAqB,YAArB,CAAmC,OAAnC,CAA4C,CACrD,GAAI,aAAc,cAAlB,CAEA,GAAI,UAAU,YAAV,CAAJ,CAA6B,CACzB,YAAY,eAAZ,CAA8B,UAAU,aAAa,eAAvB,EAA0C,aAAa,eAAvD,CAAyE,YAAY,eAAnH,CACA,YAAY,eAAZ,CAA8B,UAAU,aAAa,eAAvB,EAA0C,aAAa,eAAvD,CAAyE,YAAY,eAAnH,CACA,YAAY,GAAZ,CAAkB,UAAU,aAAa,GAAvB,EAA8B,aAAa,GAA3C,CAAiD,YAAY,GAA/E,CACA,YAAY,SAAZ,CAAwB,UAAU,aAAa,SAAvB,EAAoC,aAAa,SAAjD,CAA6D,YAAY,eAAjG,CACA,YAAY,WAAZ,CAA0B,UAAU,aAAa,WAAvB,EAAsC,aAAa,WAAnD,CAAiE,YAAY,WAAvG,CACA,YAAY,iBAAZ,CAAgC,UAAU,aAAa,iBAAvB,EAA4C,aAAa,iBAAzD,CAA6E,YAAY,iBAAzH,CACA,YAAY,kBAAZ,CAAiC,UAAU,aAAa,kBAAvB,EAA6C,aAAa,kBAA1D,CAA+E,YAAY,kBAA5H,CACA,YAAY,SAAZ,CAAwB,UAAU,aAAa,SAAvB,EAAoC,aAAa,SAAjD,CAA6D,YAAY,SAAjG,CACA,YAAY,mBAAZ,CAAkC,UAAU,aAAa,mBAAvB,EAA8C,aAAa,mBAA3D,CAAiF,YAAY,mBAA/H,CACA,YAAY,QAAZ,CAAuB,UAAU,aAAa,QAAvB,EAAmC,aAAa,QAAhD,CAA2D,YAAY,QAA9F,CACA,YAAY,QAAZ,CAAuB,UAAU,aAAa,QAAvB,EAAmC,aAAa,QAAhD,CAA2D,YAAY,QAA9F,CACA,YAAY,WAAZ,CAA0B,UAAU,aAAa,WAAvB,EAAsC,aAAa,WAAnD,CAAiE,YAAY,WAAvG,CAEA,GAAI,UAAU,aAAa,QAAvB,CAAJ,CAAsC,CAClC,QAAQ,MAAR,CAAe,YAAY,QAA3B,CAAqC,aAAa,QAAlD,EACH,CAED,GAAI,SAAS,aAAa,GAAtB,CAAJ,CAAgC,CAC5B,YAAY,GAAZ,CAAkB,aAAa,GAA/B,CACH,CAFD,IAEO,IAAI,UAAU,EAAE,GAAF,CAAM,aAAa,GAAnB,CAAV,CAAJ,CAAwC,CAC3C,YAAY,GAAZ,CAAkB,EAAE,GAAF,CAAM,aAAa,GAAnB,CAAlB,CACH,CAED,GAAI,UAAU,aAAa,MAAvB,CAAJ,CAAoC,CAChC,QAAQ,IAAR,CAAa,aAAa,MAA1B,CAAkC,YAAY,MAA9C,EACH,CAED,GAAI,UAAU,aAAa,gBAAvB,CAAJ,CAA8C,CAC1C,QAAQ,IAAR,CAAa,aAAa,gBAA1B,CAA4C,YAAY,gBAAxD,EACH,CAED,GAAI,UAAU,aAAa,OAAvB,CAAJ,CAAqC,CACjC,YAAY,OAAZ,CAAsB,aAAa,OAAnC,CACH,CAED,GAAI,UAAU,aAAa,OAAvB,CAAJ,CAAqC,CACjC,YAAY,OAAZ,CAAsB,aAAa,OAAnC,CACH,CAED,GAAI,UAAU,aAAa,aAAvB,CAAJ,CAA2C,CACvC,YAAY,aAAZ,CAA4B,aAAa,aAAzC,CACH,CAED,GAAI,UAAU,aAAa,aAAvB,CAAJ,CAA2C,CACvC,YAAY,aAAZ,CAA4B,aAAa,aAAzC,CACH,CAED,GAAI,UAAU,aAAa,mBAAvB,CAAJ,CAAiD,CAC7C,YAAY,mBAAZ,CAAkC,aAAa,mBAA/C,CACH,CAED,GAAI,UAAU,aAAa,aAAvB,CAAJ,CAA2C,CACvC,YAAY,aAAZ,CAA4B,aAAa,aAAzC,CACH,CAED,GAAI,UAAU,aAAa,GAAvB,CAAJ,CAAiC,CAC7B,YAAY,GAAZ,CAAkB,aAAa,GAA/B,CACH,CAED,GAAI,UAAU,aAAa,IAAvB,CAAJ,CAAkC,CAC9B,YAAY,IAAZ,CAAmB,aAAa,IAAhC,CACH,CACJ,CAED,GAAI,OAAQ,qBAAqB,QAArB,CAA+B,OAA/B,CAAZ,CACA,SAAS,KAAT,EAAkB,WAAlB,CACA,MAAO,YAAP,CACH,CA5HE,CAAP,CA8HH,CA/KD,EAiLA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,uBAArC,CAA8D,SAAU,UAAV,CAAsB,QAAtB,CAAgC,cAAhC,CAAgD,aAAhD,CAA+D,QAA/D,CAAyE,qBAAzE,CAAgG,mBAAhG,CAAqH,CAC/K,GAAI,WAAY,eAAe,SAA/B,CACI,UAAY,eAAe,SAD/B,CAEI,oBAAsB,eAAe,mBAFzC,CAGI,qBAAuB,eAAe,oBAH1C,CAII,oBAAsB,eAAe,mBAJzC,CAKI,kBAAoB,eAAe,iBALvC,CAMI,mBAAqB,eAAe,kBANxC,CAOI,iBAAmB,eAAe,gBAPtC,CAQI,UAAY,eAAe,SAR/B,CASI,QAAU,cATd,CAUI,SAAW,eAAe,QAV9B,CAWI,SAAW,eAAe,QAX9B,CAYI,SAAW,eAAe,QAZ9B,CAaI,OAAS,EAbb,CAcI,OAAS,qBAdb,CAeI,YAAc,eAAe,WAfjC,CAgBI,WAAa,oBAAoB,UAhBrC,CAiBI,KAAO,aAjBX,CAmBA,GAAI,SAAU,QAAS,QAAT,CAAiB,MAAjB,CAAyB,CACnC;AACA,GAAI,QAAS,EAAb,CACA,CAAC,OAAD,CAAU,SAAV,CAAqB,aAArB,CAAoC,MAApC,CAA4C,SAA5C,EAAuD,OAAvD,CAA+D,SAAU,IAAV,CAAgB,CAC3E,QAAU,KAAO,IAAP,CAAc,UAAU,OAAO,IAAP,CAAV,CAAwB,WAAxB,CAAd,CAAqD,KAA/D,CACH,CAFD,EAGA,MAAO,uBAAyB,MAAhC,CACH,CAPD,CAQA,GAAI,MAAO,QAAS,KAAT,CAAc,MAAd,CAAsB,UAAtB,CAAkC,CACzC,GAAI,QAAS,WAAa,OAAb,CAAuB,IAApC,CACA,OAAO,KAAP,CAAa,QAAQ,MAAR,CAAb,EACH,CAHD,CAKA,GAAI,mBAAoB,QAAS,kBAAT,CAA2B,SAA3B,CAAsC,CAC1D,MAAO,SAAQ,OAAR,CAAgB,OAAO,SAAP,EAAkB,IAAlB,CAAuB,UAAvC,EAAmD,MAAnD,GAA4D,MAA5D,CAAqE,CAA5E,CACH,CAFD,CAIA,GAAI,mBAAoB,QAAS,kBAAT,CAA2B,QAA3B,CAAqC,CACzD,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,eAAzE,CAA0F,CACtF,GAAI,CAAC,qBAAqB,QAArB,EAAL,CAAsC,CAClC,KAAK,KAAL,CAAW,YAAc,2CAAzB,EACH,CAED,MAAO,IAAI,GAAE,cAAF,CAAiB,IAArB,CAA0B,QAA1B,CAAP,CACH,CAED,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,cAAzE,CAAyF,CACrF,GAAI,CAAC,oBAAoB,QAApB,EAAL,CAAqC,CACjC,KAAK,KAAL,CAAW,YAAc,0CAAzB,EACH,CAED,MAAO,IAAI,GAAE,aAAF,CAAgB,IAApB,CAAyB,QAAzB,CAAP,CACH,CAED,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,YAAzE,CAAuF,CACnF,GAAI,CAAC,kBAAkB,QAAlB,EAAL,CAAmC,CAC/B,KAAK,KAAL,CAAW,YAAc,uCAAzB,EACH,CAED,MAAO,IAAI,GAAE,WAAF,CAAc,IAAlB,CAAuB,QAAvB,CAAP,CACH,CAED,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,aAAzE,CAAwF,CACpF,GAAI,CAAC,mBAAmB,QAAnB,EAAL,CAAoC,CAChC,KAAK,KAAL,CAAW,YAAc,wCAAzB,EACH,CACD,MAAO,IAAI,GAAE,YAAF,CAAe,IAAnB,CAAwB,QAAxB,CAAP,CACH,CAED,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,KAAzE,CAAgF,CAC5E,MAAO,IAAI,GAAE,OAAN,CAAc,QAAd,CAAP,CACH,CAED,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,KAAzE,CAAgF,CAC5E,GAAI,CAAC,iBAAiB,QAAjB,EAAL,CAAkC,CAC9B,KAAK,KAAL,CAAW,YAAc,sCAAzB,EACH,CACD,GAAI,aAAc,QAAQ,UAAR,CAAmB,SAAS,cAA5B,EAA8C,SAAS,cAAT,GAA0B,IAA1B,EAA9C,CAAiF,UAAnG,CACI,SAAW,SAAS,SAAS,QAAlB,EAA4B,WAA5B,CADf,CAEI,aAAe,QAAQ,IAAR,CAAa,QAAb,CAFnB,CAGA,aAAa,SAAb,CAAyB,QAAzB,CACA,aAAa,OAAb,CAAuB,SAAS,CAAT,CAAvB,CACA,GAAI,QAAQ,UAAR,CAAmB,SAAS,cAA5B,CAAJ,CAAiD,aAAa,KAAb,CAAqB,WAArB,CACjD,MAAO,IAAI,GAAE,UAAF,CAAa,IAAjB,CAAsB,YAAtB,CAAP,CACH,CAED;AACA,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,IAAnB,CAAvB,EAAmD,SAAS,IAAT,GAAkB,MAAzE,CAAiF,CAC7E,MAAO,UAAS,IAAhB,CACH,CAED,GAAI,YAAa,ozEAAjB,CACA,GAAI,cAAe,gkCAAnB,CAEA,GAAI,CAAC,UAAU,QAAV,CAAD,EAAwB,CAAC,UAAU,SAAS,OAAnB,CAA7B,CAA0D,CACtD,MAAO,IAAI,GAAE,IAAF,CAAO,OAAX,CAAmB,CACtB,QAAS,UADa,CAEtB,UAAW,YAFW,CAGtB,SAAU,CAAC,EAAD,CAAK,EAAL,CAHY,CAItB,WAAY,CAAC,EAAD,CAAK,EAAL,CAJU,CAKtB,YAAa,CAAC,CAAD,CAAI,CAAC,EAAL,CALS,CAMtB,WAAY,CAAC,EAAD,CAAK,EAAL,CANU,CAAnB,CAAP,CAQH,CAED,MAAO,IAAI,GAAE,IAAN,CAAW,QAAX,CAAP,CACH,CArED,CAuEA,GAAI,mBAAoB,QAAS,kBAAT,CAA2B,SAA3B,CAAsC,CAC1D,GAAI,UAAU,OAAO,SAAP,CAAV,CAAJ,CAAkC,CAC9B,MAAO,QAAO,SAAP,CAAP,CACH,CACJ,CAJD,CAMA,GAAI,oBAAqB,QAAS,mBAAT,EAA8B,CACnD,OAAS,EAAT,CACH,CAFD,CAIA,GAAI,0BAA2B,QAAS,yBAAT,EAAoC,CAC/D,IAAK,GAAI,UAAT,GAAsB,OAAtB,CAA8B,CAC1B,GAAI,CAAC,kBAAkB,SAAlB,CAAL,CAAmC,CAC/B,kBAAkB,SAAlB,EACH,CACJ,CACJ,CAND,CAQA,GAAI,eAAgB,QAAS,cAAT,CAAuB,MAAvB,CAA+B,CAC/C,GAAI,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,SAAhC,CAA2C,CACvC,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,SAA5B,CAAsC,MAAtC,GACH,CACD,GAAI,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,KAAhC,CAAuC,CACnC,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,KAA5B,CAAkC,QAAlC,GACH,CACJ,CAPD,CASA,GAAI,eAAgB,QAAS,cAAT,CAAuB,MAAvB,CAA+B,GAA/B,CAAoC,MAApC,CAA4C,CAC5D,OAAO,UAAP,GAEA;AACA,GAAI,OAAO,OAAP,CAAe,IAAf,EAAuB,OAAO,OAAP,CAAe,IAAf,CAAoB,OAA3C,EAAsD,OAAO,OAAP,CAAe,IAAf,CAAoB,OAApB,CAA4B,IAA5B,GAAqC,KAA/F,CAAsG,CAClG,cAAc,MAAd,EACH,CAED;AACA;AACA,GAAI,UAAU,MAAV,GAAqB,UAAU,OAAO,QAAjB,CAAzB,CAAqD,CACjD,IAAK,GAAI,IAAT,GAAgB,QAAO,QAAvB,CAAiC,CAC7B,GAAI,OAAO,QAAP,CAAgB,GAAhB,WAAgC,GAAE,UAAlC,EAAgD,OAAO,QAAP,CAAgB,GAAhB,WAAgC,GAAE,YAAtF,CAAoG,CAChG,GAAI,OAAO,QAAP,CAAgB,GAAhB,EAAqB,QAArB,CAA8B,MAA9B,CAAJ,CAA2C,CACvC,OAAO,QAAP,CAAgB,GAAhB,EAAqB,WAArB,CAAiC,MAAjC,EACA,OACH,CACJ,CACJ,CACJ,CAED,GAAI,UAAU,MAAV,CAAJ,CAAuB,CACnB,IAAK,GAAI,SAAT,GAAqB,OAArB,CAA6B,CACzB,GAAI,OAAO,QAAP,EAAiB,QAAjB,CAA0B,MAA1B,CAAJ,CAAuC,CACnC,OAAO,QAAP,EAAiB,WAAjB,CAA6B,MAA7B,EACH,CACJ,CACJ,CAED,GAAI,IAAI,QAAJ,CAAa,MAAb,CAAJ,CAA0B,CACtB,IAAI,WAAJ,CAAgB,MAAhB,EACH,CACJ,CAhCD,CAkCA,GAAI,gBAAiB,QAAS,eAAT,CAAwB,MAAxB,CAAgC,GAAhC,CAAqC,CACtD,GAAI,iBAAkB,OAAO,MAAP,CAAc,UAAd,CAAyB,YAA/C,CACI,SAAW,GAAI,GAAE,KAAN,CAAY,OAAO,MAAP,CAAc,cAA1B,CAA0C,CAAC,eAAD,CAAmB,OAAO,MAAP,CAAc,gBAA3E,CADf,CAEI,aAAe,IAAI,0BAAJ,CAA+B,QAA/B,CAFnB,CAGA,GAAI,eAAiB,IAArB,CAA2B,CACvB,OAAO,MAAP,CAAc,UAAd,GACH,CACJ,CAPD,CASA,GAAI,cAAe,QAAS,aAAT,CAAsB,MAAtB,CAA8B,WAA9B,CAA2C,CAC1D,SAAS,OAAO,MAAP,CAAc,YAAvB,EAAqC,WAArC,EACH,CAFD,CAIA,GAAI,aAAc,QAAS,YAAT,CAAqB,MAArB,CAA6B,WAA7B,CAA0C,GAA1C,CAA+C,CAC7D;AACA;AACA;AACA;AACA,GAAI,WAAY,OAAO,MAAP,CAAc,YAAd,CAA2B,SAA3B,EAAwC,OAAO,MAAP,CAAc,YAAd,CAA2B,WAAnF,CACA,GAAI,UAAU,MAAV,CAAmB,CAAvB,CAA0B,CACtB,SAAS,UAAY,CACjB,YAAY,MAAZ,CAAoB,WAApB,CAAiC,GAAjC,EACH,CAFD,EAGH,CAED;AACA,GAAI,QAAS,OAAO,MAAP,CAAc,YAAd,CAA2B,WAAxC,CAEA,OAAO,MAAP,CAAc,aAAd,GACA,OAAO,MAAP,CAAc,eAAd,GAEA,GAAI,OAAO,MAAP,CAAc,OAAd,CAAsB,OAA1B,CAAmC,CAC/B,eAAe,MAAf,CAAuB,GAAvB,EACH,CAED;AACA,MAAO,OAAP,CACH,CAxBD,CA0BA,GAAI,kBAAmB,QAAS,iBAAT,CAA0B,MAA1B,CAAkC,UAAlC,CAA8C,GAA9C,CAAmD,CACtE;AACA;AACA,GAAI,aAAc,QAAQ,UAAR,CAAmB,WAAW,eAA9B,EAAiD,WAAW,eAAX,EAAjD,CAAgF,UAAlG,CACI,eAAiB,UAAU,WAAW,cAArB,EAAuC,WAAW,cAAlD,CAAmE,IADxF,CAGA,GAAI,cAAJ,CAAoB,CAChB,GAAI,CAAC,UAAU,OAAO,MAAjB,CAAD,EAA6B,CAAC,UAAU,OAAO,MAAP,CAAc,YAAxB,CAAlC,CAAyE,CACrE,KAAK,KAAL,CAAW,YAAc,gDAAzB,EACA,MAAO,MAAP,CACH,CAED,aAAa,MAAb,CAAqB,WAArB,EACA,YAAY,MAAZ,CAAoB,UAApB,CAAgC,GAAhC,EACH,CACJ,CAfD,CAiBA,GAAI,kBAAmB,QAAS,iBAAT,CAA0B,MAA1B,CAAkC,UAAlC,CAA8C,CACjE,GAAI,aAAc,QAAQ,UAAR,CAAmB,WAAW,eAA9B,EAAiD,WAAW,eAAX,EAAjD,CAAgF,UAAlG,CACI,WAAa,QAAQ,UAAR,CAAmB,WAAW,aAA9B,EAA+C,WAAW,aAAX,EAA/C,CAA4E,WAD7F,CAEI,eAAiB,UAAU,WAAW,cAArB,EAAuC,WAAW,cAAlD,CAAmE,IAFxF,CAIA,GAAI,QAAQ,WAAR,CAAoB,QAApB,IAAkC,UAAU,WAAW,KAArB,CAAtC,CAAmE,CAC/D,GAAI,UAAU,WAAW,KAAX,CAAiB,OAA3B,GAAuC,WAAW,KAAX,CAAiB,OAAjB,CAAyB,MAAzB,GAAoC,IAA/E,CAAqF,CACjF,OAAO,SAAP,GACH,CACD,GAAI,gBAAkB,UAAU,OAAO,KAAjB,CAAtB,CAA+C,CAC3C,SAAS,OAAO,KAAP,CAAa,UAAtB,EAAkC,UAAlC,EACH,CACJ,CACJ,CAbD,CAeA,GAAI,eAAgB,QAAS,cAAT,CAAuB,UAAvB,CAAmC,aAAnC,CAAkD,MAAlD,CAA0D,IAA1D,CAAgE,YAAhE,CAA8E,MAA9E,CAAsF,GAAtF,CAA2F,CAC3G,GAAI,CAAC,UAAU,aAAV,CAAL,CAA+B,CAC3B,OACH,CAED;AACA,GAAI,CAAC,OAAO,cAAP,CAAsB,UAAtB,CAAL,CAAwC,CACpC,KAAK,IAAL,CAAU,uEAAV,EACA,cAAc,MAAd,CAAsB,GAAtB,CAA2B,MAA3B,EACA,OACH,CAED;AACA,GAAI,gBAAiB,aAAe,aAApC,CAEA;AACA,GAAI,UAAU,WAAW,SAArB,GAAmC,cAAc,SAAd,GAA4B,WAAW,SAA9E,CAAyF,CACrF,OAAO,YAAP,CAAoB,WAAW,SAA/B,EACH,CAED;AACA;AACA,GAAI,CAAC,SAAS,WAAW,KAApB,CAAL,CAAiC,CAC7B;AACA,GAAI,SAAS,cAAc,KAAvB,CAAJ,CAAmC,CAC/B;AACA,GAAI,UAAU,OAAO,QAAP,CAAgB,cAAc,KAA9B,CAAV,GAAmD,OAAO,QAAP,CAAgB,cAAc,KAA9B,EAAqC,QAArC,CAA8C,MAA9C,CAAvD,CAA8G,CAC1G,OAAO,QAAP,CAAgB,cAAc,KAA9B,EAAqC,WAArC,CAAiD,MAAjD,EACA,OAAO,UAAP,GACH,CACD;AACA,GAAI,CAAC,IAAI,QAAJ,CAAa,MAAb,CAAL,CAA2B,CACvB,IAAI,QAAJ,CAAa,MAAb,EACH,CACJ,CACJ,CAED,GAAI,CAAC,SAAS,WAAW,OAApB,GAAgC,SAAS,WAAW,WAAW,OAAtB,CAAT,CAAjC,GAA8E,WAAW,OAAX,GAAuB,cAAc,OAAvH,CAAgI,CAC5H;AACA,OAAO,UAAP,CAAkB,WAAW,OAA7B,EACH,CAED,GAAI,SAAS,WAAW,KAApB,GAA8B,cAAc,KAAd,GAAwB,WAAW,KAArE,CAA4E,CACxE;AACA,GAAI,SAAS,cAAc,KAAvB,GAAiC,UAAU,OAAO,QAAP,CAAgB,cAAc,KAA9B,CAAV,CAAjC,EAAoF,OAAO,QAAP,CAAgB,cAAc,KAA9B,EAAqC,QAArC,CAA8C,MAA9C,CAAxF,CAA+I,CAC3I,OAAO,QAAP,CAAgB,cAAc,KAA9B,EAAqC,WAArC,CAAiD,MAAjD,EACH,CACD,OAAO,UAAP,GAEA;AACA,GAAI,IAAI,QAAJ,CAAa,MAAb,CAAJ,CAA0B,CACtB,IAAI,WAAJ,CAAgB,MAAhB,EACH,CAED;AACA,GAAI,CAAC,UAAU,OAAO,QAAP,CAAgB,WAAW,KAA3B,CAAV,CAAL,CAAmD,CAC/C,KAAK,KAAL,CAAW,YAAc,0CAAzB,EACA,OACH,CACD;AACA,GAAI,YAAa,OAAO,QAAP,CAAgB,WAAW,KAA3B,CAAjB,CACA,GAAI,EAAE,qBAAsB,GAAE,UAAxB,EAAsC,qBAAsB,GAAE,YAAhE,CAAJ,CAAmF,CAC/E,KAAK,KAAL,CAAW,YAAc,yEAAzB,EACA,OACH,CACD;AACA,WAAW,QAAX,CAAoB,MAApB,EACA;AACA;AACA,GAAI,IAAI,QAAJ,CAAa,MAAb,GAAwB,WAAW,KAAX,GAAqB,IAAjD,CAAuD,CACnD,OAAO,SAAP,GACH,CACJ,CAED;AACA,GAAI,WAAW,SAAX,GAAyB,IAAzB,EAAiC,cAAc,SAAd,GAA4B,IAA7D,EAAqE,UAAU,OAAO,QAAjB,CAAzE,CAAqG,CACjG,OAAO,QAAP,CAAgB,OAAhB,GACH,CAED,GAAI,WAAW,SAAX,GAAyB,IAAzB,EAAiC,cAAc,SAAd,GAA4B,IAAjE,CAAuE,CACnE;AACA,GAAI,OAAO,QAAX,CAAqB,CACjB,OAAO,QAAP,CAAgB,MAAhB,GACH,CAFD,IAEO,CACH,GAAI,EAAE,OAAF,CAAU,UAAd,CAA0B,CACtB,OAAO,QAAP,CAAkB,GAAI,GAAE,OAAF,CAAU,UAAd,CAAyB,MAAzB,CAAlB,CACA,OAAO,OAAP,CAAe,SAAf,CAA2B,IAA3B,CACA,OAAO,QAAP,CAAgB,MAAhB,GACH,CACJ,CACJ,CAED;AACA,GAAI,CAAC,SAAS,WAAW,IAApB,CAAL,CAAgC,CAC5B;AACA,GAAI,SAAS,cAAc,IAAvB,CAAJ,CAAkC,CAC9B,GAAI,cAAc,IAAd,CAAmB,IAAnB,GAA4B,KAAhC,CAAuC,CACnC;AACA,cAAc,MAAd,EACH,CACD;AACA,OAAO,OAAP,CAAe,mBAAf,EACA,OAAO,UAAP,GACA,OAAO,WAAP,GACA,GAAI,SAAS,WAAW,OAApB,CAAJ,CAAkC,CAC9B,OAAO,SAAP,CAAiB,WAAW,OAA5B,CAAqC,WAAW,YAAhD,EACH,CACJ,CACJ,CAED,GAAI,SAAS,WAAW,IAApB,GAA6B,SAAS,cAAc,IAAvB,CAA7B,EAA6D,CAAC,QAAQ,MAAR,CAAe,WAAW,IAA1B,CAAgC,cAAc,IAA9C,CAAlE,CAAuH,CACnH,GAAI,OAAQ,KAAZ,CACA,GAAI,OAAO,QAAX,CAAqB,CACjB,MAAQ,OAAO,QAAP,CAAgB,OAAhB,EAAR,CACH,CACD,GAAI,cAAc,IAAd,CAAmB,IAAnB,GAA4B,KAAhC,CAAuC,CACnC;AACA,cAAc,MAAd,EACH,CACD,OAAO,OAAP,CAAe,kBAAkB,WAAW,IAA7B,CAAf,EACA,GAAI,KAAJ,CAAW,CACP,OAAO,QAAP,CAAgB,MAAhB,GACH,CACD,OAAO,UAAP,GACA,OAAO,WAAP,GACA,GAAI,SAAS,WAAW,OAApB,CAAJ,CAAkC,CAC9B,OAAO,SAAP,CAAiB,WAAW,OAA5B,CAAqC,WAAW,YAAhD,EACA;AACA,GAAI,IAAI,QAAJ,CAAa,MAAb,GAAwB,WAAW,KAAX,GAAqB,IAAjD,CAAuD,CACnD,OAAO,SAAP,GACH,CACJ,CACJ,CAED;AACA,GAAI,CAAC,SAAS,WAAW,OAApB,CAAD,EAAiC,SAAS,cAAc,OAAvB,CAArC,CAAsE,CAClE,OAAO,UAAP,GACA,OAAO,WAAP,GACH,CAED;AACA,GAAI,QAAQ,WAAR,CAAoB,QAApB,EAAJ,CAAoC,CAChC,GAAI,UAAU,WAAW,KAArB,GAA+B,UAAU,WAAW,KAAX,CAAiB,OAA3B,CAAnC,CAAwE,CACpE,GAAI,SAAW,cAAX,EAA4B,WAAa,eAAc,KAAvD,EAAgE,CAAC,QAAQ,MAAR,CAAe,WAAW,KAAX,CAAiB,OAAhC,CAAyC,cAAc,KAAd,CAAoB,OAA7D,CAArE,CAA4I,CACxI,OAAO,kBAAP,CAA0B,WAAW,KAAX,CAAiB,OAA3C,EACH,CAFD,IAEO,IAAI,CAAC,QAAQ,UAAR,CAAmB,OAAO,QAA1B,CAAD,EAAwC,QAAQ,UAAR,CAAmB,OAAO,QAA1B,GAAuC,CAAC,UAAU,OAAO,QAAP,EAAV,CAApF,CAAkH,CACrH,OAAO,SAAP,CAAiB,WAAW,KAAX,CAAiB,OAAlC,CAA2C,WAAW,KAAX,CAAiB,OAA5D,EACA,iBAAiB,MAAjB,CAAyB,UAAzB,EACH,CAHM,IAGA,CACH,iBAAiB,MAAjB,CAAyB,UAAzB,EACH,CACJ,CATD,IASO,IAAI,EAAE,SAAW,WAAX,EAAyB,EAAE,WAAa,YAAW,KAA1B,CAA3B,CAAJ,CAAkE,CACrE,GAAI,QAAQ,UAAR,CAAmB,OAAO,WAA1B,CAAJ,CAA4C,CACxC,OAAO,WAAP,GACH,CACJ,CACJ,CAED;AACA,GAAI,SAAS,WAAW,OAApB,GAAgC,CAAC,SAAS,cAAc,OAAvB,CAArC,CAAsE,CAClE;AACA,OAAO,SAAP,CAAiB,WAAW,OAA5B,CAAqC,WAAW,YAAhD,EACH,CAED,GAAI,SAAS,WAAW,OAApB,GAAgC,SAAS,cAAc,OAAvB,CAAhC,EAAmE,WAAW,OAAX,GAAuB,cAAc,OAA5G,CAAqH,CACjH;AACA,OAAO,eAAP,CAAuB,WAAW,OAAlC,EACH,CAED;AACA,GAAI,cAAe,KAAnB,CACA,GAAI,WAAW,KAAX,GAAqB,IAArB,EAA6B,cAAc,KAAd,GAAwB,IAAzD,CAA+D,CAC3D;AACA,OAAO,UAAP,GACA,aAAe,IAAf,CACH,CAED;AACA,GAAI,WAAW,KAAX,GAAqB,IAArB,GAA8B,CAAC,UAAU,cAAc,KAAxB,CAAD,EAAmC,cAAc,KAAd,GAAwB,KAAzF,GAAmG,gBAAkB,WAAW,KAAX,GAAqB,IAA9I,CAAoJ,CAChJ;AACA,OAAO,SAAP,GACA,aAAe,IAAf,CACH,CAED;AACA,GAAI,cAAc,YAAd,GAA+B,WAAW,YAA9C,CAA4D,CACxD,OAAO,eAAP,CAAuB,WAAW,YAAlC,EACH,CAED,GAAI,cAAe,OAAO,SAAP,EAAnB,CACA,GAAI,WAAY,SAAS,WAAW,KAApB,GAA8B,QAAQ,mBAAR,CAA4B,EAA5B,CAA+B,OAAO,QAAP,CAAgB,WAAW,KAA3B,CAA/B,CAA9C,CACA;AACA,GAAI,SAAJ,CAAe,CACX;AACA,GAAI,YAAJ,CAAkB,CACd;AACA;AACA;AACA,GAAI,WAAW,GAAX,GAAmB,cAAc,GAAjC,EAAwC,WAAW,GAAX,GAAmB,cAAc,GAA7E,CAAkF,CAC9E,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,WAAlC,CAA8C,MAA9C,EACA,OAAO,SAAP,CAAiB,CAAC,WAAW,GAAZ,CAAiB,WAAW,GAA5B,CAAjB,EACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,QAAlC,CAA2C,MAA3C,EACH,CACJ,CATD,IASO,CACH;AACA;AACA,GAAI,aAAa,GAAb,GAAqB,WAAW,GAAhC,EAAuC,aAAa,GAAb,GAAqB,WAAW,GAA3E,CAAgF,CAC5E;AACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,WAAlC,CAA8C,MAA9C,EACA,OAAO,SAAP,CAAiB,CAAC,WAAW,GAAZ,CAAiB,WAAW,GAA5B,CAAjB,EACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,QAAlC,CAA2C,MAA3C,EACH,CALD,IAKO,IAAI,WAAW,GAAX,GAAmB,cAAc,GAAjC,EAAwC,WAAW,GAAX,GAAmB,cAAc,GAA7E,CAAkF,CACrF;AACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,WAAlC,CAA8C,MAA9C,EACA,OAAO,SAAP,CAAiB,CAAC,WAAW,GAAZ,CAAiB,WAAW,GAA5B,CAAjB,EACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,QAAlC,CAA2C,MAA3C,EACH,CALM,IAKA,IAAI,SAAS,WAAW,IAApB,GAA6B,SAAS,cAAc,IAAvB,CAA7B,EAA6D,CAAC,QAAQ,MAAR,CAAe,WAAW,IAA1B,CAAgC,cAAc,IAA9C,CAAlE,CAAuH,CAC1H,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,WAAlC,CAA8C,MAA9C,EACA,OAAO,QAAP,CAAgB,WAAW,KAA3B,EAAkC,QAAlC,CAA2C,MAA3C,EACH,CACJ,CACJ,CA7BD,IA6BO,IAAI,aAAa,GAAb,GAAqB,WAAW,GAAhC,EAAuC,aAAa,GAAb,GAAqB,WAAW,GAA3E,CAAgF,CACnF,OAAO,SAAP,CAAiB,CAAC,WAAW,GAAZ,CAAiB,WAAW,GAA5B,CAAjB,EACH,CACJ,CAhOD,CAkOA,GAAI,iBAAkB,QAAS,gBAAT,CAAyB,MAAzB,CAAiC,SAAjC,CAA4C,CAC9D,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,OACxB,GAAI,SAAJ,CAAe,MAAO,QAAO,SAAP,CAAP,CACf,MAAO,OAAP,CACH,CAJD,CAMA,GAAI,qBAAsB,QAAS,oBAAT,CAA6B,MAA7B,CAAqC,EAArC,CAAyC,SAAzC,CAAoD,CAC1E,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,OACxB,GAAI,CAAC,EAAL,CAAS,CACL,KAAK,KAAL,CAAW,YAAc,gCAAzB,EACA,OACH,CACD,GAAI,SAAJ,CAAe,MAAO,QAAO,SAAP,EAAkB,EAAlB,CAAP,CAEf,MAAO,QAAO,EAAP,CAAP,CACH,CATD,CAUA,MAAO,CACH,iBAAkB,iBADf,CAGH,kBAAmB,kBAHhB,CAKH,wBAAyB,wBALtB,CAOH,aAAc,aAPX,CASH,gBAAiB,gBATd,CAWH,gBAAiB,gBAXd,CAaH,aAAc,QAAS,aAAT,CAAsB,UAAtB,CAAkC,CAC5C,GAAI,CAAC,UAAU,UAAV,CAAD,EAA0B,CAAC,OAAO,cAAP,CAAsB,UAAtB,CAA/B,CAAkE,CAC9D,KAAK,KAAL,CAAW,YAAc,qCAAzB,EACA,OACH,CACD,GAAI,QAAS,OAAO,SAAP,CAAiB,UAAjB,CAAb,CAEA,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,CACpB,KAAK,KAAL,CAAW,YAAc,4CAAzB,EACA,OACH,CAED,GAAI,eAAgB,CAChB,KAAM,kBAAkB,WAAW,IAA7B,CADU,CAEhB,MAAO,UAAU,WAAW,KAArB,EAA8B,WAAW,KAAzC,CAAiD,EAFxC,CAGhB,UAAW,UAAU,WAAW,SAArB,EAAkC,WAAW,SAA7C,CAAyD,KAHpD,CAIhB,UAAW,UAAU,WAAW,SAArB,EAAkC,WAAW,SAA7C,CAAyD,IAJpD,CAKhB,YAAa,UAAU,WAAW,WAArB,EAAoC,WAAW,WAA/C,CAA6D,KAL1D,CAMhB,aAAc,UAAU,WAAW,YAArB,EAAqC,WAAW,YAAhD,CAA+D,CAN7D,CAOhB,UAAW,UAAU,WAAW,SAArB,EAAkC,WAAW,SAA7C,CAAyD,CAPpD,CAApB,CASA;AACA,IAAK,GAAI,YAAT,GAAwB,WAAxB,CAAoC,CAChC,GAAI,WAAW,cAAX,CAA0B,WAA1B,GAA0C,CAAC,cAAc,cAAd,CAA6B,WAA7B,CAA/C,CAA0F,CACtF,cAAc,WAAd,EAA6B,WAAW,WAAX,CAA7B,CACH,CACJ,CAED,GAAI,QAAS,GAAI,GAAE,MAAN,CAAa,MAAb,CAAqB,aAArB,CAAb,CAEA,GAAI,CAAC,SAAS,WAAW,OAApB,CAAL,CAAmC,CAC/B,OAAO,WAAP,GACH,CAED,MAAO,OAAP,CACH,CAhDE,CAkDH,iBAAkB,QAAS,iBAAT,CAA0B,MAA1B,CAAkC,SAAlC,CAA6C,YAA7C,CAA2D,GAA3D,CAAgE,CAC9E,GAAI,CAAC,SAAS,SAAT,CAAL,CAA0B,CACtB,KAAK,KAAL,CAAW,YAAc,iDAAzB,EACA,OACH,CAED,GAAI,CAAC,oBAAoB,QAApB,EAAL,CAAqC,CACjC,KAAK,KAAL,CAAW,YAAc,yCAAzB,EACA,OACH,CACD,GAAI,CAAC,UAAU,OAAO,SAAP,CAAV,CAAL,CAAmC,CAC/B,OAAO,SAAP,EAAoB,GAAI,GAAE,kBAAN,CAAyB,YAAzB,CAApB,CACA,IAAI,QAAJ,CAAa,OAAO,SAAP,CAAb,EACH,CACD,OAAO,SAAP,EAAkB,QAAlB,CAA2B,MAA3B,EACH,CAjEE,CAmEH,mBAAoB,QAAS,mBAAT,CAA4B,MAA5B,CAAoC,UAApC,CAAgD,YAAhD,CAA8D,SAA9D,CAAyE,GAAzE,CAA8E,CAC9F,OAAO,EAAP,CAAU,WAAV,CAAuB,UAAY,WAAW,CAC1C,UAAU,YAAV,CAAwB,UAAY,CAChC,GAAI,UAAU,OAAO,MAAjB,GAA4B,UAAU,OAAO,MAAP,CAAc,YAAxB,CAAhC,CAAuE,CACnE,WAAW,KAAX,CAAmB,IAAnB,CACA,iBAAiB,MAAjB,CAAyB,UAAzB,CAAqC,GAArC,EAA2C;AAC9C,CACJ,CALD,EAMH,CAPD,EAQA,OAAO,EAAP,CAAU,YAAV,CAAwB,UAAY,WAAW,CAC3C,UAAU,YAAV,CAAwB,UAAY,CAChC,WAAW,KAAX,CAAmB,KAAnB,CACH,CAFD,EAGH,CAJD,EAKA,OAAO,EAAP,CAAU,KAAV,CAAiB,UAAY,WAAW,CACpC,UAAU,YAAV,CAAwB,UAAY,CAChC,GAAI,SAAW,WAAf,CAA2B,iBAAiB,MAAjB,CAAyB,UAAzB,EAC9B,CAFD,EAGH,CAJD,EAKH,CAtFE,CAwFH,aAAc,aAxFX,CA0FH,iBAAkB,QAAS,iBAAT,CAA0B,MAA1B,CAAkC,IAAlC,CAAwC,YAAxC,CAAsD,MAAtD,CAA8D,GAA9D,CAAmE,YAAnE,CAAiF,CAC/F,GAAI,iBAAkB,QAAQ,kBAAR,CAA2B,WAAa,IAAxC,CAAtB,CAEA,WAAW,YAAX,CAAyB,eAAzB,CAA0C,YAA1C,CAAwD,SAAU,UAAV,CAAsB,aAAtB,CAAqC,UAArC,CAAiD,CACrG,GAAI,CAAC,UAAU,UAAV,CAAL,CAA4B,CACxB,cAAc,MAAd,CAAsB,GAAtB,CAA2B,MAA3B,EACA,aACA,OACH,CACD,cAAc,UAAd,CAA0B,aAA1B,CAAyC,MAAzC,CAAiD,IAAjD,CAAuD,YAAvD,CAAqE,MAArE,CAA6E,GAA7E,EACH,CAPD,EAQH,CArGE,CAsGH,OAAQ,OAtGL,CAuGH,IAAK,IAvGF,CAwGH,mBAAoB,mBAxGjB,CAyGH,eAAgB,eAzGb,CAAP,CA2GH,CA7kBD,EA+kBA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,qBAArC,CAA4D,SAAU,UAAV,CAAsB,aAAtB,CAAqC,cAArC,CAAqD,CAC7G,GAAI,WAAY,eAAe,SAA/B,CACI,QAAU,eAAe,OAD7B,CAEI,SAAW,eAAe,QAF9B,CAGI,aAAe,eAAe,YAHlC,CAII,KAAO,aAJX,CAMA,GAAI,kBAAmB,CACvB;AACA,QAFuB,CAEb,QAFa,CAEH,OAFG,CAEM,SAFN,CAEiB,MAFjB,CAEyB,WAFzB,CAEsC,aAFtC,CAEqD,WAFrD,CAEkE,SAFlE,CAE6E,UAF7E,CAEyF,WAFzF,CAEsG,eAFtG,CAEuH,WAFvH,CAIvB;AACA,cALuB,CAKP,QALO,CAAvB,CAMA,QAAS,yBAAT,CAAkC,OAAlC,CAA2C,CACvC,MAAO,SAAQ,MAAR,CAAe,SAAU,MAAV,CAAkB,CACpC,MAAO,cAAa,MAAb,CAAP,CACH,CAFM,EAEJ,GAFI,CAEA,SAAU,MAAV,CAAkB,CACrB,MAAO,yBAAwB,MAAxB,CAAP,CACH,CAJM,CAAP,CAKH,CAED,QAAS,wBAAT,CAAiC,MAAjC,CAAyC,CACrC,GAAI,QAAQ,MAAR,CAAJ,CAAqB,CACjB,MAAO,IAAI,GAAE,MAAN,CAAa,OAAO,CAAP,CAAb,CAAwB,OAAO,CAAP,CAAxB,CAAP,CACH,CAFD,IAEO,CACH,MAAO,IAAI,GAAE,MAAN,CAAa,OAAO,GAApB,CAAyB,OAAO,GAAhC,CAAP,CACH,CACJ,CAED,QAAS,8BAAT,CAAuC,KAAvC,CAA8C,CAC1C,MAAO,OAAM,GAAN,CAAU,SAAU,OAAV,CAAmB,CAChC,MAAO,0BAAyB,OAAzB,CAAP,CACH,CAFM,CAAP,CAGH,CAED,QAAS,YAAT,CAAqB,IAArB,CAA2B,QAA3B,CAAqC,CACjC,GAAI,SAAU,EAAd,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,iBAAiB,MAArC,CAA6C,GAA7C,CAAkD,CAC9C,GAAI,YAAa,iBAAiB,CAAjB,CAAjB,CAEA,GAAI,UAAU,KAAK,UAAL,CAAV,CAAJ,CAAiC,CAC7B,QAAQ,UAAR,EAAsB,KAAK,UAAL,CAAtB,CACH,CAFD,IAEO,IAAI,UAAU,SAAS,IAAT,CAAc,UAAd,CAAV,CAAJ,CAA0C,CAC7C,QAAQ,UAAR,EAAsB,SAAS,IAAT,CAAc,UAAd,CAAtB,CACH,CACJ,CAED,MAAO,QAAP,CACH,CAED,GAAI,oBAAqB,QAAS,mBAAT,CAA4B,IAA5B,CAAkC,IAAlC,CAAwC,CAC7D,GAAI,cAAe,EAAnB,CACA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,iBAAiB,MAArC,CAA6C,GAA7C,CAAkD,CAC9C,GAAI,YAAa,iBAAiB,CAAjB,CAAjB,CACA,GAAI,UAAU,KAAK,UAAL,CAAV,CAAJ,CAAiC,CAC7B,aAAa,UAAb,EAA2B,KAAK,UAAL,CAA3B,CACH,CACJ,CACD,KAAK,QAAL,CAAc,IAAd,EACH,CATD,CAWA,GAAI,kBAAmB,QAAS,iBAAT,CAA0B,OAA1B,CAAmC,CACtD,GAAI,CAAC,QAAQ,OAAR,CAAL,CAAuB,CACnB,MAAO,MAAP,CACH,CACD,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,QAAQ,MAA5B,CAAoC,GAApC,CAAyC,CACrC,GAAI,OAAQ,QAAQ,CAAR,CAAZ,CACA,GAAI,CAAC,aAAa,KAAb,CAAL,CAA0B,CACtB,MAAO,MAAP,CACH,CACJ,CACD,MAAO,KAAP,CACH,CAXD,CAaA,GAAI,WAAY,CACZ,SAAU,CACN,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,SAAU,SAAS,OAAvB,CACA,MAAO,kBAAiB,OAAjB,CAAP,CACH,CAJK,CAKN,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,QAAN,CAAe,EAAf,CAAmB,OAAnB,CAAP,CACH,CAPK,CAQN,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,UAAL,CAAgB,yBAAyB,KAAK,OAA9B,CAAhB,EACA,mBAAmB,IAAnB,CAAyB,IAAzB,EACA,OACH,CAZK,CADE,CAeZ,cAAe,CACX,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,SAAU,SAAS,OAAvB,CACA,GAAI,CAAC,QAAQ,OAAR,CAAL,CAAuB,CACnB,MAAO,MAAP,CACH,CAED,IAAK,GAAI,EAAT,GAAc,QAAd,CAAuB,CACnB,GAAI,UAAW,QAAQ,CAAR,CAAf,CACA,GAAI,CAAC,iBAAiB,QAAjB,CAAL,CAAiC,CAC7B,MAAO,MAAP,CACH,CACJ,CAED,MAAO,KAAP,CACH,CAfU,CAgBX,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,aAAN,CAAoB,CAAC,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAD,CAAS,CAAC,CAAD,CAAI,CAAJ,CAAT,CAAD,CAApB,CAAwC,OAAxC,CAAP,CACH,CAlBU,CAmBX,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,UAAL,CAAgB,8BAA8B,KAAK,OAAnC,CAAhB,EACA,mBAAmB,IAAnB,CAAyB,IAAzB,EACA,OACH,CAvBU,CAfH,CAwCZ,QAAS,CACL,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,SAAU,SAAS,OAAvB,CACA,MAAO,kBAAiB,OAAjB,CAAP,CACH,CAJI,CAKL,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,OAAN,CAAc,EAAd,CAAkB,OAAlB,CAAP,CACH,CAPI,CAQL,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,UAAL,CAAgB,yBAAyB,KAAK,OAA9B,CAAhB,EACA,mBAAmB,IAAnB,CAAyB,IAAzB,EACA,OACH,CAZI,CAxCG,CAsDZ,aAAc,CACV,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,SAAU,SAAS,OAAvB,CAEA,GAAI,CAAC,QAAQ,OAAR,CAAL,CAAuB,CACnB,MAAO,MAAP,CACH,CAED,IAAK,GAAI,EAAT,GAAc,QAAd,CAAuB,CACnB,GAAI,UAAW,QAAQ,CAAR,CAAf,CACA,GAAI,CAAC,iBAAiB,QAAjB,CAAL,CAAiC,CAC7B,MAAO,MAAP,CACH,CACJ,CAED,MAAO,KAAP,CACH,CAhBS,CAiBV,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,YAAN,CAAmB,CAAC,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAD,CAAS,CAAC,CAAD,CAAI,CAAJ,CAAT,CAAiB,CAAC,CAAD,CAAI,CAAJ,CAAjB,CAAD,CAAnB,CAA+C,OAA/C,CAAP,CACH,CAnBS,CAoBV,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,UAAL,CAAgB,8BAA8B,KAAK,OAAnC,CAAhB,EACA,mBAAmB,IAAnB,CAAyB,IAAzB,EACA,OACH,CAxBS,CAtDF,CAgFZ,UAAW,CACP,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,SAAU,SAAS,OAAvB,CAEA,GAAI,CAAC,QAAQ,OAAR,CAAD,EAAqB,QAAQ,MAAR,GAAmB,CAA5C,CAA+C,CAC3C,MAAO,MAAP,CACH,CAED,IAAK,GAAI,EAAT,GAAc,QAAd,CAAuB,CACnB,GAAI,OAAQ,QAAQ,CAAR,CAAZ,CACA,GAAI,CAAC,aAAa,KAAb,CAAL,CAA0B,CACtB,MAAO,MAAP,CACH,CACJ,CAED,MAAO,KAAP,CACH,CAhBM,CAiBP,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,SAAN,CAAgB,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAD,CAAS,CAAC,CAAD,CAAI,CAAJ,CAAT,CAAhB,CAAkC,OAAlC,CAAP,CACH,CAnBM,CAoBP,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,SAAL,CAAe,GAAI,GAAE,YAAN,CAAmB,yBAAyB,KAAK,OAA9B,CAAnB,CAAf,EACA,mBAAmB,IAAnB,CAAyB,IAAzB,EACH,CAvBM,CAhFC,CAyGZ,OAAQ,CACJ,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,OAAQ,SAAS,OAArB,CACA,MAAO,cAAa,KAAb,GAAuB,SAAS,SAAS,MAAlB,CAA9B,CACH,CAJG,CAKJ,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,MAAN,CAAa,CAAC,CAAD,CAAI,CAAJ,CAAb,CAAqB,CAArB,CAAwB,OAAxB,CAAP,CACH,CAPG,CAQJ,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,SAAL,CAAe,wBAAwB,KAAK,OAA7B,CAAf,EACA,GAAI,UAAU,KAAK,MAAf,CAAJ,CAA4B,CACxB,KAAK,SAAL,CAAe,KAAK,MAApB,EACH,CACD,mBAAmB,IAAnB,CAAyB,IAAzB,EACH,CAdG,CAzGI,CAyHZ,aAAc,CACV,QAAS,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CAChC,GAAI,OAAQ,SAAS,OAArB,CACA,MAAO,cAAa,KAAb,GAAuB,SAAS,SAAS,MAAlB,CAA9B,CACH,CAJS,CAKV,WAAY,QAAS,WAAT,CAAoB,OAApB,CAA6B,CACrC,MAAO,IAAI,GAAE,YAAN,CAAmB,CAAC,CAAD,CAAI,CAAJ,CAAnB,CAA2B,OAA3B,CAAP,CACH,CAPS,CAQV,QAAS,QAAS,QAAT,CAAiB,IAAjB,CAAuB,IAAvB,CAA6B,CAClC,KAAK,SAAL,CAAe,wBAAwB,KAAK,OAA7B,CAAf,EACA,GAAI,UAAU,KAAK,MAAf,CAAJ,CAA4B,CACxB,KAAK,SAAL,CAAe,KAAK,MAApB,EACH,CACD,mBAAmB,IAAnB,CAAyB,IAAzB,EACH,CAdS,CAzHF,CAAhB,CA2IA,GAAI,cAAe,QAAS,aAAT,CAAsB,IAAtB,CAA4B,CAC3C,GAAI,UAAW,EAAf,CACA,GAAI,KAAK,OAAT,CAAkB,CACd,SAAS,OAAT,CAAmB,KAAK,OAAxB,CACH,CAED,GAAI,KAAK,MAAT,CAAiB,CACb,SAAS,MAAT,CAAkB,KAAK,MAAvB,CACH,CAED,MAAO,SAAP,CACH,CAXD,CAaA,MAAO,CACH,eAAgB,QAAS,eAAT,CAAwB,WAAxB,CAAqC,QAArC,CAA+C,IAA/C,CAAqD,CACjE,GAAI,CAAC,UAAU,QAAV,CAAL,CAA0B,CACtB,SAAW,UAAX,CACH,CACD,UAAU,QAAV,EAAoB,OAApB,CAA4B,WAA5B,CAAyC,IAAzC,EACH,CANE,CAOH,WAAY,QAAS,WAAT,CAAoB,IAApB,CAA0B,IAA1B,CAAgC,QAAhC,CAA0C,CAClD,GAAI,CAAC,UAAU,KAAK,IAAf,CAAL,CAA2B,CACvB,KAAK,IAAL,CAAY,UAAZ,CACH,CACD,GAAI,SAAU,YAAY,IAAZ,CAAkB,QAAlB,CAAd,CACA,GAAI,UAAW,aAAa,IAAb,CAAf,CAEA,GAAI,CAAC,UAAU,KAAK,IAAf,EAAqB,OAArB,CAA6B,QAA7B,CAAL,CAA6C,CACzC,KAAK,KAAL,CAAW,oDAAsD,KAAK,IAA3D,CAAkE,OAA7E,EACA,OACH,CAED,MAAO,WAAU,KAAK,IAAf,EAAqB,UAArB,CAAgC,OAAhC,CAAP,CACH,CApBE,CAAP,CAsBH,CAxPD,EA0PA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,qBAArC,CAA4D,UAAY,CAEpE,GAAI,QAAS,QAAS,OAAT,CAAgB,KAAhB,CAAuB,iBAAvB,CAA0C,eAA1C,CAA2D,YAA3D,CAAyE,MAAzE,CAAiF,CAC1F,GAAI,SAAU,MAAM,iBAAN,EAAyB,eAAzB,CAA0C,SAAU,QAAV,CAAoB,QAApB,CAA8B,CAClF;AACA,OAAO,QAAP,CAAiB,QAAjB,CAA2B,OAA3B,EACA,GAAI,aAAa,IAAb,GAAsB,IAA1B,CAAgC,UACnC,CAJa,CAIX,aAAa,IAAb,GAAsB,WAJX,CAAd,CAMA,MAAO,QAAP,CACH,CARD,CAUA;;;;;;MAOA,GAAI,aAAc,QAAS,YAAT,CAAqB,KAArB,CAA4B,eAA5B,CAA6C,YAA7C,CAA2D,MAA3D,CAAmE,CACjF,GAAI,YAAJ,CAEA,GAAI,aAAa,IAAb,GAAsB,iBAA1B,CAA6C,CACzC,YAAc,kBAAd,CACH,CAFD,IAEO,CACH,YAAc,QAAd,CACH,CAED,MAAO,QAAO,KAAP,CAAc,WAAd,CAA2B,eAA3B,CAA4C,YAA5C,CAA0D,MAA1D,CAAP,CACH,CAVD,CAYA,MAAO,CACH,WAAY,WADT,CAAP,CAGH,CAlCD,EAoCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,eAArC,CAAsD,SAAU,eAAV,CAA2B,CAC/E,MAAO,iBAAgB,KAAhB,EAAP,CACD,CAFD,EAIA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,kBAArC,CAAyD,SAAU,EAAV,CAAc,KAAd,CAAqB,cAArB,CAAqC,kBAArC,CAAyD,CAC9G,GAAI,WAAY,eAAe,SAA/B,CAEA,MAAO,CACH,MAAO,QAAS,MAAT,CAAe,OAAf,CAAwB,KAAxB,CAA+B,CAClC,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,KAA/B,CAAf,CACA,GAAI,KAAM,SAAS,SAAT,CAAmB,MAA7B,CACA,GAAI,IAAK,GAAG,KAAH,EAAT,CAEA,MAAM,GAAN,CAAU,GAAV,CAAe,CAAE,OAAQ,CAAE,OAAQ,MAAV,CAAkB,MAAO,CAAzB,CAA4B,EAAG,OAA/B,CAAV,CAAf,EAAqE,OAArE,CAA6E,SAAU,IAAV,CAAgB,CACzF,GAAI,KAAK,MAAL,CAAc,CAAd,EAAmB,UAAU,KAAK,CAAL,EAAQ,WAAlB,CAAvB,CAAuD,CACnD,GAAG,OAAH,CAAW,KAAK,CAAL,CAAX,EACH,CAFD,IAEO,CACH,GAAG,MAAH,CAAU,6BAAV,EACH,CACJ,CAND,EAQA,MAAO,IAAG,OAAV,CACH,CAfE,CAAP,CAiBH,CApBD,EAsBA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,QAAvC,CAAiD,SAAU,aAAV,CAAyB,QAAzB,CAAmC,KAAnC,CAA0C,cAA1C,CAA0D,gBAA1D,CAA4E,oBAA5E,CAAkG,CAC/I,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,CAAC,SAAD,CAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,WAAY,eAAe,SAA/B,CACA,GAAI,qBAAsB,qBAAqB,mBAA/C,CACA,GAAI,cAAe,WAAW,CAAX,EAAc,eAAd,EAAnB,CACA,GAAI,eAAgB,WAAW,CAAX,CAApB,CACA,GAAI,aAAc,eAAe,WAAf,CAA6B,YAA/C,CAEA,GAAI,aAAc,QAAS,YAAT,CAAqB,MAArB,CAA6B,CAC3C,MAAO,QAAO,UAAP,CAAkB,GAAlB,GAA0B,CAA1B,EAA+B,OAAO,UAAP,CAAkB,GAAlB,GAA0B,CAAzD,EAA8D,OAAO,UAAP,CAAkB,GAAlB,GAA0B,CAAxF,EAA6F,OAAO,UAAP,CAAkB,GAAlB,GAA0B,CAA9H,CACH,CAFD,CAIA,cAAc,MAAd,GAAuB,IAAvB,CAA4B,SAAU,GAAV,CAAe,CACvC,aAAa,GAAb,CAAiB,eAAjB,CAAkC,SAAU,KAAV,CAAiB,CAC/C,GAAI,OAAQ,MAAM,YAAlB,CACA,GAAI,QAAS,IAAI,SAAJ,EAAb,CAEA,GAAI,YAAY,MAAZ,GAAuB,MAAM,sBAAjC,CAAyD,CACrD,OACH,CACD,MAAM,wBAAN,CAAiC,IAAjC,CACA,GAAI,gBAAiB,CACjB,UAAW,CACP,IAAK,OAAO,UAAP,CAAkB,GADhB,CAEP,IAAK,OAAO,UAAP,CAAkB,GAFhB,CADM,CAKjB,UAAW,CACP,IAAK,OAAO,UAAP,CAAkB,GADhB,CAEP,IAAK,OAAO,UAAP,CAAkB,GAFhB,CALM,CASjB,QAAS,OAAO,OATC,CAArB,CAWA,GAAI,CAAC,QAAQ,MAAR,CAAe,MAAM,MAArB,CAA6B,cAA7B,CAAL,CAAmD,CAC/C,MAAM,MAAN,CAAe,cAAf,CACH,CACD,SAAS,UAAY,CACjB,MAAM,wBAAN,CAAiC,KAAjC,CACH,CAFD,EAGH,CAzBD,EA2BA,GAAI,mBAAJ,CACA,aAAa,MAAb,CAAoB,QAApB,CAA8B,SAAU,MAAV,CAAkB,CAC5C,GAAI,MAAM,wBAAV,CAAoC,OACpC,GAAI,UAAU,OAAO,OAAjB,GAA6B,OAAO,OAAP,GAAmB,kBAApD,CAAwE,CACpE,MAAM,sBAAN,CAA+B,IAA/B,CACA,iBAAiB,KAAjB,CAAuB,OAAO,OAA9B,CAAuC,MAAM,EAA7C,EAAiD,IAAjD,CAAsD,SAAU,IAAV,CAAgB,CAClE,GAAI,GAAI,KAAK,WAAb,CACA,GAAI,WAAY,CAAC,CAAC,EAAE,CAAF,CAAD,CAAO,EAAE,CAAF,CAAP,CAAD,CAAe,CAAC,EAAE,CAAF,CAAD,CAAO,EAAE,CAAF,CAAP,CAAf,CAAhB,CACA,IAAI,SAAJ,CAAc,SAAd,EACH,CAJD,CAIG,SAAU,MAAV,CAAkB,CACjB,KAAK,KAAL,CAAW,YAAc,GAAd,CAAoB,MAApB,CAA6B,GAAxC,EACH,CAND,EAOA,mBAAqB,OAAO,OAA5B,CACA,SAAS,UAAY,CACjB,MAAM,sBAAN,CAA+B,KAA/B,CACH,CAFD,EAGA,OACH,CAED,GAAI,eAAgB,oBAAoB,MAApB,CAApB,CACA,GAAI,eAAiB,CAAC,IAAI,SAAJ,GAAgB,MAAhB,CAAuB,aAAvB,CAAtB,CAA6D,CACzD,MAAM,sBAAN,CAA+B,IAA/B,CACA,IAAI,SAAJ,CAAc,aAAd,CAA6B,OAAO,OAApC,EACA,SAAS,UAAY,CACjB,MAAM,sBAAN,CAA+B,KAA/B,CACH,CAFD,EAGH,CACJ,CA1BD,CA0BG,IA1BH,EA2BH,CAxDD,EAyDH,CA1EE,CAAP,CA4EH,CA9ED,EAgFA,aAEA,GAAI,sBAAuB,CAAC,QAAD,CAAW,UAAX,CAA3B,CACI,iBAAmB,EADvB,CAGA,qBAAqB,OAArB,CAA6B,SAAU,aAAV,CAAyB,CAClD,iBAAiB,aAAjB,EAAkC,CAAC,eAAD,CAAkB,IAAlB,CAAwB,WAAxB,CAAqC,UAArC,CAAiD,oBAAjD,CAAuE,gBAAvE,CAAyF,sBAAzF,CAAiH,kBAAjH,CAAqI,SAAU,aAAV,CAAyB,EAAzB,CAA6B,SAA7B,CAAwC,QAAxC,CAAkD,kBAAlD,CAAsE,cAAtE,CAAsF,oBAAtF,CAA4G,gBAA5G,CAA8H,CAEjS,GAAI,WAAY,eAAe,SAA/B,CACI,SAAW,eAAe,QAD9B,CAEI,kBAAoB,eAAe,iBAFvC,CAGI,UAAY,eAAe,SAH/B,CAII,cAAgB,eAAe,aAJnC,CAKI,cAAgB,qBAAqB,aALzC,CAMI,mBAAqB,eAAe,kBANxC,CAOI,YAAc,eAAe,WAPjC,CAQI,KAAO,aARX,CAUA,GAAI,+BAAgC,QAAS,8BAAT,CAAuC,MAAvC,CAA+C,MAA/C,CAAuD,CACvF,MAAO,WAAU,MAAV,GAAqB,cAAc,MAAd,CAArB,EAA8C,mBAAmB,MAAnB,CAArD,CACH,CAFD,CAIA,GAAI,eAAJ,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAKH,WAAY,QAAS,WAAT,EAAsB,CAC9B,eAAiB,GAAG,KAAH,EAAjB,CACA,KAAK,SAAL,CAAiB,UAAY,CACzB,MAAO,gBAAe,OAAtB,CACH,CAFD,CAGH,CAVE,CAWH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,cAAe,WAAW,eAAX,EAAnB,CACI,YAAc,aAAa,aAAb,CADlB,CAGA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,MAAM,EAArC,CAAf,CAEA,GAAI,MAAM,aAAN,EAAqB,MAArB,CAA4B,GAA5B,IAAqC,CAAC,CAA1C,CAA6C,CACzC,KAAK,KAAL,CAAW,YAAc,4DAAd,CAA6E,MAAM,aAAN,CAA7E,CAAoG,IAA/G,EACA,IAAI,OAAJ,CAAY,CAAC,SAAS,MAAT,CAAgB,GAAjB,CAAsB,SAAS,MAAT,CAAgB,GAAtC,CAAZ,CAAwD,SAAS,MAAT,CAAgB,IAAxE,EACA,OACH,CAJD,IAIO,IAAI,8BAA8B,aAAa,MAA3C,CAAmD,WAAnD,CAAJ,CAAqE,CACxE,IAAI,SAAJ,CAAc,qBAAqB,mBAArB,CAAyC,aAAa,MAAtD,CAAd,CAA6E,aAAa,MAAb,CAAoB,OAAjG,EACA,YAAc,IAAI,SAAJ,EAAd,CACA,UAAU,YAAV,CAAwB,SAAU,KAAV,CAAiB,CACrC,QAAQ,MAAR,CAAe,MAAM,aAAN,CAAf,CAAqC,CACjC,IAAK,IAAI,SAAJ,GAAgB,GADY,CAEjC,IAAK,IAAI,SAAJ,GAAgB,GAFY,CAGjC,KAAM,IAAI,OAAJ,EAH2B,CAIjC,aAAc,KAJmB,CAArC,EAMH,CAPD,EAQA,UAAU,YAAV,CAAwB,SAAU,KAAV,CAAiB,CACrC,GAAI,WAAY,IAAI,SAAJ,EAAhB,CACA,MAAM,MAAN,CAAe,CACX,UAAW,CACP,IAAK,UAAU,UAAV,CAAqB,GADnB,CAEP,IAAK,UAAU,UAAV,CAAqB,GAFnB,CADA,CAKX,UAAW,CACP,IAAK,UAAU,UAAV,CAAqB,GADnB,CAEP,IAAK,UAAU,UAAV,CAAqB,GAFnB,CALA,CAAf,CAUH,CAZD,EAaH,CAxBM,IAwBA,IAAI,CAAC,UAAU,WAAV,CAAL,CAA6B,CAChC,KAAK,KAAL,CAAW,YAAc,yDAAzB,EACA,IAAI,OAAJ,CAAY,CAAC,SAAS,MAAT,CAAgB,GAAjB,CAAsB,SAAS,MAAT,CAAgB,GAAtC,CAAZ,CAAwD,SAAS,MAAT,CAAgB,IAAxE,EACA,OACH,CAJM,IAIA,IAAI,EAAE,UAAU,YAAY,GAAtB,GAA8B,UAAU,YAAY,GAAtB,CAAhC,GAA+D,CAAC,UAAU,YAAY,YAAtB,CAApE,CAAyG,CAC5G,QAAQ,IAAR,CAAa,SAAS,MAAtB,CAA8B,WAA9B,EACH,CAED,GAAI,cAAJ,CAAmB,QAAnB,CACA,GAAI,MAAM,aAAN,GAAwB,KAA5B,CAAmC,CAC/B,GAAI,sBAAuB,QAAS,qBAAT,EAAgC,CACvD,GAAI,QAAS,UAAU,MAAV,EAAb,CACA,GAAI,YAAJ,CACA,GAAI,WAAY,MAAM,YAAN,CAAqB,MAAM,YAA3B,CAA0C,GAA1D,CACA,GAAI,UAAU,OAAO,SAAP,CAAV,CAAJ,CAAkC,CAC9B,GAAI,QAAS,OAAO,SAAP,EAAkB,KAAlB,CAAwB,GAAxB,CAAb,CACA,GAAI,OAAO,MAAP,GAAkB,CAAtB,CAAyB,CACrB,YAAc,CACV,IAAK,WAAW,OAAO,CAAP,CAAX,CADK,CAEV,IAAK,WAAW,OAAO,CAAP,CAAX,CAFK,CAGV,KAAM,SAAS,OAAO,CAAP,CAAT,CAAoB,EAApB,CAHI,CAAd,CAKH,CACJ,CACD,MAAO,YAAP,CACH,CAfD,CAgBA,cAAgB,sBAAhB,CAEA,aAAa,GAAb,CAAiB,wBAAjB,CAA2C,SAAU,KAAV,CAAiB,CACxD,GAAI,OAAQ,MAAM,YAAlB,CACA;AACA,GAAI,WAAY,sBAAhB,CACA,GAAI,UAAU,SAAV,GAAwB,CAAC,kBAAkB,SAAlB,CAA6B,GAA7B,CAA7B,CAAgE,CAC5D;AACA,QAAQ,MAAR,CAAe,MAAM,aAAN,CAAf,CAAqC,CACjC,IAAK,UAAU,GADkB,CAEjC,IAAK,UAAU,GAFkB,CAGjC,KAAM,UAAU,IAHiB,CAArC,EAKH,CACJ,CAZD,EAaH,CAED,aAAa,MAAb,CAAoB,aAApB,CAAmC,SAAU,MAAV,CAAkB,CACjD,GAAI,aAAa,wBAAjB,CAA2C,OAC3C;AACA;AACA,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC1B,QAAQ,IAAR,CAAa,aAAb,CAA4B,MAA5B,EACA,cAAgB,SAAhB,CACH,CAED,GAAI,CAAC,cAAc,MAAd,CAAD,EAA0B,OAAO,YAAP,GAAwB,IAAtD,CAA4D,CACxD,KAAK,IAAL,CAAU,YAAc,mBAAxB,EACA;AACA,OACH,CAED,GAAI,OAAO,YAAP,GAAwB,IAA5B,CAAkC,CAC9B,GAAI,CAAC,SAAS,OAAO,IAAhB,CAAL,CAA4B,CACxB,IAAI,OAAJ,CAAY,CAAC,SAAS,MAAT,CAAgB,GAAjB,CAAsB,SAAS,MAAT,CAAgB,GAAtC,CAAZ,CAAwD,SAAS,MAAT,CAAgB,IAAxE,EACH,CACD,GAAI,SAAS,OAAO,IAAhB,GAAyB,OAAO,IAAP,CAAc,SAAS,MAAT,CAAgB,IAA3D,CAAiE,CAC7D,IAAI,MAAJ,CAAW,CACP,QAAS,IADF,CAEP,QAAS,OAAO,IAFT,CAAX,EAIH,CALD,IAKO,IAAI,UAAU,SAAS,OAAnB,CAAJ,CAAiC,CACpC,IAAI,MAAJ,CAAW,CACP,QAAS,IADF,CAEP,QAAS,SAAS,OAFX,CAAX,EAIH,CALM,IAKA,CACH,IAAI,MAAJ,CAAW,CACP,QAAS,IADF,CAAX,EAGH,CACD,OACH,CAED,GAAI,UAAY,kBAAkB,MAAlB,CAA0B,GAA1B,CAAhB,CAAgD,CAC5C;AACA,OACH,CAED;AACA,aAAa,sBAAb,CAAsC,IAAtC,CACA,IAAI,OAAJ,CAAY,CAAC,OAAO,GAAR,CAAa,OAAO,GAApB,CAAZ,CAAsC,OAAO,IAA7C,EACA,iBAAiB,2BAAjB,CAA6C,YAA7C,CAA2D,GAA3D,EACA,SAAS,UAAY,CACjB,aAAa,sBAAb,CAAsC,KAAtC,CACA;AACH,CAHD,EAIH,CAlDD,CAkDG,IAlDH,EAoDA,IAAI,SAAJ,CAAc,UAAY,CACtB,SAAW,IAAX,CACH,CAFD,EAIA,IAAI,EAAJ,CAAO,SAAP,CAAkB,UAAY,WAAW,CACrC;AACA,eAAe,OAAf,GACA,iBAAiB,0BAAjB,CAA4C,YAA5C,CAA0D,GAA1D,CAA+D,KAA/D,CAAsE,UAAU,MAAV,EAAtE,EACA;AACA,GAAI,kBAAkB,WAAlB,CAA+B,GAA/B,GAAuC,aAAa,sBAAxD,CAAgF,CAC5E;AACA,OACH,CACD,aAAa,wBAAb,CAAwC,IAAxC,CACA,UAAU,YAAV,CAAwB,SAAU,KAAV,CAAiB,CACrC,GAAI,CAAC,aAAa,sBAAlB,CAA0C,CACtC;AACA,QAAQ,MAAR,CAAe,MAAM,aAAN,CAAf,CAAqC,CACjC,IAAK,IAAI,SAAJ,GAAgB,GADY,CAEjC,IAAK,IAAI,SAAJ,GAAgB,GAFY,CAGjC,KAAM,IAAI,OAAJ,EAH2B,CAIjC,aAAc,KAJmB,CAArC,EAMH,CACD,iBAAiB,2BAAjB,CAA6C,YAA7C,CAA2D,GAA3D,EACA,SAAS,UAAY,CACjB,aAAa,wBAAb,CAAwC,KAAxC,CACH,CAFD,EAGH,CAdD,EAeH,CAzBD,EA2BA,GAAI,YAAY,YAAZ,GAA6B,IAAjC,CAAuC,CACnC,IAAI,EAAJ,CAAO,eAAP,CAAwB,UAAY,CAChC,KAAK,IAAL,CAAU,YAAc,oDAAxB,EACA,GAAI,cAAc,WAAd,CAAJ,CAAgC,CAC5B,IAAI,OAAJ,CAAY,CAAC,YAAY,GAAb,CAAkB,YAAY,GAA9B,CAAZ,CAAgD,YAAY,IAA5D,EACA,iBAAiB,2BAAjB,CAA6C,YAA7C,CAA2D,GAA3D,EACH,CAHD,IAGO,CACH,IAAI,OAAJ,CAAY,CAAC,SAAS,MAAT,CAAgB,GAAjB,CAAsB,SAAS,MAAT,CAAgB,GAAtC,CAAZ,CAAwD,SAAS,MAAT,CAAgB,IAAxE,EACA,iBAAiB,2BAAjB,CAA6C,YAA7C,CAA2D,GAA3D,EACH,CACJ,CATD,EAUH,CACJ,CAzKD,EA0KH,CAzLE,CAAP,CA2LH,CA5MiC,CAAlC,CA6MH,CA9MD,EAgNA,qBAAqB,OAArB,CAA6B,SAAU,OAAV,CAAmB,CAC5C,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,OAAvC,CAAgD,iBAAiB,OAAjB,CAAhD,EACH,CAFD,EAIA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,UAAvC,CAAmD,SAAU,aAAV,CAAyB,cAAzB,CAAyC,qBAAzC,CAAgE,CAC/G,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,WAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,CAAC,UAAL,CAAiB,CACb,OACH,CAED,GAAI,eAAgB,sBAAsB,aAA1C,CACA,GAAI,oBAAqB,sBAAsB,kBAA/C,CACA,GAAI,cAAe,WAAW,eAAX,EAAnB,CACA,GAAI,WAAY,eAAe,SAA/B,CACA,GAAI,SAAU,eAAe,OAA7B,CACA,GAAI,iBAAkB,EAAtB,CACA,GAAI,aAAc,eAAe,WAAf,CAA6B,cAA/C,CAEA,MAAM,GAAN,CAAU,UAAV,CAAsB,UAAY,CAC9B,sBAAsB,uBAAtB,CAA8C,MAAM,KAApD,EACH,CAFD,EAIA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CAEpC,aAAa,gBAAb,CAA8B,UAA9B,CAA0C,SAAU,WAAV,CAAuB,CAE7D;AACA,IAAK,GAAI,KAAT,GAAiB,gBAAjB,CAAkC,CAC9B,GAAI,CAAC,UAAU,YAAY,IAAZ,CAAV,CAAL,CAAmC,CAC/B,GAAI,IAAI,UAAJ,CAAe,gBAAgB,IAAhB,CAAf,CAAJ,CAA2C,CACvC,IAAI,aAAJ,CAAkB,gBAAgB,IAAhB,CAAlB,EACH,CACD,MAAO,iBAAgB,IAAhB,CAAP,CACH,CACJ,CAED,IAAK,GAAI,QAAT,GAAoB,YAApB,CAAiC,CAC7B,GAAI,QAAJ,CAEA,GAAI,aAAc,UAAU,YAAY,OAAZ,EAAqB,IAA/B,EAAuC,YAAY,OAAZ,EAAqB,IAA5D,CAAmE,OAArF,CAEA,GAAI,CAAC,mBAAmB,WAAnB,CAAL,CAAsC,CAClC,KAAK,KAAL,CAAW,YAAc,yBAAd,CAA0C,WAA1C,CAAwD,GAAnE,EACA,OACH,CAED,GAAI,cAAgB,QAApB,CAA8B,CAC1B,QAAU,cAAc,WAAd,CAA2B,YAAY,OAAZ,CAA3B,CAAV,CACA,IAAI,UAAJ,CAAe,OAAf,EACA,gBAAgB,OAAhB,EAA2B,OAA3B,CACH,CAJD,IAIO,CACH,GAAI,oBAAqB,YAAY,OAAZ,CAAzB,CACA,GAAI,QAAQ,kBAAR,CAAJ,CAAiC,CAC7B,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,mBAAmB,MAAvC,CAA+C,GAA/C,CAAoD,CAChD,GAAI,eAAgB,mBAAmB,CAAnB,CAApB,CACA,IAAI,UAAJ,CAAe,aAAf,EACA,gBAAgB,OAAhB,EAA2B,CAAC,UAAU,gBAAgB,OAAhB,CAAV,CAAD,CAAuC,CAAC,aAAD,CAAvC,CAAyD,gBAAgB,OAAhB,EAAyB,MAAzB,CAAgC,CAAC,aAAD,CAAhC,CAApF,CACH,CACJ,CAND,IAMO,CACH,IAAI,UAAJ,CAAe,kBAAf,EACA,gBAAgB,OAAhB,EAA2B,kBAA3B,CACH,CACJ,CACJ,CACJ,CAxCD,EAyCH,CA3CD,EA4CH,CAnEE,CAAP,CAqEH,CAvED,EAyEA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,aAAvC,CAAsD,SAAU,aAAV,CAAyB,cAAzB,CAAyC,CAC9F,GAAI,MAAO,aAAX,CACA,MAAO,CACN,SAAU,GADJ,CAEN,MAAO,KAFD,CAGN,QAAS,KAHH,CAIN,QAAS,SAJH,CAMN,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACtD,GAAI,cAAe,WAAW,eAAX,EAAnB,CACI,wBAA0B,eAAe,uBAD7C,CAEI,UAAY,eAAe,SAF/B,CAGI,mBAAqB,EAHzB,CAKA,8EACA,QAAS,iBAAT,CAA0B,OAA1B,CAAmC,CAClC,GAAI,UAAU,OAAV,GAAsB,UAAU,QAAQ,WAAlB,CAA1B,CAA0D,CACzD,GAAI,CAAC,wBAAwB,QAAxB,EAAL,CAAyC,CACxC,KAAK,KAAL,CAAW,mEAAX,EACA,CACD,CAED,MAAO,GAAE,iBAAF,CAAoB,QAAQ,WAA5B,CAAP,CACA,CAED,gGACA,QAAS,qBAAT,CAA8B,UAA9B,CAA0C,OAA1C,CAAmD,CAClD,GAAI,UAAU,UAAV,GAAyB,UAAU,OAAV,CAA7B,CAAiD,CAChD,GAAI,UAAU,QAAQ,WAAlB,GAAkC,UAAU,QAAQ,QAAlB,CAAtC,CAAmE,CAClE,WAAW,QAAX,CAAoB,QAAQ,WAA5B,EACA,WAAW,WAAX,CAAuB,QAAQ,QAA/B,EACA,MAAO,WAAP,CACA,CACD,CACD,CAED,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACvC,aAAa,MAAb,CAAoB,aAApB,CAAmC,SAAU,cAAV,CAA0B,CAC5D,IAAK,GAAI,KAAT,GAAiB,mBAAjB,CAAqC,CACpC,GAAI,CAAC,UAAU,eAAe,IAAf,CAAV,CAAD,EAAoC,CAAC,QAAQ,MAAR,CAAe,eAAe,IAAf,CAAf,CAAqC,kBAArC,CAAzC,CAAmG,CAClG,IAAI,WAAJ,CAAgB,mBAAmB,IAAnB,CAAhB,EACA,MAAO,oBAAmB,IAAnB,CAAP,CACA,CACD,CAED,IAAK,GAAI,QAAT,GAAoB,eAApB,CAAoC,CACnC,GAAI,gBAAiB,eAAe,OAAf,CAArB,CACI,cAAgB,iBAAiB,cAAjB,CADpB,CAGA,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC7B,mBAAmB,OAAnB,EAA8B,aAA9B,CACA,IAAI,QAAJ,CAAa,aAAb,EACA,qBAAqB,aAArB,CAAoC,cAApC,EACA,CACD,CACD,CAlBD,CAkBG,IAlBH,EAmBA,CApBD,EAqBA,CAvDK,CAAP,CAyDA,CA3DD,EA6DA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,gBAAvC,CAAyD,SAAU,aAAV,CAAyB,UAAzB,CAAqC,cAArC,CAAqD,gBAArD,CAAuE,gBAAvE,CAAyF,CAC9I,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,UAAW,eAAe,QAA9B,CACI,UAAY,eAAe,SAD/B,CAEI,aAAe,WAAW,eAAX,EAFnB,CAGI,eAAiB,aAAa,cAHlC,CAII,mBAAqB,iBAAiB,qBAAjB,EAJzB,CAKI,UAAY,iBAAiB,SALjC,CAOA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CAEpC,GAAI,WAAY,EAAhB,CACI,MAAQ,WADZ,CAGA;AACA,GAAI,CAAC,UAAU,eAAe,GAAzB,CAAL,CAAoC,CAChC;AACA,UAAY,kBAAZ,CACH,CAHD,IAGO,IAAI,CAAC,SAAS,eAAe,GAAxB,CAAL,CAAmC,CACtC;AACA,KAAK,IAAL,CAAU,+EAAV,EACH,CAHM,IAGA,CACH;AACA;AACA,GAAI,eAAe,GAAf,CAAmB,KAAnB,GAA6B,MAA7B,EAAuC,eAAe,GAAf,CAAmB,KAAnB,GAA6B,WAAxE,CAAqF,CACjF;AACA,KAAK,IAAL,CAAU,qFAAV,EACH,CAHD,IAGO,CACH,MAAQ,eAAe,GAAf,CAAmB,KAA3B,CACH,CAED,GAAI,EAAE,SAAS,eAAe,GAAf,CAAmB,MAA5B,GAAuC,eAAe,GAAf,CAAmB,MAAnB,CAA0B,MAA1B,EAAoC,CAA7E,CAAJ,CAAqF,CACjF,KAAK,IAAL,CAAU,sFAAV,EACH,CAFD,IAEO,CACH;AACA,iBAAiB,IAAjB,CAAsB,eAAe,GAAf,CAAmB,MAAzC,CAAiD,SAAU,SAAV,CAAqB,CAClE;AACA,GAAI,UAAU,OAAV,CAAkB,SAAlB,IAAiC,CAAC,CAAlC,EAAuC,mBAAmB,OAAnB,CAA2B,SAA3B,IAA0C,CAAC,CAAtF,CAAyF,CACrF,UAAU,IAAV,CAAe,SAAf,EACH,CACJ,CALD,EAMH,CACJ,CACD;AACA;AACA,UAAU,GAAV,CAAe,MAAM,EAArB,CAAyB,SAAzB,CAAoC,WAApC,CAAiD,YAAjD,CAA+D,KAA/D,EACH,CArCD,EAsCH,CApDE,CAAP,CAsDH,CAxDD,EA0DA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,SAAvC,CAAkD,SAAU,QAAV,CAAoB,aAApB,CAAmC,WAAnC,CAAgD,cAAhD,CAAgE,mBAAhE,CAAqF,+BAArF,CAAsH,gBAAtH,CAAwI,oBAAxI,CAA8J,CAC5M,GAAI,aAAc,oBAAoB,UAAtC,CACI,qBAAuB,eAAe,YAD1C,CAEI,yBAA2B,gCAAgC,MAF/D,CAGI,IAAM,cAHV,CAII,IAAM,gBAJV,CAKI,UAAY,CAAE,oBAAqB,KAAvB,CALhB,CAMA;AAEA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,WAAY,eAAe,SAA/B,CACI,aAAe,WAAW,eAAX,EADnB,CAEI,eAAiB,EAFrB,CAGI,mBAAqB,KAHzB,CAKA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,GAAI,aAAJ,CACA,GAAI,aAAa,YAAb,EAA6B,aAAa,YAAb,CAA0B,OAA3D,CAAoE,CAChE,aAAe,aAAa,YAAb,CAA0B,OAAzC,CACH,CAFD,IAEO,CACH,aAAe,oBAAf,CACH,CAED,GAAI,eAAgB,QAAS,cAAT,CAAuB,OAAvB,CAAgC,SAAhC,CAA2C,CAC3D,GAAI,cAAJ,CAEA,GAAI,QAAQ,UAAR,CAAmB,QAAQ,aAA3B,CAAJ,CAA+C,CAC3C,cAAgB,QAAQ,aAAxB,CACH,CAFD,IAEO,CACH,cAAgB,QAAS,cAAT,CAAuB,OAAvB,CAAgC,KAAhC,CAAuC,CACnD,GAAI,eAAe,WAAf,CAA2B,QAA3B,IAAyC,UAAU,QAAQ,UAAR,CAAmB,WAA7B,CAA7C,CAAwF,CACpF,MAAM,SAAN,CAAgB,QAAQ,UAAR,CAAmB,WAAnC,EACH,CAED,qBAAqB,UAArB,CAAgC,MAAM,EAAtC,CAA0C,KAA1C,CAAiD,IAAjD,CAAuD,OAAvD,CAAgE,YAAhE,CAA8E,SAA9E,CAAyF,CAAE,qBAAsB,QAAQ,oBAAhC,CACrF,MAAO,MAAM,EADwE,CAAzF,EAEH,CAPD,CAQH,CACD,MAAO,cAAP,CACH,CAhBD,CAkBA,GAAI,UAAW,IAAI,SAAJ,CAAc,MAAM,aAApB,GAAsC,IAAI,QAAJ,CAAa,MAAM,aAAnB,CAArD,CAEA,GAAI,QAAS,QAAS,OAAT,EAAkB,CAC3B,GAAI,CAAC,cAAL,CAAqB,OACrB,GAAI,SAAU,QAAS,QAAT,CAAiB,OAAjB,CAA0B,CACpC,GAAI,UAAU,OAAV,GAAsB,IAAI,QAAJ,CAAa,OAAb,CAA1B,CAAiD,CAC7C,IAAI,WAAJ,CAAgB,OAAhB,EACH,CACJ,CAJD,CAKA,GAAI,QAAJ,CAAc,CACV,IAAI,IAAJ,CAAS,cAAT,CAAyB,SAAU,OAAV,CAAmB,CACxC,QAAQ,OAAR,EACH,CAFD,EAGA,OACH,CACD,QAAQ,cAAR,EACH,CAdD,CAgBA,GAAI,aAAc,QAAS,YAAT,CAAqB,OAArB,CAA8B,SAA9B,CAAyC,CAEvD,GAAI,EAAE,UAAU,OAAV,GAAsB,UAAU,QAAQ,IAAlB,CAAxB,CAAJ,CAAsD,CAClD,OACH,CACD,GAAI,eAAgB,cAAc,OAAd,CAAuB,SAAvB,CAApB,CAEA,GAAI,CAAC,UAAU,QAAQ,OAAlB,CAAL,CAAiC,CAC7B,IAAI,sBAAJ,CAA2B,SAA3B,CAAsC,qBAAtC,CAA6D,UAAY,CACrE,QAAQ,OAAR,CAAkB,CACd,MAAO,QAAQ,KADD,CAEd,OAAQ,QAAQ,MAFF,CAGd,cAAe,aAHD,CAId,aAAc,QAAQ,YAJR,CAAlB,CAMH,CAPD,EAQH,CAED,GAAI,SAAU,EAAE,OAAF,CAAU,QAAQ,IAAlB,CAAwB,QAAQ,OAAhC,CAAd,CAEA,GAAI,WAAa,IAAI,QAAJ,CAAa,SAAb,CAAjB,CAA0C,CACtC,eAAe,SAAf,EAA4B,OAA5B,CACH,CAFD,IAEO,CACH,eAAiB,OAAjB,CACH,CAED,QAAQ,KAAR,CAAc,GAAd,EAEA,GAAI,CAAC,kBAAL,CAAyB,CACrB;AACA,mBAAqB,IAArB,CACA,YAAY,UAAZ,CAAuB,cAAvB,CAAuC,MAAM,EAA7C,EACH,CACJ,CAjCD,CAmCA,GAAI,SAAU,QAAS,QAAT,CAAiB,KAAjB,CAAwB,CAClC,SACA,GAAI,QAAJ,CAAc,CACV,GAAI,CAAC,KAAD,EAAU,CAAC,OAAO,IAAP,CAAY,KAAZ,EAAmB,MAAlC,CAA0C,OAC1C,IAAI,IAAJ,CAAS,KAAT,CAAgB,SAAU,CAAV,CAAa,IAAb,CAAmB,CAC/B;AACA;AACA,YAAY,CAAZ,CAAe,IAAf,EACH,CAJD,EAKA,OACH,CACD,YAAY,KAAZ,EACH,CAZD,CAcA,yBAAyB,MAAM,EAA/B,CAAmC,SAAnC,CAA8C,OAA9C,CAAuD,MAAvD,EAEA,YAAY,YAAZ,CAA0B,SAA1B,CAAqC,YAArC,CAAmD,SAAU,OAAV,CAAmB,CAClE,GAAI,UAAU,mBAAd,CAAmC,OACnC,QAAQ,OAAR,EACH,CAHD,EAIH,CAnGD,EAoGH,CAhHE,CAAP,CAkHH,CA3HD,EA6HA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,cAAvC,CAAuD,SAAU,OAAV,CAAmB,aAAnB,CAAkC,WAAlC,CAA+C,cAA/C,CAA+D,CAClH,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,CACH,MAAO,IADJ,CAEH,gBAAiB,IAFd,CAEoB;AACvB,WAAY,IAHT,CAGe;AAClB,MAAO,GAJJ,CAKH,UAAW,GALR,CAMH,cAAe,GANZ,CAFJ,CAUH,QAAS,IAVN,CAWH,WAAY,KAXT,CAYH,QAAS,UAZN,CAaH,WAAY,QAAS,WAAT,CAAoB,MAApB,CAA4B,QAA5B,CAAsC,IAAtC,CAA4C,CACpD,KAAK,KAAL,CAAW,qCAAX,CAAkD,MAAlD,CAA0D,QAA1D,EACA,GAAI,WAAY,eAAe,SAA/B,CACI,UAAY,eAAe,SAD/B,CAEA,QAAQ,MAAR,CAAe,MAAf,CAAuB,CACnB,UAAW,EADQ,CAEnB,SAAU,EAFS,CAGnB,gBAAiB,EAHE,CAInB,gBAAiB,EAJE,CAKnB,iBAAkB,eAAe,gBAAf,EALC,CAMnB,gBAAiB,QAAS,gBAAT,CAAyB,GAAzB,CAA8B,CAA9B,CAAiC,CAC9C,eAAe,SAAf,CAAyB,MAAzB,CAAiC,SAAU,GAAV,CAAe,CAC5C,IAAI,SAAJ,CAAgB,GAAhB,CACA,YAAY,MAAZ,GAAqB,IAArB,CAA0B,SAAU,GAAV,CAAe,CACrC,YAAY,SAAZ,GAAwB,IAAxB,CAA6B,SAAU,aAAV,CAAyB,CAClD,GAAI,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,GAAzB,CAAb,CAAJ,CAAiD,CAC7C,OACH,CACD,IAAK,GAAI,EAAT,GAAc,KAAI,MAAJ,CAAW,UAAzB,CAAqC,CACjC,IAAI,MAAJ,CAAW,UAAX,CAAsB,CAAtB,EAAyB,IAAzB,CAAgC,IAAI,KAAJ,CAAU,OAA1C,CACA,GAAI,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,CAAzB,CAAb,CAAJ,CAA+C,CAC3C,IAAI,WAAJ,CAAgB,cAAc,UAAd,CAAyB,CAAzB,CAAhB,EACH,CACJ,CACD,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,GAAzB,CAAb,EACA,IAAI,MAAJ,CAAW,UAAX,CAAsB,GAAtB,EAA2B,IAA3B,CAAkC,OAAO,KAAP,CAAa,KAA/C,CACH,CAZD,EAaH,CAdD,EAeH,CAjBD,EAkBA,EAAE,cAAF,GACH,CA1BkB,CA2BnB,UAAW,QAAS,UAAT,CAAmB,EAAnB,CAAuB,QAAvB,CAAiC,CAAjC,CAAoC,CAC3C,GAAI,OAAQ,OAAO,IAAP,CAAY,OAAO,MAAP,CAAc,UAA1B,EAAsC,MAAlD,CACA,GAAI,UAAY,EAAI,KAAhB,EAAyB,UAAY,OAAO,aAAP,CAAqB,MAArB,CAA8B,KAAvE,CAA8E,CAC1E,GAAI,MAAJ,CACA,IAAK,GAAI,IAAT,GAAgB,QAAO,MAAP,CAAc,QAA9B,CAAwC,CACpC,GAAI,OAAO,MAAP,CAAc,QAAd,CAAuB,GAAvB,EAA4B,KAA5B,GAAsC,QAA1C,CAAoD,CAChD,MAAQ,OAAO,MAAP,CAAc,QAAd,CAAuB,GAAvB,CAAR,CACA,MACH,CACJ,CACD,GAAI,KAAJ,CAAW,CACP,UAAU,MAAV,CAAkB,UAAY,CAC1B,MAAM,KAAN,CAAc,GAAG,KAAjB,CACA,GAAG,KAAH,CAAW,QAAX,CACH,CAHD,EAIH,CACJ,CACD,EAAE,eAAF,GACA,EAAE,cAAF,GACH,CA9CkB,CA+CnB,UAAW,QAAS,UAAT,CAAmB,KAAnB,CAA0B,GAA1B,CAA+B,CACtC,GAAI,OAAQ,OAAO,IAAP,CAAY,OAAO,MAAP,CAAc,UAA1B,EAAsC,MAAlD,CACA,MAAM,KAAN,CAAc,UAAU,MAAM,KAAhB,EAAyB,MAAM,KAA/B,CAAuC,IAAM,KAAN,CAAc,CAAnE,CACH,CAlDkB,CAmDnB,UAAW,QAAS,UAAT,CAAmB,SAAnB,CAA8B,CACrC,OAAO,eAAP,CAAuB,SAAvB,EAAoC,OAAO,eAAP,CAAuB,SAAvB,EAAoC,OAAO,eAAP,CAAuB,SAAvB,CAApC,CAAwE,EAA5G,CACH,CArDkB,CAsDnB,cAAe,QAAS,cAAT,CAAuB,CAAvB,CAA0B,KAA1B,CAAiC,CAC5C,GAAI,MAAM,OAAV,CAAmB,CACf,GAAI,OAAO,eAAP,EAA0B,CAAC,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,cAAlE,CAAkF,CAC9E,IAAK,GAAI,EAAT,GAAc,QAAO,eAArB,CAAsC,CAClC,OAAO,eAAP,CAAuB,CAAvB,EAA0B,cAA1B,CAA2C,KAA3C,CACH,CACJ,CACD,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,cAAnC,CAAoD,CAAC,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,cAAxF,CACH,CACD,EAAE,eAAF,GACA,EAAE,cAAF,GACH,CAjEkB,CAkEnB,aAAc,QAAS,aAAT,CAAsB,KAAtB,CAA6B,CACvC,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,UAAnC,CAAgD,CAAC,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,UAApF,CACH,CApEkB,CAqEnB,WAAY,QAAS,WAAT,CAAoB,KAApB,CAA2B,CACnC,MAAO,OAAM,MAAN,EAAgB,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,UAA1D,CACH,CAvEkB,CAwEnB,WAAY,QAAS,WAAT,CAAoB,IAApB,CAA0B,CAClC,MAAO,MAAK,WAAL,CAAiB,IAAjB,CAAP,CACH,CA1EkB,CA2EnB,eAAgB,QAAS,eAAT,CAAwB,KAAxB,CAA+B,CAC3C,MAAO,OAAM,OAAN,EAAiB,OAAO,eAAP,CAAuB,MAAM,IAA7B,EAAmC,cAApD,CAAqE,OAAO,KAAP,CAAa,KAAlF,CAA0F,OAAO,KAAP,CAAa,IAA9G,CACH,CA7EkB,CA8EnB,aAAc,QAAS,aAAT,CAAsB,KAAtB,CAA6B,CACvC,MAAO,OAAM,OAAN,CAAgB,OAAO,KAAP,CAAa,KAA7B,CAAqC,OAAO,KAAP,CAAa,OAAzD,CACH,CAhFkB,CAiFnB,sBAAuB,QAAS,sBAAT,CAA+B,SAA/B,CAA0C,CAC7D,GAAI,CAAC,UAAU,OAAO,eAAP,CAAuB,SAAvB,CAAV,CAAL,CAAmD,CAC/C,OACH,CACD,GAAI,SAAU,OAAO,eAAP,CAAuB,SAAvB,EAAkC,OAAhD,CACA,IAAK,GAAI,EAAT,GAAc,QAAO,MAAP,CAAc,QAA5B,CAAsC,CAClC,GAAI,OAAQ,OAAO,MAAP,CAAc,QAAd,CAAuB,CAAvB,CAAZ,CACA,GAAI,MAAM,KAAN,GAAgB,SAApB,CAA+B,CAC3B,MAAM,OAAN,CAAgB,OAAhB,CACH,CACJ,CACJ,CA5FkB,CAAvB,EA+FA,GAAI,KAAM,SAAS,GAAT,CAAa,CAAb,CAAV,CACA,GAAI,CAAC,EAAE,OAAF,CAAU,KAAf,CAAsB,CAClB,EAAE,QAAF,CAAW,uBAAX,CAAmC,GAAnC,EACA,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,YAAnB,CAAiC,EAAE,QAAF,CAAW,eAA5C,EACH,CAHD,IAGO,CACH,EAAE,QAAF,CAAW,EAAX,CAAc,GAAd,CAAmB,OAAnB,CAA4B,EAAE,QAAF,CAAW,eAAvC,EACH,CACJ,CAvHE,CAwHH,SAAU,8EAAgF,oCAAhF,CAAuH,6BAAvH,CAAuJ,6DAAvJ,CAAuN,kEAAvN,CAA4R,oEAA5R,CAAmW,8EAAnW,CAAob,mEAApb,CAA0f,6DAA1f,CAA0jB,2CAA1jB,CAAwmB,UAAxmB,CAAqnB,QAArnB,CAAgoB,QAAhoB,CAA2oB,2BAA3oB,CAAyqB,qEAAzqB,CAAivB,4BAAjvB,CAAgxB,8HAAhxB,CAAi5B,wHAAj5B,CAA4gC,4EAA5gC,CAA2lC,mGAA3lC,CAAisC,6FAAjsC,CAAiyC,8CAAjyC,CAAk1C,UAAl1C,CAA+1C,4BAA/1C,CAA83C,uGAA93C,CAAw+C,6DAAx+C,CAAwiD,2CAAxiD,CAAslD,UAAtlD,CAAmmD,wBAAnmD,CAA8nD,mHAA9nD,CAAovD,uHAApvD,CAA82D,6HAA92D,CAA8+D,0GAA9+D,CAA2lE,QAA3lE,CAAsmE,iGAAtmE,CAA0sE,+GAA1sE,CAA4zE,gFAA5zE,CAA+4E,6FAA/4E,CAA++E,4FAA/+E,CAA8kF,0FAA9kF,CAA2qF,2EAA3qF,CAAyvF,QAAzvF,CAAowF,QAApwF,CAA+wF,QAA/wF,CAA0xF,QAA1xF,CAAqyF,QAxH5yF,CAyHH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,WAAY,eAAe,SAA/B,CACI,aAAe,WAAW,eAAX,EADnB,CAEI,OAAS,aAAa,MAF1B,CAIA,MAAM,MAAN,CAAa,OAAb,CAAsB,UAAY,CAC9B,GAAI,cAAe,CACf,QAAS,gBADM,CAEf,MAAO,sBAFQ,CAGf,MAAO,oBAHQ,CAIf,QAAS,gBAJM,CAKf,GAAI,gBALW,CAMf,KAAM,kBANS,CAOf,KAAM,yBAPS,CAQf,MAAO,uBARQ,CASf,aAAc,uBATC,CAAnB,CAWA,GAAI,UAAU,MAAM,KAAhB,CAAJ,CAA4B,CACxB,QAAQ,MAAR,CAAe,YAAf,CAA6B,MAAM,KAAnC,EACA,QAAQ,MAAR,CAAe,MAAM,KAArB,CAA4B,YAA5B,EACH,CAHD,IAGO,CACH,MAAM,KAAN,CAAc,YAAd,CACH,CACJ,CAlBD,EAoBA;AACA,MAAM,KAAN,CAAc,UAAU,MAAM,KAAhB,IAA2B,MAAM,KAAN,GAAgB,QAAhB,EAA4B,MAAM,KAAN,GAAgB,SAAvE,EAAoF,MAAM,KAA1F,CAAkG,QAAhH,CACA,MAAM,KAAN,CAAc,MAAM,KAAN,GAAgB,QAA9B,CACA,MAAM,WAAN,CAAoB,MAAM,KAAN,GAAgB,QAAhB,CAA2B,CAAC,CAA5B,CAAgC,CAApD,CAEA,MAAM,MAAN,CAAe,MAAf,CACA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,aAAa,MAAb,CAAoB,mBAApB,CAAyC,SAAU,aAAV,CAAyB,CAC9D,GAAI,iBAAkB,EAAtB,CACA,YAAY,SAAZ,GAAwB,IAAxB,CAA6B,SAAU,aAAV,CAAyB,CAClD,GAAI,IAAJ,CACA,IAAK,GAAL,GAAY,cAAZ,CAA2B,CACvB,GAAI,OAAQ,cAAc,GAAd,CAAZ,CACA,MAAM,IAAN,CAAa,MAAM,KAAN,CAAY,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,GAAzB,CAAb,EAA8C,OAA9C,CAAwD,SAApE,CAAb,CACA,gBAAgB,GAAhB,EAAuB,KAAvB,CACH,CACD,MAAM,eAAN,CAAwB,eAAxB,CACH,CARD,EASH,CAXD,EAaA,aAAa,MAAb,CAAoB,iBAApB,CAAuC,SAAU,gBAAV,CAA4B,CAC/D,GAAI,eAAgB,EAApB,CACA,GAAI,mBAAoB,EAAxB,CACA,YAAY,SAAZ,GAAwB,IAAxB,CAA6B,UAAY,CACrC,GAAI,IAAJ,CACA,IAAK,GAAL,GAAY,iBAAZ,CAA8B,CAC1B,GAAI,OAAQ,iBAAiB,GAAjB,CAAZ,CACA,MAAM,IAAN,CAAa,MAAM,KAAN,CAAY,MAAM,OAAN,CAAgB,OAAhB,CAA0B,SAAtC,CAAb,CACA,cAAc,IAAd,CAAmB,KAAnB,EAEA,GAAI,CAAC,UAAU,MAAM,eAAN,CAAsB,MAAM,IAA5B,CAAV,CAAL,CAAmD,CAC/C,GAAI,UAAU,MAAM,YAAN,CAAmB,OAA7B,CAAJ,CAA2C,CACvC,MAAM,YAAN,CAAmB,OAAnB,CAA6B,CAA7B,CACH,CACD,MAAM,eAAN,CAAsB,MAAM,IAA5B,EAAoC,CAChC,eAAgB,KADgB,CAEhC,WAAY,IAFoB,CAGhC,aAAc,MAAM,YAHY,CAApC,CAKH,CACD,GAAI,UAAU,MAAM,KAAhB,CAAJ,CAA4B,CACxB,GAAI,CAAC,UAAU,MAAM,eAAN,CAAsB,MAAM,KAA5B,CAAV,CAAL,CAAoD,CAChD,MAAM,eAAN,CAAsB,MAAM,KAA5B,EAAqC,CACjC,QAAS,KADwB,CAArC,CAGH,CACD,kBAAkB,MAAM,KAAxB,EAAiC,UAAU,kBAAkB,MAAM,KAAxB,CAAV,EAA4C,kBAAkB,MAAM,KAAxB,CAA5C,CAA6E,CAC1G,MAAO,CADmG,CAE1G,SAAU,CAFgG,CAA9G,CAIA,kBAAkB,MAAM,KAAxB,EAA+B,KAA/B,GACA,GAAI,MAAM,OAAV,CAAmB,CACf,kBAAkB,MAAM,KAAxB,EAA+B,QAA/B,GACH,CACJ,CACD;;;;8BAKH,CAED,IAAK,GAAL,GAAY,kBAAZ,CAA+B,CAC3B,MAAM,eAAN,CAAsB,GAAtB,EAA2B,OAA3B,CAAqC,kBAAkB,GAAlB,EAAuB,QAAvB,GAAoC,kBAAkB,GAAlB,EAAuB,KAAhG,CACH,CACD,MAAM,aAAN,CAAsB,aAAtB,CACH,CA3CD,EA4CH,CA/CD,CA+CG,IA/CH,EAgDH,CA9DD,EA+DH,CAvNE,CAAP,CAyNH,CA3ND,EA6NA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,QAAvC,CAAiD,SAAU,aAAV,CAAyB,EAAzB,CAA6B,WAA7B,CAA0C,cAA1C,CAA0D,mBAA1D,CAA+E,qBAA/E,CAAsG,CACnJ;AACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAKH,WAAY,QAAS,WAAT,CAAoB,MAApB,CAA4B,CACpC,OAAO,cAAP,CAAwB,GAAG,KAAH,EAAxB,CACA,KAAK,SAAL,CAAiB,UAAY,CACzB,MAAO,QAAO,cAAP,CAAsB,OAA7B,CACH,CAFD,CAGH,CAVE,CAWH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,WAAY,eAAe,SAA/B,CACI,cAAgB,EADpB,CAEI,aAAe,WAAW,eAAX,EAFnB,CAGI,OAAS,aAAa,MAH1B,CAII,YAAc,oBAAoB,WAJtC,CAKI,aAAe,oBAAoB,YALvC,CAMI,gBAAkB,oBAAoB,eAN1C,CAOI,sBAAwB,oBAAoB,qBAPhD,CAQI,oBAAsB,sBAAsB,mBARhD,CASI,uBAAyB,KAT7B,CAWA,MAAM,GAAN,CAAU,UAAV,CAAsB,UAAY,CAC9B,sBAAsB,uBAAtB,CAA8C,MAAM,KAApD,EACH,CAFD,EAIA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CAEpC;AACA,MAAM,cAAN,CAAqB,OAArB,CAA6B,aAA7B,EACA,YAAY,SAAZ,CAAsB,aAAtB,CAAqC,MAAM,EAA3C,EAEA,cAAc,UAAd,CAA2B,EAA3B,CACA,cAAc,QAAd,CAAyB,EAAzB,CAEA,GAAI,OAAQ,MAAM,EAAlB,CAEA;AACA,GAAI,iBAAkB,KAAtB,CACA,IAAK,GAAI,UAAT,GAAsB,QAAO,UAA7B,CAAyC,CACrC,GAAI,cAAe,YAAY,OAAO,UAAP,CAAkB,SAAlB,CAAZ,CAAnB,CACA,GAAI,CAAC,UAAU,YAAV,CAAL,CAA8B,CAC1B,MAAO,QAAO,UAAP,CAAkB,SAAlB,CAAP,CACA,SACH,CACD,cAAc,UAAd,CAAyB,SAAzB,EAAsC,YAAtC,CACA;AACA;AACA,GAAI,OAAO,UAAP,CAAkB,SAAlB,EAA6B,GAA7B,GAAqC,IAAzC,CAA+C,CAC3C,aAAa,GAAb,CAAkB,cAAc,UAAd,CAAyB,SAAzB,CAAlB,EACA,gBAAkB,IAAlB,CACH,CACJ,CAED;AACA,GAAI,CAAC,eAAD,EAAoB,OAAO,IAAP,CAAY,cAAc,UAA1B,EAAsC,MAAtC,CAA+C,CAAvE,CAA0E,CACtE,aAAa,GAAb,CAAkB,cAAc,UAAd,CAAyB,OAAO,IAAP,CAAY,OAAO,UAAnB,EAA+B,CAA/B,CAAzB,CAAlB,EACH,CAED;AACA,IAAK,SAAL,GAAkB,QAAO,QAAzB,CAAmC,CAC/B,GAAI,OAAO,QAAP,CAAgB,SAAhB,EAA2B,IAA3B,GAAoC,SAAxC,CAAmD,CAAE,CACrD,GAAI,iBAAkB,YAAY,OAAO,QAAP,CAAgB,SAAhB,CAAZ,CAAtB,CACA,GAAI,CAAC,UAAU,eAAV,CAAL,CAAiC,CAC7B,MAAO,QAAO,QAAP,CAAgB,SAAhB,CAAP,CACA,SACH,CACD,cAAc,QAAd,CAAuB,SAAvB,EAAoC,eAApC,CACA;AACA,GAAI,OAAO,QAAP,CAAgB,SAAhB,EAA2B,OAA3B,GAAuC,IAA3C,CAAiD,CAC7C,aAAa,GAAb,CAAkB,cAAc,QAAd,CAAuB,SAAvB,CAAlB,EACH,CACJ,CAED;AACA,aAAa,MAAb,CAAoB,mBAApB,CAAyC,SAAU,aAAV,CAAyB,aAAzB,CAAwC,CAC7E,GAAI,QAAQ,MAAR,CAAe,aAAf,CAA8B,aAA9B,CAAJ,CAAkD,CAC9C,uBAAyB,oBAAoB,GAApB,CAAyB,KAAzB,CAAgC,sBAAhC,CAAwD,aAAxD,CAAuE,OAAO,QAA9E,CAAwF,aAAxF,CAAzB,CACA,MAAO,KAAP,CACH,CACD;AACA,IAAK,GAAI,KAAT,GAAiB,eAAc,UAA/B,CAA2C,CACvC,GAAI,CAAC,UAAU,cAAc,IAAd,CAAV,CAAD,EAAmC,cAAc,IAAd,EAAoB,SAA3D,CAAsE,CAClE;AACA,GAAI,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,IAAzB,CAAb,CAAJ,CAAkD,CAC9C,IAAI,WAAJ,CAAgB,cAAc,UAAd,CAAyB,IAAzB,CAAhB,EACH,CACD,MAAO,eAAc,UAAd,CAAyB,IAAzB,CAAP,CAEA,GAAI,cAAc,IAAd,GAAuB,cAAc,IAAd,EAAoB,SAA/C,CAA0D,CACtD,cAAc,IAAd,EAAoB,SAApB,CAAgC,KAAhC,CACH,CACJ,CACJ,CACD;AACA,IAAK,GAAI,QAAT,GAAoB,cAApB,CAAmC,CAC/B,GAAI,CAAC,UAAU,cAAc,UAAd,CAAyB,OAAzB,CAAV,CAAL,CAAmD,CAC/C,GAAI,eAAgB,YAAY,cAAc,OAAd,CAAZ,CAApB,CACA,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC1B,cAAc,UAAd,CAAyB,OAAzB,EAAoC,aAApC,CACA;AACA,GAAI,cAAc,OAAd,EAAuB,GAAvB,GAA+B,IAAnC,CAAyC,CACrC,aAAa,GAAb,CAAkB,cAAc,UAAd,CAAyB,OAAzB,CAAlB,EACH,CACJ,CACJ,CATD,IASO,CACH,GAAI,cAAc,OAAd,EAAuB,GAAvB,GAA+B,IAA/B,EAAuC,CAAC,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,OAAzB,CAAb,CAA5C,CAA6F,CACzF,aAAa,GAAb,CAAkB,cAAc,UAAd,CAAyB,OAAzB,CAAlB,EACH,CAFD,IAEO,IAAI,cAAc,OAAd,EAAuB,GAAvB,GAA+B,KAA/B,EAAwC,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,OAAzB,CAAb,CAA5C,CAA6F,CAChG,IAAI,WAAJ,CAAgB,cAAc,UAAd,CAAyB,OAAzB,CAAhB,EACH,CACJ,CACJ,CAED;AACA,GAAI,OAAQ,KAAZ,CACA;AACA,IAAK,GAAI,IAAT,GAAgB,eAAc,UAA9B,CAA0C,CACtC,GAAI,IAAI,QAAJ,CAAa,cAAc,UAAd,CAAyB,GAAzB,CAAb,CAAJ,CAAiD,CAC7C,MAAQ,IAAR,CACA,MACH,CACJ,CACD;AACA,GAAI,CAAC,KAAD,EAAU,OAAO,IAAP,CAAY,cAAc,UAA1B,EAAsC,MAAtC,CAA+C,CAA7D,CAAgE,CAC5D,aAAa,GAAb,CAAkB,cAAc,UAAd,CAAyB,OAAO,IAAP,CAAY,cAAc,UAA1B,EAAsC,CAAtC,CAAzB,CAAlB,EACH,CAED;AACA,uBAAyB,oBAAoB,GAApB,CAAyB,KAAzB,CAAgC,sBAAhC,CAAwD,aAAxD,CAAuE,OAAO,QAA9E,CAAwF,aAAxF,CAAzB,CACH,CAvDD,CAuDG,IAvDH,EAyDA;AACA,aAAa,MAAb,CAAoB,iBAApB,CAAuC,SAAU,gBAAV,CAA4B,gBAA5B,CAA8C,CACjF,GAAI,QAAQ,MAAR,CAAe,gBAAf,CAAiC,gBAAjC,CAAJ,CAAwD,CACpD,uBAAyB,oBAAoB,GAApB,CAAyB,KAAzB,CAAgC,sBAAhC,CAAwD,OAAO,UAA/D,CAA2E,gBAA3E,CAA6F,aAA7F,CAAzB,CACA,MAAO,KAAP,CACH,CAED;AACA,IAAK,GAAI,KAAT,GAAiB,eAAc,QAA/B,CAAyC,CACrC,GAAI,CAAC,UAAU,iBAAiB,IAAjB,CAAV,CAAD,EAAsC,iBAAiB,IAAjB,EAAuB,SAAjE,CAA4E,CACxE;AACA,GAAI,IAAI,QAAJ,CAAa,cAAc,QAAd,CAAuB,IAAvB,CAAb,CAAJ,CAAgD,CAC5C;AACA,GAAI,SAAU,UAAU,iBAAiB,IAAjB,CAAV,EAAoC,iBAAiB,IAAjB,EAAuB,YAA3D,CAA0E,IAAxF,CACA,gBAAgB,GAAhB,CAAqB,cAAc,QAAd,CAAuB,IAAvB,CAArB,CAAmD,OAAnD,EACH,CACD;AACA,MAAO,eAAc,QAAd,CAAuB,IAAvB,CAAP,CAEA,GAAI,iBAAiB,IAAjB,GAA0B,iBAAiB,IAAjB,EAAuB,SAArD,CAAgE,CAC5D,iBAAiB,IAAjB,EAAuB,SAAvB,CAAmC,KAAnC,CACH,CACJ,CACJ,CAED;AACA,IAAK,GAAI,QAAT,GAAoB,iBAApB,CAAsC,CAClC,GAAI,CAAC,UAAU,cAAc,QAAd,CAAuB,OAAvB,CAAV,CAAL,CAAiD,CAC7C,GAAI,kBAAmB,YAAY,iBAAiB,OAAjB,CAAZ,CAAvB,CACA,GAAI,CAAC,UAAU,gBAAV,CAAL,CAAkC,CAC9B;AACA,SACH,CACD,cAAc,QAAd,CAAuB,OAAvB,EAAkC,gBAAlC,CACA,GAAI,iBAAiB,OAAjB,EAA0B,OAA1B,GAAsC,IAA1C,CAAgD,CAC5C,aAAa,GAAb,CAAkB,cAAc,QAAd,CAAuB,OAAvB,CAAlB,EACH,CAED,GAAI,UAAU,iBAAiB,OAAjB,EAA0B,KAApC,GAA8C,cAAc,QAAd,CAAuB,OAAvB,EAAgC,SAAlF,CAA6F,CACzF,cAAc,QAAd,CAAuB,OAAvB,EAAgC,SAAhC,CAA0C,iBAAiB,OAAjB,EAA0B,KAApE,EACH,CACJ,CAdD,IAcO,CACH;AACA,GAAI,iBAAiB,OAAjB,EAA0B,OAA1B,EAAqC,CAAC,IAAI,QAAJ,CAAa,cAAc,QAAd,CAAuB,OAAvB,CAAb,CAA1C,CAAyF,CACrF,aAAa,GAAb,CAAkB,cAAc,QAAd,CAAuB,OAAvB,CAAlB,EACH,CAFD,IAEO,IAAI,iBAAiB,OAAjB,EAA0B,OAA1B,GAAsC,KAAtC,EAA+C,IAAI,QAAJ,CAAa,cAAc,QAAd,CAAuB,OAAvB,CAAb,CAAnD,CAAkG,CACrG;AACA,gBAAgB,GAAhB,CAAqB,cAAc,QAAd,CAAuB,OAAvB,CAArB,CAAsD,iBAAiB,OAAjB,EAA0B,YAAhF,EACH,CAED;AACA,GAAI,IAAK,cAAc,QAAd,CAAuB,OAAvB,CAAT,CACA,GAAI,IAAI,QAAJ,CAAa,cAAc,QAAd,CAAuB,OAAvB,CAAb,CAAJ,CAAmD,CAC/C,GAAI,iBAAiB,OAAjB,EAA0B,YAA1B,CAAuC,OAAvC,GAAmD,iBAAiB,OAAjB,EAA0B,YAA1B,CAAuC,OAA9F,CAAuG,CAEnG,GAAI,UAAU,GAAG,UAAb,CAAJ,CAA8B,CAC1B,GAAG,UAAH,CAAc,iBAAiB,OAAjB,EAA0B,YAA1B,CAAuC,OAArD,EACH,CACD,GAAI,UAAU,GAAG,SAAb,GAA2B,UAAU,GAAG,SAAb,CAA/B,CAAwD,CACpD,GAAG,SAAH,CAAa,sBAAsB,iBAAiB,OAAjB,EAA0B,YAA1B,CAAuC,OAA7D,CAAb,EACH,CACJ,CAED,GAAI,UAAU,iBAAiB,OAAjB,EAA0B,KAApC,GAA8C,GAAG,SAAjD,EAA8D,iBAAiB,OAAjB,EAA0B,KAA1B,GAAoC,iBAAiB,OAAjB,EAA0B,KAAhI,CAAuI,CACnI,GAAG,SAAH,CAAa,iBAAiB,OAAjB,EAA0B,KAAvC,EACH,CACJ,CACJ,CAED;AACA,GAAI,iBAAiB,OAAjB,EAA0B,OAA1B,EAAqC,IAAI,OAAzC,EAAoD,iBAAiB,OAAjB,EAA0B,IAA9E,EAAsF,iBAAiB,OAAjB,EAA0B,IAA1B,GAAmC,SAA7H,CAAwI,CACpI,cAAc,QAAd,CAAuB,OAAvB,EAAgC,OAAhC,CAAwC,iBAAiB,OAAjB,EAA0B,IAAlE,EACA,cAAc,QAAd,CAAuB,OAAvB,EAAgC,MAAhC,GACH,CACJ,CAED;AACA,uBAAyB,oBAAoB,GAApB,CAAyB,KAAzB,CAAgC,sBAAhC,CAAwD,OAAO,UAA/D,CAA2E,gBAA3E,CAA6F,aAA7F,CAAzB,CACH,CA7ED,CA6EG,IA7EH,EA8EH,CAzLD,EA0LH,CArNE,CAAP,CAuNH,CAzND,EA2NA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,QAAvC,CAAiD,SAAU,aAAV,CAAyB,KAAzB,CAAgC,QAAhC,CAA0C,cAA1C,CAA0D,oBAA1D,CAAgF,CAC7H,GAAI,MAAO,aAAX,CACI,YAAc,eAAe,WAAf,CAA6B,YAD/C,CAEA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAKH,WAAY,KALT,CAOH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CAEnD,GAAI,SAAU,eAAe,OAA7B,CACI,SAAW,eAAe,QAD9B,CAEI,UAAY,eAAe,SAF/B,CAGI,WAAa,eAAe,UAHhC,CAII,aAAe,WAAW,eAAX,EAJnB,CAKI,OAAS,aAAa,MAL1B,CAOA,GAAI,YAAJ,CACA,GAAI,SAAJ,CACA,GAAI,cAAJ,CACA,GAAI,KAAJ,CAEA,aAAa,MAAb,CAAoB,QAApB,CAA8B,SAAU,SAAV,CAAqB,CAE/C,GAAI,UAAU,SAAV,CAAJ,CAA0B,CACtB,YAAc,UAAU,WAAV,CAAwB,UAAU,WAAlC,CAAgD,QAA9D,CACA,SAAW,UAAU,QAAV,EAAsB,aAAjC,CACA;AACA,KAAO,UAAU,IAAV,EAAkB,QAAzB,CACH,CACJ,CARD,CAQG,IARH,EAUA,GAAI,cAAe,QAAS,aAAT,CAAsB,GAAtB,CAA2B,UAA3B,CAAuC,MAAvC,CAA+C,CAC9D,GAAI,YAAc,WAAW,MAAzB,EAAmC,WAAW,MAAX,CAAkB,MAAlB,CAA2B,CAAlE,CAAqE,CACjE,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC1B,qBAAqB,YAArB,CAAkC,cAAc,YAAd,EAAlC,CAAgE,UAAhE,CAA4E,IAA5E,CAAkF,MAAlF,EACH,CAFD,IAEO,CACH,cAAgB,EAAE,OAAF,CAAU,CACtB,SAAU,QADY,CAAV,CAAhB,CAGA,cAAc,KAAd,CAAsB,qBAAqB,cAArB,CAAoC,UAApC,CAAgD,WAAhD,CAA6D,IAA7D,CAAmE,MAAnE,CAAtB,CACA,cAAc,KAAd,CAAoB,GAApB,EACH,CAED,GAAI,UAAU,OAAO,UAAjB,GAAgC,WAAW,OAAO,UAAlB,CAApC,CAAmE,CAC/D,OAAO,UAAP,GACH,CACJ,CACJ,CAhBD,CAkBA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,aAAa,MAAb,CAAoB,QAApB,CAA8B,SAAU,SAAV,CAAqB,CAC/C,GAAI,CAAC,UAAU,SAAV,CAAL,CAA2B,CACvB,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC1B,cAAc,UAAd,CAAyB,GAAzB,EACA,cAAgB,IAAhB,CACH,CAED,OACH,CAED,GAAI,CAAC,UAAU,UAAU,GAApB,CAAD,EAA6B,OAAS,QAAtC,GAAmD,CAAC,QAAQ,UAAU,MAAlB,CAAD,EAA8B,CAAC,QAAQ,UAAU,MAAlB,CAA/B,EAA4D,UAAU,MAAV,CAAiB,MAAjB,GAA4B,UAAU,MAAV,CAAiB,MAA5J,CAAJ,CAAyK,CACrK,KAAK,IAAL,CAAU,YAAc,+CAAxB,EACA,OACH,CAED,GAAI,UAAU,UAAU,GAApB,CAAJ,CAA8B,CAC1B,KAAK,IAAL,CAAU,YAAc,0BAAxB,EACA,OACH,CAED,GAAI,UAAU,aAAV,CAAJ,CAA8B,CAC1B,cAAc,UAAd,CAAyB,GAAzB,EACA,cAAgB,IAAhB,CACH,CAED,cAAgB,EAAE,OAAF,CAAU,CACtB,SAAU,QADY,CAAV,CAAhB,CAIA,GAAI,OAAS,QAAb,CAAuB,CACnB,cAAc,KAAd,CAAsB,qBAAqB,mBAArB,CAAyC,SAAzC,CAAoD,WAApD,CAAtB,CACH,CACD,cAAc,KAAd,CAAoB,GAApB,EACH,CAjCD,EAmCA,aAAa,MAAb,CAAoB,YAApB,CAAkC,SAAU,MAAV,CAAkB,CAChD,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,CACpB,OACH,CAED,GAAI,CAAC,QAAQ,MAAR,CAAD,EAAoB,CAAC,SAAS,MAAT,CAAzB,CAA2C,CACvC,KAAK,IAAL,CAAU,YAAc,yCAAxB,EACA,OACH,CAED,GAAI,MAAO,SAAS,MAAT,EAAmB,CAAC,MAAD,CAAnB,CAA8B,MAAzC,CAEA,GAAI,WAAJ,CACA,GAAI,UAAW,QAAS,SAAT,CAAkB,GAAlB,CAAuB,GAAvB,CAA4B,CACvC,MAAO,UAAU,EAAV,CAAc,CACjB,GAAI,UAAU,GAAG,IAAH,CAAQ,KAAlB,CAAJ,CAA8B,CAC1B,KAAK,IAAL,CAAU,YAAc,4BAAd,CAA6C,GAAvD,CAA4D,GAAG,IAAH,CAAQ,KAAR,CAAc,OAA1E,EACH,CAFD,IAEO,CACH,GAAI,YAAc,WAAW,MAAzB,EAAmC,WAAW,MAAX,CAAkB,MAAlB,CAA2B,CAAlE,CAAqE,CACjE,WAAW,MAAX,CAAoB,WAAW,MAAX,CAAkB,MAAlB,CAAyB,GAAG,IAAH,CAAQ,MAAjC,CAApB,CACH,CAFD,IAEO,CACH,WAAa,GAAG,IAAhB,CACH,CACJ,CAED,GAAI,MAAQ,KAAK,MAAL,CAAc,CAA1B,CAA6B,CACzB,aAAa,GAAb,CAAkB,UAAlB,CAA8B,MAA9B,EACH,CACJ,CAdD,CAeH,CAhBD,CAiBA,GAAI,SAAU,QAAS,QAAT,CAAiB,GAAjB,CAAsB,CAChC,KAAK,IAAL,CAAU,YAAc,yBAAxB,CAAmD,GAAnD,EACH,CAFD,CAIA,IAAK,GAAI,GAAI,CAAb,CAAgB,EAAI,KAAK,MAAzB,CAAiC,GAAjC,CAAsC,CAClC,qBAAqB,YAArB,CAAkC,MAAM,EAAxC,CAA4C,CACxC,IAAK,KAAK,CAAL,CADmC,CAExC,OAAQ,KAFgC,CAA5C,EAGG,IAHH,CAGQ,SAAS,CAAT,CAHR,EAGqB,KAHrB,CAG2B,OAH3B,EAIH,CACJ,CAxCD,EA0CA,aAAa,MAAb,CAAoB,mBAApB,CAAyC,SAAU,UAAV,CAAsB,CAC3D,KAAK,KAAL,CAAW,YAAX,CAAyB,UAAzB,EACA,GAAI,UAAU,aAAa,MAAb,CAAoB,GAA9B,GAAsC,CAAC,UAAU,UAAV,CAA3C,CAAkE,CAC9D,OACH,CAED,aAAa,GAAb,CAAkB,UAAlB,EACH,CAPD,CAOG,IAPH,EAQH,CAtFD,EAuFH,CAxIE,CAAP,CA0IH,CA7ID,EA+IA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,SAAvC,CAAkD,SAAU,aAAV,CAAyB,UAAzB,CAAqC,EAArC,CAAyC,WAAzC,CAAsD,cAAtD,CAAsE,kBAAtE,CAA0F,qBAA1F,CAAiH,mBAAjH,CAAsI,gBAAtI,CAAwJ,mBAAxJ,CAA6K,+BAA7K,CAA8M,CAC5P;AACA,GAAI,WAAY,eAAe,SAA/B,CACI,YAAc,eAAe,WADjC,CAEI,QAAU,cAFd,CAGI,SAAW,eAAe,QAH9B,CAII,iBAAmB,sBAAsB,gBAJ7C,CAKI,aAAe,sBAAsB,YALzC,CAMI,mBAAqB,sBAAsB,kBAN/C,CAOI,iBAAmB,sBAAsB,gBAP7C,CAQI,aAAe,sBAAsB,YARzC,CASI,aAAe,sBAAsB,YATzC,CAUI,mBAAqB,sBAAsB,kBAV/C,CAWI,eAAiB,sBAAsB,cAX3C,CAYI,wBAA0B,sBAAsB,uBAZpD,CAaI,IAAM,gBAbV,CAcI,qBAAuB,eAAe,YAd1C,CAeI,WAAa,oBAAoB,UAfrC,CAgBI,wBAA0B,gCAAgC,MAhB9D,CAiBI,KAAO,aAjBX,CAkBI,UAAY,CAAE,oBAAqB,KAAvB,CAlBhB,CAoBA,GAAI,aAAc,QAAS,YAAT,CAAqB,cAArB,CAAqC,IAArC,CAA2C,cAA3C,CAA2D,CACzE,GAAI,CAAC,OAAO,IAAP,CAAY,cAAZ,EAA4B,MAAjC,CAAyC,OACzC,GAAI,gBAAkB,SAAS,cAAT,CAAtB,CAAgD,CAC5C,GAAI,CAAC,eAAe,cAAf,CAAD,EAAmC,CAAC,OAAO,IAAP,CAAY,eAAe,cAAf,CAAZ,EAA4C,MAApF,CAA4F,OAC5F,MAAO,gBAAe,cAAf,EAA+B,IAA/B,CAAP,CACH,CACD,MAAO,gBAAe,IAAf,CAAP,CACH,CAPD,CASA,GAAI,aAAc,QAAS,YAAT,CAAqB,OAArB,CAA8B,cAA9B,CAA8C,IAA9C,CAAoD,cAApD,CAAoE,CAClF,GAAI,gBAAkB,SAAS,cAAT,CAAtB,CAAgD,CAC5C,GAAI,CAAC,UAAU,eAAe,cAAf,CAAV,CAAL,CAAgD,eAAe,cAAf,EAAiC,EAAjC,CAChD,eAAe,cAAf,EAA+B,IAA/B,EAAuC,OAAvC,CACH,CAHD,IAGO,gBAAe,IAAf,EAAuB,OAAvB,CACP,MAAO,QAAP,CACH,CAND,CAQA,GAAI,wBAAyB,QAAS,uBAAT,CAAgC,SAAhC,CAA2C,MAA3C,CAAmD,KAAnD,CAA0D,MAA1D,CAAkE,SAAlE,CAA6E,GAA7E,CAAkF,CAE3G,GAAI,CAAC,SAAS,SAAT,CAAL,CAA0B,CACtB,KAAK,KAAL,CAAW,YAAc,+BAAzB,EACA,MAAO,MAAP,CACH,CAED,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,CACpB,KAAK,KAAL,CAAW,YAAc,2FAAzB,EACA,MAAO,MAAP,CACH,CAED,GAAI,CAAC,UAAU,OAAO,QAAjB,CAAD,EAA+B,CAAC,UAAU,OAAO,QAAP,CAAgB,SAAhB,CAAV,CAApC,CAA2E,CACvE,KAAK,KAAL,CAAW,YAAc,wDAAzB,EACA,MAAO,MAAP,CACH,CACD,GAAI,YAAa,OAAO,QAAP,CAAgB,SAAhB,CAAjB,CACA,GAAI,EAAE,qBAAsB,GAAE,UAAxB,EAAsC,qBAAsB,GAAE,YAAhE,CAAJ,CAAmF,CAC/E,KAAK,KAAL,CAAW,YAAc,sFAAzB,EACA,MAAO,MAAP,CACH,CAED;AACA,WAAW,QAAX,CAAoB,MAApB,EAEA;AACA;AACA,GAAI,YAAc,IAAd,EAAsB,IAAI,QAAJ,CAAa,MAAb,CAAtB,EAA8C,MAAM,KAAN,GAAgB,IAAlE,CAAwE,CACpE,OAAO,SAAP,GACH,CACD,MAAO,KAAP,CACH,CA/BD,CAgCA;AACA,GAAI,aAAc,QAAS,YAAT,CAAqB,KAArB,CAA4B,eAA5B,CAA6C,SAA7C,CAAwD,GAAxD,CAA6D,MAA7D,CAAqE,cAArE,CAAqF,YAArF,CAAmG,YAAnG,CAAiH,cAAjH,CAAiI,KAAjI,CAAwI,CACtJ,IAAI,IAAJ,CAAS,eAAT,CAA0B,SAAU,KAAV,CAAiB,OAAjB,CAA0B,CAChD,GAAI,MAAM,OAAN,CAAJ,CAAoB,OAEpB,GAAI,QAAQ,MAAR,CAAe,GAAf,IAAwB,CAAC,CAA7B,CAAgC,CAC5B,KAAK,KAAL,CAAW,iDAAmD,OAAnD,CAA6D,IAAxE,EACA,OACH,CAED,GAAI,cAAe,QAAQ,gBAAR,CAAyB,eAAiB,CAAC,cAAD,CAAiB,OAAjB,CAAjB,CAA6C,CAAC,OAAD,CAAtE,CAAnB,CACA,GAAI,cAAe,YAAY,cAAZ,CAA4B,OAA5B,CAAqC,cAArC,CAAnB,CACA,QAAQ,sBAAR,CAA+B,SAA/B,CAA0C,qBAA1C,CAAiE,UAAY,CACzE,GAAI,CAAC,UAAU,YAAV,CAAL,CAA8B,CAE1B,GAAI,QAAS,aAAa,KAAb,CAAb,CACA,GAAI,WAAY,CAAC,MAAQ,MAAM,KAAd,CAAsB,SAAvB,GAAqC,cAArD,CAAqE;AACrE,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,CACpB,KAAK,KAAL,CAAW,YAAc,uCAAd,CAAwD,OAAxD,CAAkE,GAA7E,EACA,OACH,CACD,YAAY,MAAZ,CAAoB,cAApB,CAAoC,OAApC,CAA6C,cAA7C,EAEA;AACA,GAAI,UAAU,MAAM,OAAhB,CAAJ,CAA8B,CAC1B,OAAO,SAAP,CAAiB,MAAM,OAAvB,CAAgC,MAAM,YAAtC,EACH,CAED;AACA,GAAI,UAAU,MAAM,KAAhB,CAAJ,CAA4B,CACxB,GAAI,cAAe,UAAU,MAAM,WAAhB,EAA+B,MAAM,WAArC,CAAmD,IAAtE,CACA,iBAAiB,MAAjB,CAAyB,MAAM,KAA/B,CAAsC,YAAtC,CAAoD,GAApD,EACH,CAED;AACA,GAAI,QAAQ,WAAR,CAAoB,QAApB,IAAkC,UAAU,MAAM,KAAhB,CAAlC,EAA4D,UAAU,MAAM,KAAN,CAAY,OAAtB,CAAhE,CAAgG,CAC5F,OAAO,SAAP,CAAiB,MAAM,KAAN,CAAY,OAA7B,CAAsC,MAAM,KAAN,CAAY,OAAlD,EACH,CAED;AACA,GAAI,UAAU,KAAV,IAAqB,UAAU,MAAM,KAAhB,GAA0B,UAAU,cAAV,CAA/C,CAAJ,CAA+E,CAE3E,GAAI,MAAO,uBAAuB,SAAvB,CAAkC,MAAlC,CAA0C,KAA1C,CAAiD,MAAjD,CAAyD,aAAa,UAAb,CAAwB,IAAjF,CAAuF,GAAvF,CAAX,CACA,GAAI,CAAC,IAAL,CAAW,OAAQ;AACtB,CAJD,IAIO,IAAI,CAAC,UAAU,MAAM,KAAhB,CAAL,CAA6B,CAChC;AACA,IAAI,QAAJ,CAAa,MAAb,EACA,GAAI,aAAa,UAAb,CAAwB,IAAxB,GAAiC,IAAjC,EAAyC,MAAM,KAAN,GAAgB,IAA7D,CAAmE,CAC/D,OAAO,SAAP,GACH,CACJ,CAED,GAAI,aAAa,UAAb,CAAwB,IAAxB,GAAiC,IAArC,CAA2C,CACvC,iBAAiB,MAAjB,CAAyB,YAAzB,CAAuC,YAAvC,CAAqD,MAArD,CAA6D,GAA7D,CAAkE,aAAa,UAA/E,EACH,CAED,mBAAmB,MAAnB,CAA2B,KAA3B,CAAkC,YAAlC,CAAgD,aAAa,UAAb,CAAwB,IAAxE,CAA8E,GAA9E,EACA,oBAAoB,UAApB,CAA+B,KAA/B,CAAsC,MAAtC,CAA8C,YAA9C,CAA4D,KAA5D,CAAmE,YAAnE,CAAiF,SAAjF,EACH,CA7CD,IA6CO,CACH,GAAI,UAAW,mBAAmB,SAAnB,CAA8B,OAA9B,CAAuC,cAAvC,CAAf,CACA,aAAa,KAAb,CAAoB,QAApB,CAA8B,YAA9B,CAA4C,YAA5C,CAA0D,YAA1D,CAAwE,MAAxE,CAAgF,GAAhF,EACH,CACJ,CAlDD,EAmDH,CA7DD,EA8DH,CA/DD,CAgEA,GAAI,uBAAwB,QAAS,sBAAT,CAA+B,YAA/B,CAA6C,eAA7C,CAA8D,QAA9D,CAAwE,OAAxE,CAAiF,EAAjF,CAAqF,CAC7G,GAAI,WAAY,KAAhB,CACI,OAAS,KADb,CAEI,SAFJ,CAGI,SAHJ,CAKA,GAAI,iBAAkB,UAAU,eAAV,CAAtB,CACA,IAAK,GAAI,KAAT,GAAiB,SAAjB,CAA2B,CACvB,GAAI,CAAC,SAAL,CAAgB,CACZ,KAAK,KAAL,CAAW,YAAc,qBAAzB,EACA,UAAY,IAAZ,CACH,CAED,GAAI,eAAJ,CAAqB,CACjB;AACA;AACA,UAAY,aAAa,IAAb,CAAZ,CACA,UAAY,gBAAgB,IAAhB,CAAZ,CACA,OAAS,SAAW,QAAQ,MAAR,CAAe,SAAf,CAA0B,SAA1B,CAApB,CACH,CACD,GAAI,CAAC,UAAU,YAAV,CAAD,EAA4B,CAAC,OAAO,IAAP,CAAY,YAAZ,EAA0B,MAAvD,EAAiE,CAAC,UAAU,aAAa,IAAb,CAAV,CAAlE,EAAmG,CAAC,OAAO,IAAP,CAAY,aAAa,IAAb,CAAZ,EAAgC,MAApI,EAA8I,MAAlJ,CAA0J,CACtJ,GAAI,IAAM,QAAQ,UAAR,CAAmB,EAAnB,CAAV,CAAkC,GAAG,SAAH,CAAc,SAAd,CAAyB,IAAzB,EACrC,CACJ,CACJ,CAxBD,CAyBA,GAAI,UAAW,QAAS,SAAT,CAAkB,YAAlB,CAAgC,eAAhC,CAAiD,QAAjD,CAA2D,GAA3D,CAAgE,MAAhE,CAAwE,CACnF,sBAAsB,YAAtB,CAAoC,eAApC,CAAqD,QAArD,CAA+D,KAA/D,CAAsE,SAAU,SAAV,CAAqB,SAArB,CAAgC,WAAhC,CAA6C,CAC/G,KAAK,KAAL,CAAW,YAAc,+BAAd,CAAgD,WAA3D,EACA,aAAa,SAAS,WAAT,CAAb,CAAoC,GAApC,CAAyC,MAAzC,EACA,MAAO,UAAS,WAAT,CAAP,CACH,CAJD,EAKH,CAND,CAQA,GAAI,sBAAuB,QAAS,qBAAT,CAA8B,SAA9B,CAAyC,SAAzC,CAAoD,QAApD,CAA8D,CACrF,GAAI,OAAQ,EAAZ,CACA,sBAAsB,SAAtB,CAAiC,SAAjC,CAA4C,QAA5C,CAAsD,IAAtD,CAA4D,SAAU,SAAV,CAAqB,SAArB,CAAgC,WAAhC,CAA6C,CACrG,KAAK,KAAL,CAAW,YAAc,wCAAd,CAAyD,WAApE,EACA,MAAM,WAAN,EAAqB,SAArB,CACH,CAHD,EAIA,MAAO,MAAP,CACH,CAPD,CASA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,CAAC,SAAD,CAAY,SAAZ,CAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,eAAgB,WAAW,CAAX,CAApB,CACI,aAAe,cAAc,eAAd,EADnB,CAGA,cAAc,MAAd,GAAuB,IAAvB,CAA4B,SAAU,GAAV,CAAe,CACvC,GAAI,gBAAiB,EAArB,CACI,SADJ,CAGA;AACA,GAAI,UAAU,WAAW,CAAX,CAAV,CAAJ,CAA8B,CAC1B,UAAY,WAAW,CAAX,EAAc,SAA1B,CACH,CAFD,IAEO,CACH,UAAY,QAAS,UAAT,EAAqB,CAC7B,GAAI,UAAW,GAAG,KAAH,EAAf,CACA,SAAS,OAAT,GACA,MAAO,UAAS,OAAhB,CACH,CAJD,CAKH,CAED,GAAI,aAAJ,CACA,GAAI,aAAa,YAAb,EAA6B,aAAa,YAAb,CAA0B,OAA3D,CAAoE,CAChE,aAAe,aAAa,YAAb,CAA0B,OAAzC,CACH,CAFD,IAEO,CACH,aAAe,oBAAf,CACH,CAED,GAAI,UAAW,UAAU,MAAM,aAAhB,GAAkC,QAAQ,QAAR,CAAiB,MAAM,aAAvB,CAAjD,CAEA,YAAY,IAAZ,CAAiB,SAAU,MAAV,CAAkB,CAC/B,GAAI,QAAS,QAAS,OAAT,CAAgB,MAAhB,CAAwB,SAAxB,CAAmC,CAC5C,0BACA,GAAI,QAAJ,CAAc,CACV,IAAI,IAAJ,CAAS,MAAT,CAAiB,SAAU,gBAAV,CAA4B,SAA5B,CAAuC,CACpD,GAAI,gBAAiB,eAAe,SAAf,CAA0B,SAA1B,CAArB,CACA,SAAS,gBAAT,CAA2B,cAA3B,CAA2C,eAAe,SAAf,CAA3C,CAAsE,GAAtE,CAA2E,MAA3E,EACH,CAHD,EAIA,OACH,CACD,SAAS,MAAT,CAAiB,SAAjB,CAA4B,cAA5B,CAA4C,GAA5C,CAAiD,MAAjD,EACH,CAVD,CAYA,GAAI,SAAU,QAAS,QAAT,CAAiB,MAAjB,CAAyB,SAAzB,CAAoC,CAC9C,OAAO,MAAP,CAAe,SAAf,EACA,GAAI,OAAQ,IAAZ,CACA,GAAI,QAAJ,CAAc,CACV,IAAI,IAAJ,CAAS,MAAT,CAAiB,SAAU,YAAV,CAAwB,SAAxB,CAAmC,CAChD,GAAI,gBAAiB,eAAe,SAAf,CAA0B,SAA1B,CAArB,CACA,GAAI,gBAAiB,eAAe,MAAf,CAAuB,SAAvB,CAArB,CACA,MAAQ,qBAAqB,cAArB,CAAqC,cAArC,CAAqD,eAAe,SAAf,CAArD,CAAR,CACA,YAAY,MAAM,EAAlB,CAAsB,YAAtB,CAAoC,SAApC,CAA+C,GAA/C,CAAoD,MAApD,CAA4D,cAA5D,CAA4E,YAA5E,CAA0F,YAA1F,CAAwG,SAAxG,CAAmH,KAAnH,EACH,CALD,EAMA,OACH,CACD,MAAQ,qBAAqB,MAArB,CAA6B,SAA7B,CAAwC,cAAxC,CAAR,CACA,YAAY,MAAM,EAAlB,CAAsB,MAAtB,CAA8B,SAA9B,CAAyC,GAAzC,CAA8C,MAA9C,CAAsD,cAAtD,CAAsE,YAAtE,CAAoF,YAApF,CAAkG,SAAlG,CAA6G,KAA7G,EACH,CAdD,CAeA,wBAAwB,MAAM,EAA9B,CAAkC,SAAlC,CAA6C,OAA7C,CAAsD,MAAtD,EACA,YAAY,UAAZ,CAAuB,cAAvB,CAAuC,MAAM,EAA7C,EAEA,WAAW,YAAX,CAAyB,SAAzB,CAAoC,YAApC,CAAkD,SAAU,UAAV,CAAsB,UAAtB,CAAkC,CAChF,GAAI,UAAU,mBAAd,CAAmC,OACnC,QAAQ,UAAR,CAAoB,UAApB,EACH,CAHD,EAIA,MAAM,GAAN,CAAU,UAAV,CAAsB,UAAY,CAC9B,SAAS,aAAa,OAAtB,CAA+B,EAA/B,CAAmC,cAAnC,CAAmD,GAAnD,CAAwD,MAAxD,EACH,CAFD,EAGH,CAtCD,EAuCH,CA/DD,EAgEH,CA1EE,CAAP,CA4EH,CA9PD,EAgQA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,WAAvC,CAAoD,SAAU,aAAV,CAAyB,kBAAzB,CAA6C,oBAA7C,CAAmE,cAAnE,CAAmF,CACnI;AACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,cAAe,WAAW,eAAX,EAAnB,CACI,cAAgB,qBAAqB,aADzC,CAEI,SAAW,eAAe,QAF9B,CAIA,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,aAAa,MAAb,CAAoB,WAApB,CAAiC,SAAU,SAAV,CAAqB,CAClD,GAAI,CAAC,cAAc,SAAd,CAAL,CAA+B,CAC3B;AACA,IAAI,YAAJ,GACA,OACH,CAED,GAAI,eAAgB,qBAAqB,mBAArB,CAAyC,SAAzC,CAApB,CACA,GAAI,SAAS,UAAU,GAAnB,CAAJ,CAA6B,CACzB,cAAgB,cAAc,GAAd,CAAkB,UAAU,GAA5B,CAAhB,CACH,CAED,IAAI,YAAJ,CAAiB,aAAjB,EACA,GAAI,CAAC,MAAM,MAAP,EAAiB,CAAC,MAAM,QAA5B,CAAsC,CAClC,IAAI,SAAJ,CAAc,aAAd,EACH,CACJ,CAhBD,EAiBH,CAlBD,EAmBH,CA9BE,CAAP,CAgCH,CAlCD,EAoCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,OAAvC,CAAgD,SAAU,aAAV,CAAyB,EAAzB,CAA6B,WAA7B,CAA0C,kBAA1C,CAA8D,cAA9D,CAA8E,mBAA9E,CAAmG,iBAAnG,CAAsH,mBAAtH,CAA2I,CACvL,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,CAAC,SAAD,CAAY,SAAZ,CAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,eAAgB,WAAW,CAAX,CAApB,CACI,UAAY,eAAe,SAD/B,CAEI,SAAW,eAAe,QAF9B,CAGI,aAAe,cAAc,eAAd,EAHnB,CAII,MAAQ,aAAa,KAJzB,CAKI,WAAa,oBAAoB,UALrC,CAMI,eAAiB,kBAAkB,cANvC,CAOI,eAAiB,oBAAoB,cAPzC,CAQI,WAAa,oBAAoB,UARrC,CAUA,cAAc,MAAd,GAAuB,IAAvB,CAA4B,SAAU,GAAV,CAAe,CACvC,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,MAAM,EAArC,CAAf,CACI,SADJ,CAGA;AACA,GAAI,UAAU,WAAW,CAAX,CAAV,CAAJ,CAA8B,CAC1B,UAAY,WAAW,CAAX,EAAc,SAA1B,CACH,CAFD,IAEO,CACH,UAAY,QAAS,UAAT,EAAqB,CAC7B,GAAI,UAAW,GAAG,KAAH,EAAf,CACA,SAAS,OAAT,GACA,MAAO,UAAS,OAAhB,CACH,CAJD,CAKH,CAED,GAAI,CAAC,UAAU,KAAV,CAAL,CAAuB,CACnB,OACH,CAED;AACA,GAAI,qBAAsB,CACtB,KAAM,iBADgB,CAEtB,WAAY,CACR,KAAM,WADE,CAFU,CAA1B,CAOA,GAAI,aAAJ,CACA,GAAI,aAAa,YAAb,EAA6B,aAAa,YAAb,CAA0B,KAA3D,CAAkE,CAC9D,aAAe,aAAa,YAAb,CAA0B,KAAzC,CACH,CAFD,IAEO,CACH,aAAe,mBAAf,CACH,CAED,YAAY,IAAZ,CAAiB,SAAU,MAAV,CAAkB,CAE/B,GAAI,cAAe,EAAnB,CACA,YAAY,QAAZ,CAAqB,YAArB,CAAmC,MAAM,EAAzC,EAEA;AACA,GAAI,aAAc,QAAS,YAAT,CAAqB,WAArB,CAAkC,IAAlC,CAAwC,YAAxC,CAAsD,CACpE,GAAI,eAAgB,WAAa,IAAb,CAAoB,KAAxC,CAEA,WAAW,YAAX,CAAyB,aAAzB,CAAwC,YAAxC,CAAsD,SAAU,QAAV,CAAoB,GAApB,CAAyB,UAAzB,CAAqC,CACvF,GAAI,CAAC,UAAU,QAAV,CAAL,CAA0B,CACtB,GAAI,UAAU,IAAI,KAAd,CAAJ,CAA0B,CACtB,IAAK,GAAI,EAAT,GAAc,QAAO,QAArB,CAA+B,CAC3B,GAAI,SAAU,OAAO,QAAP,CAAgB,CAAhB,CAAd,CACA,QAAQ,WAAR,CAAoB,WAApB,EACH,CACJ,CACD,IAAI,WAAJ,CAAgB,WAAhB,EACA,aACA,OACH,CACD,eAAe,WAAf,CAA4B,SAAS,IAArC,CAA2C,QAA3C,EACH,CAbD,EAcH,CAjBD,CAmBA,GAAI,QAAS,QAAS,OAAT,CAAgB,QAAhB,CAA0B,CACnC;AACA,IAAK,GAAI,KAAT,GAAiB,aAAjB,CAA+B,CAC3B,GAAI,CAAC,UAAU,SAAS,IAAT,CAAV,CAAL,CAAgC,CAC5B,IAAI,WAAJ,CAAgB,aAAa,IAAb,CAAhB,EACA,MAAO,cAAa,IAAb,CAAP,CACH,CACJ,CACJ,CARD,CAUA,GAAI,SAAU,QAAS,QAAT,CAAiB,QAAjB,CAA2B,CACrC,OAAO,QAAP,EACA;AACA,IAAK,GAAI,QAAT,GAAoB,SAApB,CAA8B,CAC1B,GAAI,QAAQ,MAAR,CAAe,KAAf,IAA0B,CAA9B,CAAiC,CAC7B,SACH,CACD,GAAI,QAAQ,MAAR,CAAe,GAAf,IAAwB,CAAC,CAA7B,CAAgC,CAC5B,KAAK,KAAL,CAAW,wCAA0C,OAA1C,CAAoD,uDAA/D,EACA,SACH,CAED,GAAI,CAAC,UAAU,aAAa,OAAb,CAAV,CAAL,CAAuC,CACnC,GAAI,UAAW,SAAS,OAAT,CAAf,CACA,GAAI,SAAU,WAAW,OAAX,CAAoB,SAAS,OAAT,CAApB,CAAuC,QAAvC,CAAd,CAEA;AACA,GAAI,UAAU,OAAV,GAAsB,UAAU,SAAS,OAAnB,CAA1B,CAAuD,CACnD,QAAQ,SAAR,CAAkB,SAAS,OAA3B,CAAoC,SAAS,YAA7C,EACH,CAED;AACA,GAAI,eAAe,WAAf,CAA2B,QAA3B,IAAyC,UAAU,SAAS,KAAnB,CAAzC,EAAsE,UAAU,SAAS,KAAT,CAAe,OAAzB,CAA1E,CAA6G,CACzG,QAAQ,SAAR,CAAkB,SAAS,KAAT,CAAe,OAAjC,CAA0C,SAAS,KAAT,CAAe,OAAzD,EACH,CAED;AACA,GAAI,UAAU,QAAV,GAAuB,UAAU,SAAS,KAAnB,CAA3B,CAAsD,CAElD,GAAI,CAAC,SAAS,SAAS,KAAlB,CAAL,CAA+B,CAC3B,KAAK,KAAL,CAAW,oDAAX,EACA,SACH,CACD,GAAI,CAAC,UAAU,MAAV,CAAL,CAAwB,CACpB,KAAK,KAAL,CAAW,gHAAX,EACA,SACH,CAED,GAAI,CAAC,UAAU,OAAO,QAAjB,CAAD,EAA+B,CAAC,UAAU,OAAO,QAAP,CAAgB,SAAS,KAAzB,CAAV,CAApC,CAAgF,CAC5E,KAAK,KAAL,CAAW,2EAAX,EACA,SACH,CACD,GAAI,YAAa,OAAO,QAAP,CAAgB,SAAS,KAAzB,CAAjB,CACA,GAAI,EAAE,qBAAsB,GAAE,UAAxB,EAAsC,qBAAsB,GAAE,YAAhE,CAAJ,CAAmF,CAC/E,KAAK,KAAL,CAAW,yGAAX,EACA,SACH,CAED;AACA,aAAa,OAAb,EAAwB,OAAxB,CACA;AACA,WAAW,QAAX,CAAoB,OAApB,EAEA,GAAI,aAAa,UAAb,CAAwB,IAAxB,GAAiC,IAArC,CAA2C,CACvC,YAAY,OAAZ,CAAqB,OAArB,CAA8B,aAAa,UAA3C,EACH,CAFD,IAEO,CACH,eAAe,OAAf,CAAwB,SAAS,IAAjC,CAAuC,QAAvC,EACH,CACJ,CA/BD,IA+BO,IAAI,UAAU,OAAV,CAAJ,CAAwB,CAC3B;AACA,aAAa,OAAb,EAAwB,OAAxB,CACA,IAAI,QAAJ,CAAa,OAAb,EAEA,GAAI,aAAa,UAAb,CAAwB,IAAxB,GAAiC,IAArC,CAA2C,CACvC,YAAY,OAAZ,CAAqB,OAArB,CAA8B,aAAa,UAA3C,EACH,CAFD,IAEO,CACH,eAAe,OAAf,CAAwB,SAAS,IAAjC,CAAuC,QAAvC,EACH,CACJ,CAED,eAAe,MAAM,EAArB,CAAyB,OAAzB,CAAkC,OAAlC,CAA2C,QAA3C,CAAqD,YAArD,EACH,CACJ,CACJ,CAzED,CA2EA,WAAW,YAAX,CAAyB,OAAzB,CAAkC,YAAlC,CAAgD,SAAU,QAAV,CAAoB,CAChE,QAAQ,QAAR,EACH,CAFD,EAGH,CAjHD,EAkHH,CApJD,EAqJH,CAtKE,CAAP,CAwKH,CA1KD,EA4KA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,OAAvC,CAAgD,SAAU,aAAV,CAAyB,WAAzB,CAAsC,kBAAtC,CAA0D,cAA1D,CAA0E,CACtH,GAAI,MAAO,aAAX,CACA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,SAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,WAAY,eAAe,SAA/B,CACI,aAAe,WAAW,eAAX,EADnB,CAEI,MAAQ,aAAa,KAFzB,CAIA,GAAI,CAAC,UAAU,KAAV,CAAD,EAAqB,CAAC,UAAU,MAAM,GAAhB,CAA1B,CAAgD,CAC5C,KAAK,IAAL,CAAU,+EAAV,EACA,OACH,CAED,WAAW,MAAX,GAAoB,IAApB,CAAyB,SAAU,GAAV,CAAe,CACpC,GAAI,UAAW,mBAAmB,WAAnB,CAA+B,MAAM,EAArC,CAAf,CACA,GAAI,aAAJ,CACA,aAAa,MAAb,CAAoB,OAApB,CAA6B,SAAU,KAAV,CAAiB,CAC1C,GAAI,kBAAmB,SAAS,gBAAhC,CACA,GAAI,cAAe,SAAS,SAA5B,CAEA;AACA,GAAI,CAAC,UAAU,MAAM,GAAhB,CAAD,EAAyB,UAAU,YAAV,CAA7B,CAAsD,CAClD,IAAI,WAAJ,CAAgB,YAAhB,EACA,OACH,CAED;AACA,GAAI,CAAC,UAAU,YAAV,CAAL,CAA8B,CAC1B,GAAI,UAAU,MAAM,OAAhB,CAAJ,CAA8B,CAC1B,QAAQ,IAAR,CAAa,MAAM,OAAnB,CAA4B,gBAA5B,EACH,CAED,GAAI,UAAU,MAAM,GAAhB,CAAJ,CAA0B,CACtB,aAAe,MAAM,GAArB,CACH,CAED,aAAe,EAAE,SAAF,CAAY,YAAZ,CAA0B,gBAA1B,CAAf,CACA,aAAa,KAAb,CAAmB,GAAnB,EACA,YAAY,QAAZ,CAAqB,YAArB,CAAmC,MAAM,EAAzC,EACA,OACH,CAED;AACA,GAAI,UAAU,MAAM,GAAhB,GAAwB,UAAU,MAAM,OAAhB,CAAxB,EAAoD,CAAC,QAAQ,MAAR,CAAe,MAAM,OAArB,CAA8B,gBAA9B,CAAzD,CAA0G,CACtG,IAAI,WAAJ,CAAgB,YAAhB,EACA,iBAAmB,SAAS,gBAA5B,CACA,QAAQ,IAAR,CAAa,MAAM,OAAnB,CAA4B,gBAA5B,EACA,aAAe,MAAM,GAArB,CACA,aAAe,EAAE,SAAF,CAAY,YAAZ,CAA0B,gBAA1B,CAAf,CACA,aAAa,KAAb,CAAmB,GAAnB,EACA,YAAY,QAAZ,CAAqB,YAArB,CAAmC,MAAM,EAAzC,EACA,OACH,CAED;AACA,GAAI,UAAU,MAAM,GAAhB,CAAJ,CAA0B,CACtB,aAAa,MAAb,CAAoB,MAAM,GAA1B,EACH,CACJ,CA1CD,CA0CG,IA1CH,EA2CH,CA9CD,EA+CH,CA/DE,CAAP,CAiEH,CAnED,EAqEA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,SAA7B,CAAuC,cAAvC,CAAuD,CAAC,MAAD,CAAS,YAAT,CAAuB,IAAvB,CAA6B,aAA7B,CAA4C,gBAA5C,CAA8D,SAAU,aAAV,CAAyB,UAAzB,CAAqC,EAArC,CAAyC,WAAzC,CAAsD,cAAtD,CAAsE,CAEvL,GAAI,WAAY,eAAe,SAA/B,CACI,YAAc,eAAe,WADjC,CAEI,SAAW,eAAe,QAF9B,CAGI,KAAO,aAHX,CAKA,MAAO,CACH,SAAU,GADP,CAEH,MAAO,KAFJ,CAGH,QAAS,KAHN,CAIH,QAAS,CAAC,SAAD,CAJN,CAMH,KAAM,QAAS,KAAT,CAAc,KAAd,CAAqB,OAArB,CAA8B,KAA9B,CAAqC,UAArC,CAAiD,CACnD,GAAI,eAAgB,WAAW,CAAX,CAApB,CACI,aAAe,cAAc,eAAd,EADnB,CAGA,GAAI,mBAAoB,QAAS,kBAAT,CAA2B,IAA3B,CAAiC,CACrD,MAAO,QAAS,OAAT,EAAoB,OAAS,iBAA7B,EAAkD,OAAS,WAA3D,EAA0E,OAAS,IAA1F,CACH,CAFD,CAIA,GAAI,UAAU,aAAa,YAAvB,GAAwC,SAAS,aAAa,YAAtB,CAA5C,CAAiF,CAC7E,QAAQ,OAAR,CAAgB,CAAC,SAAD,CAAY,SAAZ,CAAuB,OAAvB,CAAhB,CAAiD,SAAU,IAAV,CAAgB,CAC7D,GAAI,UAAU,aAAa,YAAb,CAA0B,IAA1B,CAAV,CAAJ,CAAgD,CAC5C,GAAI,CAAC,kBAAkB,aAAa,YAAb,CAA0B,IAA1B,EAAgC,IAAlD,CAAL,CAA8D,CAC1D,KAAK,KAAL,CAAW,YAAc,gBAAd,CAAiC,IAAjC,CAAwC,4BAAnD,EACH,CACD,GAAI,UAAU,aAAa,YAAb,CAA0B,IAA1B,EAAgC,UAA1C,CAAJ,CAA2D,CACvD,GAAI,CAAC,kBAAkB,aAAa,YAAb,CAA0B,IAA1B,EAAgC,UAAhC,CAA2C,IAA7D,CAAL,CAAyE,CACrE,KAAK,KAAL,CAAW,YAAc,gBAAd,CAAiC,IAAjC,CAAwC,uCAAnD,EACH,CACJ,CAJD,IAIO,CACH,KAAK,KAAL,CAAW,YAAc,gBAAd,CAAiC,IAAjC,CAAwC,mCAAnD,EACH,CACJ,CACJ,CAbD,EAcH,CACJ,CA9BE,CAAP,CAgCH,CAvCsD,CAAvD,EAyCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,6BAArC,CAAoE,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,CACzH,GAAI,WAAY,eAAe,SAA/B,CACI,UAAY,eAAe,SAD/B,CAEI,SAAW,eAAe,QAF9B,CAGI,QAAU,eAAe,OAH7B,CAII,YAAc,eAAe,WAJjC,CAKI,KAAO,aALX,CAOA,GAAI,cAAe,QAAS,aAAT,CAAsB,iBAAtB,CAAyC,WAAzC,CAAsD,CACrE,KAAK,iBAAL,CAAyB,iBAAzB,CACA,KAAK,KAAL,CAAW,6CAA+C,WAA/C,CAA6D,qBAA7D,CAAqF,iBAAhG,EACA;AACA,KAAK,WAAL,CAAmB,WAAnB,CACH,CALD,CAOA,aAAa,SAAb,CAAuB,kBAAvB,CAA4C,UAAY,CACpD,MAAO,EAAP,CACH,CAFD,CAIA;;;;;;;;;;;;;;;;OAiBA,aAAa,SAAb,CAAuB,gBAAvB,CAA0C,SAAU,UAAV,CAAsB,SAAtB,CAAiC,KAAjC,CAAwC,YAAxC,CAAsD,OAAtD,CAA+D,IAA/D,CAAqE,KAArE,CAA4E,SAA5E,CAAuF,KAAvF,CAA8F,CACpI,GAAI,OAAQ,IAAZ,CAEA,WAAa,YAAc,EAA3B,CACA,GAAI,UAAJ,CAAgB,WAAa,IAAM,UAAnB,CAEhB,MAAO,UAAU,CAAV,CAAa,CAChB,GAAI,eAAgB,MAAM,iBAAN,CAA0B,UAA1B,CAAuC,GAAvC,CAA6C,SAAjE,CACA,KAAK,KAAL,CAAW,aAAX,EACA,MAAM,IAAN,CAAW,YAAX,CAAyB,aAAzB,CAAwC,KAAxC,CAA+C,CAA/C,CAAkD,EAAE,MAAF,EAAY,OAA9D,CAAuE,KAAvE,CAA8E,IAA9E,CAAoF,SAApF,CAA+F,KAA/F,EACH,CAJD,CAKH,CAXD,CAaA,aAAa,SAAb,CAAuB,IAAvB,CAA8B,SAAU,KAAV,CAAiB,aAAjB,CAAgC,KAAhC,CAAuC,KAAvC,CAA8C,OAA9C,CAAuD,KAAvD,CAA8D,SAA9D,CAAyE,SAAzE,CAAoF,KAApF,CAA2F,CACrH;AACA,UAAU,KAAV,CAAiB,UAAY,CACzB,GAAI,QAAS,CACT,aAAc,KADL,CAET,cAAe,OAFN,CAGT,UAAW,SAHF,CAIT,MAAO,KAJE,CAAb,CAMA,GAAI,UAAU,SAAV,CAAJ,CAA0B,QAAQ,MAAR,CAAe,MAAf,CAAuB,CAAE,UAAW,SAAb,CAAvB,EAE1B,GAAI,QAAU,MAAd,CAAsB,CAClB,MAAM,KAAN,CAAY,aAAZ,CAA2B,MAA3B,EACH,CAFD,IAEO,CACH,WAAW,UAAX,CAAsB,aAAtB,CAAqC,MAArC,EACH,CACJ,CAdD,EAeH,CAjBD,CAmBA,aAAa,SAAb,CAAuB,UAAvB,CAAoC,SAAU,UAAV,CAAsB,OAAtB,CAA+B,IAA/B,CAAqC,KAArC,CAA4C,YAA5C,CAA0D,SAA1D,CAAqE,KAArE,CAA4E,CAC5G,GAAI,QAAS,EAAb,CACA,GAAI,OAAQ,MAAZ,CACA,GAAI,OAAQ,IAAZ,CAEA,GAAI,CAAC,UAAU,aAAa,cAAvB,CAAL,CAA6C,CACzC;AACA,OAAS,KAAK,kBAAL,EAAT,CACH,CAHD,IAGO,IAAI,CAAC,SAAS,aAAa,cAAtB,CAAL,CAA4C,CAC/C;AACA,KAAK,KAAL,CAAW,YAAc,qDAAzB,EACH,CAHM,IAGA,CACH;AACA,GAAI,CAAC,UAAU,aAAa,cAAb,CAA4B,MAAM,WAAlC,CAAV,CAAL,CAAgE,CAC5D;AACA,OAAS,KAAK,kBAAL,EAAT,CACH,CAHD,IAGO,IAAI,CAAC,SAAS,aAAa,cAAb,CAA4B,MAAM,WAAlC,CAAT,CAAL,CAA+D,CAClE;AACA,KAAK,IAAL,CAAU,YAAc,kBAAd,CAAmC,CAAC,MAAM,WAAP,CAAnC,CAAyD,sCAAnE,EACH,CAHM,IAGA,CACH;AACA;AACA,GAAI,UAAU,aAAa,cAAb,CAA4B,KAAK,WAAjC,EAA8C,KAAxD,CAAJ,CAAoE,CAChE;AACA,GAAI,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,KAA/C,GAAyD,MAAzD,EAAmE,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,KAA/C,GAAyD,WAAhI,CAA6I,KAAK,IAAL,CAAU,YAAc,+DAAxB,EAChJ,CACD;AACA,GAAI,cAAe,KAAnB,CACI,cAAgB,KADpB,CAEA,GAAI,UAAU,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,MAAzD,GAAoE,QAAQ,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,MAAvD,CAAxE,CAAwI,aAAe,IAAf,CACxI,GAAI,UAAU,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,OAAzD,GAAqE,QAAQ,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,OAAvD,CAAzE,CAA0I,cAAgB,IAAhB,CAE1I,GAAI,cAAgB,aAApB,CAAmC,CAC/B;AACA,KAAK,IAAL,CAAU,YAAc,oDAAxB,EACH,CAHD,IAGO,IAAI,CAAC,YAAD,EAAiB,CAAC,aAAtB,CAAqC,CACxC;AACA,KAAK,IAAL,CAAU,YAAc,+BAAxB,EACH,CAHM,IAGA,CACH;AACA,GAAI,YAAJ,CAAkB,CACd;AACA,aAAa,cAAb,CAA4B,KAAK,WAAjC,EAA8C,MAA9C,CAAqD,OAArD,CAA6D,SAAU,SAAV,CAAqB,CAC9E;AACA,GAAI,OAAO,OAAP,CAAe,SAAf,IAA8B,CAAC,CAAnC,CAAsC,CAClC;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,qBAApD,EACH,CAHD,IAGO,CACH;AACA,GAAI,MAAM,kBAAN,GAA2B,OAA3B,CAAmC,SAAnC,IAAkD,CAAC,CAAvD,CAA0D,CACtD;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,iBAApD,EACH,CAHD,IAGO,CACH;AACA,OAAO,IAAP,CAAY,SAAZ,EACH,CACJ,CACJ,CAfD,EAgBH,CAlBD,IAkBO,CACH;AACA,OAAS,KAAK,kBAAL,EAAT,CACA,aAAa,cAAb,CAA4B,MAAM,WAAlC,EAA+C,OAA/C,CAAuD,OAAvD,CAA+D,SAAU,SAAV,CAAqB,CAChF,GAAI,OAAQ,OAAO,OAAP,CAAe,SAAf,CAAZ,CACA,GAAI,QAAU,CAAC,CAAf,CAAkB,CACd;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,8CAApD,EACH,CAHD,IAGO,CACH,OAAO,MAAP,CAAc,KAAd,CAAqB,CAArB,EACH,CACJ,CARD,EASH,CACJ,CACJ,CACJ,CAED,OAAO,OAAP,CAAe,SAAU,SAAV,CAAqB,CAChC,QAAQ,EAAR,CAAW,SAAX,CAAsB,MAAM,gBAAN,CAAuB,UAAvB,CAAmC,SAAnC,CAA8C,KAA9C,CAAqD,YAArD,CAAmE,OAAnE,CAA4E,IAA5E,CAAkF,KAAlF,CAAyF,SAAzF,CAAoG,KAApG,CAAtB,EACH,CAFD,EAGA,MAAO,MAAP,CACH,CA/ED,CAiFA,MAAO,aAAP,CACH,CAtJD,EAsJG,OAtJH,CAsJW,sBAtJX,CAsJmC,SAAU,2BAAV,CAAuC,CACtE,MAAO,IAAI,4BAAJ,EAAP,CACH,CAxJD,EA0JA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,sBAArC,CAA6D,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,2BAAzD,CAAsF,WAAtF,CAAmG,CAC5J,GAAI,WAAY,eAAe,SAA/B,CACI,aAAe,2BADnB,CAEA;AAEA,GAAI,eAAgB,QAAS,cAAT,EAAyB,CACzC,aAAa,IAAb,CAAkB,IAAlB,CAAwB,yBAAxB,CAAmD,SAAnD,EACH,CAFD,CAIA,cAAc,SAAd,CAA0B,GAAI,aAAJ,EAA1B,CAEA,cAAc,SAAd,CAAwB,gBAAxB,CAA2C,SAAU,UAAV,CAAsB,SAAtB,CAAiC,KAAjC,CAAwC,YAAxC,CAAsD,OAAtD,CAA+D,IAA/D,CAAqE,KAArE,CAA4E,SAA5E,CAAuF,KAAvF,CAA8F,CACrI,GAAI,MAAO,aAAa,SAAb,CAAuB,gBAAvB,CAAwC,IAAxC,CAA6C,IAA7C,CAAmD,UAAnD,CAA+D,SAA/D,CAA0E,KAA1E,CAAiF,YAAjF,CAA+F,OAA/F,CAAwG,IAAxG,CAA8G,KAA9G,CAAqH,SAArH,CAAX,CACI,MAAQ,IADZ,CAGA,MAAO,UAAU,CAAV,CAAa,CAChB,GAAI,YAAc,UAAlB,CAA8B,CAC1B,GAAI,MAAM,oBAAV,CAAgC,CAC5B,YAAY,UAAZ,CAAuB,MAAM,KAA7B,EAAoC,IAApC,CAAyC,SAAU,cAAV,CAA0B,CAC/D;AACA,GAAI,MAAO,UAAY,eAAe,SAAf,CAAZ,CAAwC,cAAnD,CACA,KAAK,UAAL,CAAgB,EAAE,MAAlB,EACH,CAJD,EAKH,CACD,UAAU,YAAV,CAAwB,UAAY,CAChC,WAAW,UAAX,CAAsB,MAAM,iBAAN,CAA0B,WAAhD,CAA6D,CAA7D,EACH,CAFD,EAGH,CACD,KAAK,CAAL,EAAS;AACZ,CAdD,CAeH,CAnBD,CAqBA,cAAc,SAAd,CAAwB,kBAAxB,CAA6C,UAAY,CACrD,MAAO,CAAC,OAAD,CAAU,UAAV,CAAsB,WAAtB,CAAmC,UAAnC,CAAP,CACH,CAFD,CAIA,MAAO,IAAI,cAAJ,EAAP,CACH,CArCD,EAuCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,oBAArC,CAA2D,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,2BAAzD,CAAsF,CAC7I,GAAI,SAAU,cAAd,CACI,aAAe,2BADnB,CAEA;AAEA,GAAI,aAAc,QAAS,YAAT,EAAuB,CACrC,aAAa,IAAb,CAAkB,IAAlB,CAAwB,uBAAxB,CAAiD,SAAjD,EACH,CAFD,CAGA,YAAY,SAAZ,CAAwB,GAAI,aAAJ,EAAxB,CAEA,YAAY,SAAZ,CAAsB,gBAAtB,CAAyC,SAAU,UAAV,CAAsB,SAAtB,CAAiC,KAAjC,CAAwC,YAAxC,CAAsD,OAAtD,CAA+D,IAA/D,CAAqE,KAArE,CAA4E,SAA5E,CAAuF,CAC5H,GAAI,YAAa,KAAK,OAAL,CAAa,UAAb,CAAyB,EAAzB,CAAjB,CACA,MAAO,cAAa,SAAb,CAAuB,gBAAvB,CAAwC,IAAxC,CAA6C,IAA7C,CAAmD,UAAnD,CAA+D,SAA/D,CAA0E,KAA1E,CAAiF,YAAjF,CAA+F,OAA/F,CAAwG,UAAxG,CAAoH,KAApH,CAA2H,SAA3H,CAAP,CACH,CAHD,CAKA,YAAY,SAAZ,CAAsB,kBAAtB,CAA2C,UAAY,CACnD,MAAO,CAAC,OAAD,CAAU,UAAV,CAAsB,WAAtB,CAAmC,WAAnC,CAAgD,UAAhD,CAA4D,aAA5D,CAAP,CACH,CAFD,CAIA,YAAY,SAAZ,CAAsB,SAAtB,CAAkC,SAAU,UAAV,CAAsB,SAAtB,CAAiC,KAAjC,CAAwC,YAAxC,CAAsD,OAAtD,CAA+D,IAA/D,CAAqE,KAArE,CAA4E,SAA5E,CAAuF,CACrH,GAAI,OAAQ,IAAZ,CACA,GAAI,aAAc,KAAK,kBAAL,EAAlB,CACA,GAAI,gBAAiB,QAAQ,kBAAR,CAA2B,WAAa,IAAxC,CAArB,CACA,YAAY,OAAZ,CAAoB,SAAU,SAAV,CAAqB,CACrC,QAAQ,KAAR,CAAc,EAAd,CAAiB,SAAjB,CAA4B,MAAM,gBAAN,CAAuB,UAAvB,CAAmC,SAAnC,CAA8C,KAA9C,CAAqD,YAArD,CAAmE,QAAQ,KAA3E,CAAkF,cAAlF,CAAkG,KAAlG,CAAyG,SAAzG,CAA5B,EACH,CAFD,EAGH,CAPD,CASA,YAAY,SAAZ,CAAsB,UAAtB,CAAmC,SAAU,UAAV,CAAsB,OAAtB,CAA+B,IAA/B,CAAqC,KAArC,CAA4C,YAA5C,CAA0D,SAA1D,CAAqE,CAAE,CAA1G,CAEA,MAAO,IAAI,YAAJ,EAAP,CACH,CA/BD,EAiCA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,kBAArC,CAAyD,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,oBAAzD,CAA+E,gBAA/E,CAAiG,CACtJ,GAAI,WAAY,eAAe,SAA/B,CACI,KAAO,qBAAqB,IADhC,CAGA,GAAI,wBAAyB,QAAS,uBAAT,EAAkC,CAC3D,MAAO,CAAC,OAAD,CAAU,UAAV,CAAsB,WAAtB,CAAmC,SAAnC,CAA8C,WAA9C,CAA2D,UAA3D,CAAuE,WAAvE,CAAoF,aAApF,CAAmG,OAAnG,CAA4G,MAA5G,CAAoH,UAApH,CAAgI,MAAhI,CAAwI,QAAxI,CAAkJ,WAAlJ,CAA+J,WAA/J,CAA4K,MAA5K,CAAoL,SAApL,CAA+L,WAA/L,CAA4M,MAA5M,CAAoN,SAApN,CAA+N,WAA/N,CAA4O,UAA5O,CAAwP,SAAxP,CAAmQ,kBAAnQ,CAAuR,QAAvR,CAAiS,cAAjS,CAAiT,UAAjT,CAA6T,aAA7T,CAA4U,iBAA5U,CAA+V,YAA/V,CAA6W,eAA7W,CAA8X,eAA9X,CAA+Y,eAA/Y,CAAga,WAAha,CAA6a,YAA7a,CAA2b,cAA3b,CAA2c,aAA3c,CAA0d,cAA1d,CAA0e,gBAA1e,CAA4f,eAA5f,CAA6gB,gBAA7gB,CAA+hB,eAA/hB,CAAgjB,kBAAhjB,CAAokB,iBAApkB,CAAP,CACH,CAFD,CAIA,GAAI,sBAAuB,QAAS,qBAAT,CAA8B,KAA9B,CAAqC,SAArC,CAAgD,KAAhD,CAAuD,UAAvD,CAAmE,CAC1F,GAAI,UAAJ,CAAgB,CACZ,WAAa,WAAa,GAA1B,CACH,CACD,MAAO,UAAU,CAAV,CAAa,CAChB;AACA,GAAI,eAAgB,uBAAyB,UAAzB,CAAsC,SAA1D,CACA,cAAc,KAAd,CAAoB,aAApB,EACA;AACA,KAAK,KAAL,CAAY,aAAZ,CAA2B,KAA3B,CAAkC,CAAlC,CAAqC,EAAE,MAAvC,CAA+C,KAA/C,EACH,CAND,CAOH,CAXD,CAaA,GAAI,8BAA+B,QAAS,6BAAT,CAAsC,KAAtC,CAA6C,CAC5E,MAAM,UAAN,CAAiB,eAAjB,EACH,CAFD,CAIA,GAAI,6BAA8B,QAAS,4BAAT,CAAqC,KAArC,CAA4C,GAA5C,CAAiD,KAAjD,CAAwD,MAAxD,CAAgE,CAC9F,GAAI,CAAC,UAAU,MAAM,aAAhB,CAAL,CAAqC,CACjC,OACH,CACD,GAAI,QAAS,IAAI,SAAJ,EAAb,CACA,GAAI,eAAgB,OAAO,GAAP,CAAW,OAAX,CAAmB,CAAnB,EAAwB,GAAxB,CAA8B,OAAO,GAAP,CAAW,OAAX,CAAmB,CAAnB,CAA9B,CAAsD,GAAtD,CAA4D,IAAI,OAAJ,EAAhF,CACA,GAAI,CAAC,UAAU,OAAO,CAAjB,CAAD,EAAwB,OAAO,CAAP,GAAa,aAAzC,CAAwD,CACpD;AACA,MAAM,KAAN,CAAY,eAAZ,CAA6B,aAA7B,EACH,CACJ,CAVD,CAYA,GAAI,YAAa,QAAS,WAAT,CAAoB,GAApB,CAAyB,KAAzB,CAAgC,SAAhC,CAA2C,WAA3C,CAAwD,KAAxD,CAA+D,KAA/D,CAAsE,CACnF,iBAAiB,IAAjB,CAAsB,SAAtB,CAAiC,SAAU,SAAV,CAAqB,CAClD,GAAI,SAAU,EAAd,CACA,QAAQ,WAAR,EAAuB,SAAvB,CACA,GAAI,CAAC,KAAL,CAAY,CACR,MAAQ,IAAI,UAAJ,CAAe,EAAf,EAAqB,EAA7B,CACH,CAED,IAAI,EAAJ,CAAO,SAAP,CAAkB,qBAAqB,KAArB,CAA4B,SAA5B,CAAuC,KAAvC,CAA8C,KAA9C,CAAlB,CAAwE,OAAxE,EACH,CARD,EASH,CAVD,CAYA,MAAO,CACH,sBAAuB,sBADpB,CAEH,oBAAqB,oBAFlB,CAGH,4BAA6B,4BAH1B,CAIH,2BAA4B,2BAJzB,CAKH,UAAW,UALR,CAAP,CAOH,CAxDD,EA0DA,aAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,qBAArC,CAA4D,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,2BAAzD,CAAsF,kBAAtF,CAA0G,CAClK,GAAI,WAAY,eAAe,SAA/B,CACI,UAAY,eAAe,SAD/B,CAEI,QAAU,cAFd,CAGI,QAAU,kBAHd,CAII,aAAe,2BAJnB,CAKI,KAAO,aALX,CAOA,GAAI,cAAe,QAAS,aAAT,EAAwB,CACvC,aAAa,IAAb,CAAkB,IAAlB,CAAwB,wBAAxB,CAAkD,SAAlD,EACH,CAFD,CAIA,aAAa,SAAb,CAAyB,GAAI,aAAJ,EAAzB,CAEA,aAAa,SAAb,CAAuB,gBAAvB,CAA0C,SAAU,UAAV,CAAsB,SAAtB,CAAiC,KAAjC,CAAwC,YAAxC,CAAsD,OAAtD,CAA+D,IAA/D,CAAqE,KAArE,CAA4E,SAA5E,CAAuF,CAC7H,GAAI,QAAS,aAAa,SAAb,CAAuB,gBAAvB,CAAwC,IAAxC,CAA6C,IAA7C,CAAmD,UAAnD,CAA+D,SAA/D,CAA0E,KAA1E,CAAiF,YAAjF,CAA+F,OAA/F,CAAwG,IAAxG,CAA8G,KAA9G,CAAqH,SAArH,CAAb,CACA,MAAO,UAAU,CAAV,CAAa,CAChB;AACA,GAAI,YAAc,OAAlB,CAA2B,CACvB,UAAU,YAAV,CAAwB,UAAY,CAChC,WAAW,UAAX,CAAsB,8BAAtB,CAAsD,IAAtD,EACH,CAFD,EAGH,CAJD,IAIO,IAAI,YAAc,SAAlB,CAA6B,CAChC,UAAU,YAAV,CAAwB,UAAY,CAChC,MAAM,GAAN,CAAY,QAAQ,SAAR,GAAoB,GAAhC,CACA,MAAM,GAAN,CAAY,QAAQ,SAAR,GAAoB,GAAhC,CACH,CAHD,EAIA,GAAI,MAAM,OAAN,EAAiB,MAAM,KAAN,GAAgB,IAArC,CAA2C,CACvC,QAAQ,SAAR,GACH,CACJ,CACD,OAAO,CAAP,EAAW;AACd,CAhBD,CAiBH,CAnBD,CAqBA,aAAa,SAAb,CAAuB,kBAAvB,CAA4C,UAAY,CACpD,MAAO,CAAC,OAAD,CAAU,UAAV,CAAsB,WAAtB,CAAmC,WAAnC,CAAgD,UAAhD,CAA4D,aAA5D,CAA2E,WAA3E,CAAwF,MAAxF,CAAgG,SAAhG,CAA2G,MAA3G,CAAmH,QAAnH,CAA6H,WAA7H,CAA0I,YAA1I,CAAwJ,UAAxJ,CAAoK,YAApK,CAAkL,WAAlL,CAA+L,aAA/L,CAA8M,YAA9M,CAAP,CACH,CAFD,CAIA,aAAa,SAAb,CAAuB,UAAvB,CAAoC,SAAU,UAAV,CAAsB,OAAtB,CAA+B,IAA/B,CAAqC,KAArC,CAA4C,YAA5C,CAA0D,SAA1D,CAAqE,CACrG,GAAI,OAAQ,aAAa,SAAb,CAAuB,UAAvB,CAAkC,IAAlC,CAAuC,IAAvC,CAA6C,UAA7C,CAAyD,OAAzD,CAAkE,IAAlE,CAAwE,KAAxE,CAA+E,YAA/E,CAA6F,SAA7F,CAAZ,CAEA,GAAI,QAAQ,WAAR,CAAoB,QAApB,IAAkC,UAAU,QAAQ,KAAlB,CAAtC,CAAgE,CAC5D,QAAQ,SAAR,CAAkB,UAAlB,CAA8B,IAA9B,CAAoC,KAApC,CAA2C,YAA3C,CAAyD,OAAzD,CAAkE,KAAlE,CAAyE,SAAzE,EACH,CACJ,CAND,CAQA,MAAO,IAAI,aAAJ,EAAP,CACH,CAhDD,EAkDA,aAEA,GAAI,SAAU,MAAO,OAAP,GAAkB,UAAlB,EAAgC,SAAO,OAAO,QAAd,IAA2B,QAA3D,CAAsE,SAAU,GAAV,CAAe,CAAE,aAAc,IAAd,oCAAc,GAAd,EAAoB,CAA3G,CAA8G,SAAU,GAAV,CAAe,CAAE,MAAO,MAAO,MAAO,OAAP,GAAkB,UAAzB,EAAuC,IAAI,WAAJ,GAAoB,MAA3D,CAAoE,QAApE,OAAsF,IAAtF,oCAAsF,GAAtF,CAAP,CAAmG,CAAhP,CAEA,QAAQ,MAAR,CAAe,YAAf,EAA6B,OAA7B,CAAqC,mBAArC,CAA0D,SAAU,UAAV,CAAsB,EAAtB,CAA0B,aAA1B,CAAyC,cAAzC,CAAyD,kBAAzD,CAA6E,oBAA7E,CAAmG,CACzJ,GAAI,WAAY,eAAe,SAA/B,CACI,SAAW,eAAe,QAD9B,CAEI,QAAU,cAFd,CAGI,YAAc,eAAe,WAHjC,CAII,QAAU,kBAJd,CAKI,KAAO,qBAAqB,IALhC,CAMI,KAAO,aANX,CAQA;;MAIA,GAAI,uBAAwB,QAAS,sBAAT,CAA+B,UAA/B,CAA2C,SAA3C,CAAsD,KAAtD,CAA6D,YAA7D,CAA2E,OAA3E,CAAoF,IAApF,CAA0F,KAA1F,CAAiG,SAAjG,CAA4G,CACpI,WAAa,YAAc,EAA3B,CAEA,GAAI,UAAJ,CAAgB,WAAa,IAAM,UAAnB,CAEhB,MAAO,UAAU,CAAV,CAAa,CAChB,GAAI,eAAgB,uBAAyB,UAAzB,CAAsC,GAAtC,CAA4C,SAAhE,CACA,KAAK,KAAL,CAAW,aAAX,EACA,KAAK,YAAL,CAAmB,aAAnB,CAAkC,KAAlC,CAAyC,CAAzC,CAA4C,EAAE,MAAF,EAAY,OAAxD,CAAiE,KAAjE,CAAwE,IAAxE,CAA8E,SAA9E,EACH,CAJD,CAKH,CAVD,CAYA,GAAI,iBAAkB,QAAS,gBAAT,CAAyB,UAAzB,CAAqC,OAArC,CAA8C,IAA9C,CAAoD,KAApD,CAA2D,YAA3D,CAAyE,CAC3F,GAAI,YAAa,EAAjB,CACI,CADJ,CAEI,SAFJ,CAGI,MAAQ,WAHZ,CAKA,GAAI,CAAC,UAAU,aAAa,cAAvB,CAAL,CAA6C,CACzC;AACA,WAAa,yBAAb,CACH,CAHD,IAGO,IAAI,CAAC,SAAS,aAAa,cAAtB,CAAL,CAA4C,CAC/C;AACA,KAAK,KAAL,CAAW,YAAc,qDAAzB,EACH,CAHM,IAGA,CACH;AACA,GAAI,CAAC,UAAU,aAAa,cAAb,CAA4B,IAAtC,CAAL,CAAkD,CAC9C;AACA,WAAa,yBAAb,CACH,CAHD,IAGO,IAAI,SAAS,aAAa,cAAb,CAA4B,KAArC,CAAJ,CAAiD,CACpD;AACA,KAAK,IAAL,CAAU,YAAc,0DAAxB,EACH,CAHM,IAGA,CACH;AACA;AACA,GAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,KAAjC,GAA2C,SAA3C,EAAwD,aAAa,cAAb,CAA4B,IAA5B,CAAiC,KAAjC,GAA2C,IAAvG,CAA6G,CACzG;AACA,GAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,KAAjC,GAA2C,MAA3C,EAAqD,aAAa,cAAb,CAA4B,IAA5B,CAAiC,KAAjC,GAA2C,WAApG,CAAiH,CAC7G;AACA,KAAK,IAAL,CAAU,YAAc,+DAAxB,EACH,CAHD,IAGO,IAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,KAAjC,GAA2C,MAA/C,CAAuD,CAC1D,MAAQ,MAAR,CACH,CACJ,CACD;AACA,GAAI,kBAAmB,KAAvB,CACI,kBAAoB,KADxB,CAEA,GAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,MAAjC,GAA4C,SAA5C,EAAyD,aAAa,cAAb,CAA4B,IAA5B,CAAiC,MAAjC,GAA4C,IAAzG,CAA+G,CAC3G,GAAI,QAAQ,aAAa,cAAb,CAA4B,IAA5B,CAAiC,MAAzC,IAAqD,QAAzD,CAAmE,CAC/D,iBAAmB,IAAnB,CACH,CACJ,CACD,GAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,OAAjC,GAA6C,SAA7C,EAA0D,aAAa,cAAb,CAA4B,IAA5B,CAAiC,OAAjC,GAA6C,IAA3G,CAAiH,CAC7G,GAAI,QAAQ,aAAa,cAAb,CAA4B,IAA5B,CAAiC,OAAzC,IAAsD,QAA1D,CAAoE,CAChE,kBAAoB,IAApB,CACH,CACJ,CACD,GAAI,kBAAoB,iBAAxB,CAA2C,CACvC;AACA,KAAK,IAAL,CAAU,YAAc,oDAAxB,EACH,CAHD,IAGO,IAAI,CAAC,gBAAD,EAAqB,CAAC,iBAA1B,CAA6C,CAChD;AACA,KAAK,IAAL,CAAU,YAAc,+BAAxB,EACH,CAHM,IAGA,CACH;AACA,GAAI,gBAAJ,CAAsB,CAClB;AACA,IAAK,EAAI,CAAT,CAAY,EAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,MAAjC,CAAwC,MAAxD,CAAgE,GAAhE,CAAqE,CACjE,UAAY,aAAa,cAAb,CAA4B,IAA5B,CAAiC,MAAjC,CAAwC,CAAxC,CAAZ,CACA;AACA,GAAI,WAAW,OAAX,CAAmB,SAAnB,IAAkC,CAAC,CAAvC,CAA0C,CACtC;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,qBAApD,EACH,CAHD,IAGO,CACH;AACA,GAAI,0BAA0B,OAA1B,CAAkC,SAAlC,IAAiD,CAAC,CAAtD,CAAyD,CACrD;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,iBAApD,EACH,CAHD,IAGO,CACH;AACA,WAAW,IAAX,CAAgB,SAAhB,EACH,CACJ,CACJ,CACJ,CAnBD,IAmBO,CACH;AACA,WAAa,yBAAb,CACA,IAAK,EAAI,CAAT,CAAY,EAAI,aAAa,cAAb,CAA4B,IAA5B,CAAiC,OAAjC,CAAyC,MAAzD,CAAiE,GAAjE,CAAsE,CAClE,UAAY,aAAa,cAAb,CAA4B,IAA5B,CAAiC,OAAjC,CAAyC,CAAzC,CAAZ,CACA,GAAI,OAAQ,WAAW,OAAX,CAAmB,SAAnB,CAAZ,CACA,GAAI,QAAU,CAAC,CAAf,CAAkB,CACd;AACA,KAAK,IAAL,CAAU,YAAc,aAAd,CAA8B,SAA9B,CAA0C,8CAApD,EACH,CAHD,IAGO,CACH,WAAW,MAAX,CAAkB,KAAlB,CAAyB,CAAzB,EACH,CACJ,CACJ,CACJ,CACJ,CACJ,CAED,IAAK,EAAI,CAAT,CAAY,EAAI,WAAW,MAA3B,CAAmC,GAAnC,CAAwC,CACpC,UAAY,WAAW,CAAX,CAAZ,CACA,QAAQ,EAAR,CAAW,SAAX,CAAsB,sBAAsB,UAAtB,CAAkC,SAAlC,CAA6C,KAA7C,CAAoD,YAApD,CAAkE,UAAlE,CAA8E,IAA9E,CAAtB,EACH,CAED,GAAI,QAAQ,WAAR,CAAoB,QAApB,IAAkC,UAAU,QAAQ,KAAlB,CAAtC,CAAgE,CAC5D,QAAQ,SAAR,CAAkB,UAAlB,CAA8B,IAA9B,CAAoC,KAApC,CAA2C,YAA3C,CAAyD,OAAzD,CAAkE,KAAlE,EACH,CACJ,CAlGD,CAoGA,GAAI,yBAA0B,QAAS,wBAAT,EAAmC,CAC7D,MAAO,CAAC,OAAD,CAAU,UAAV,CAAsB,WAAtB,CAAmC,WAAnC,CAAgD,UAAhD,CAA4D,aAA5D,CAA2E,KAA3E,CAAkF,QAAlF,CAA4F,WAA5F,CAAyG,YAAzG,CAAP,CACH,CAFD,CAIA,MAAO,CACH,uBAAwB,uBADrB,CAEH,eAAgB,eAFb,CAAP,CAIH,CArID,EAuIC,CA/jKA,EA+jKC,OA/jKD,CAAD,CAgkKA","file":"ui-leaflet_dev_mapped-compiled.js","sourcesContent":["/*!\n*  ui-leaflet 2.0.0 2016-10-04\n*  ui-leaflet - An AngularJS directive to easily interact with Leaflet maps\n*  git: https://github.com/angular-ui/ui-leaflet\n*/\n(function(angular){\n'use strict';\n'use strict';\n\nangular.module('ui-leaflet', ['nemLogging']).directive('leaflet', function ($q, leafletData, leafletMapDefaults, leafletHelpers, leafletMapEvents) {\n    return {\n        restrict: \"EA\",\n        replace: true,\n        scope: {\n            center: '=',\n            lfCenter: '=',\n            defaults: '=',\n            maxbounds: '=',\n            bounds: '=',\n            markers: '=',\n            legend: '=',\n            geojson: '=',\n            paths: '=',\n            tiles: '=',\n            layers: '=',\n            controls: '=',\n            decorations: '=',\n            eventBroadcast: '=',\n            watchOptions: '=',\n            id: '@'\n        },\n        transclude: true,\n        template: '<div class=\"angular-leaflet-map\"><div ng-transclude></div></div>',\n        controller: function controller($scope) {\n            this._leafletMap = $q.defer();\n            this.getMap = function () {\n                return this._leafletMap.promise;\n            };\n\n            this.getLeafletScope = function () {\n                return $scope;\n            };\n        },\n\n        link: function link(scope, element, attrs, ctrl) {\n            var isDefined = leafletHelpers.isDefined,\n                defaults = leafletMapDefaults.setDefaults(scope.defaults, attrs.id),\n                mapEvents = leafletMapEvents.getAvailableMapEvents(),\n                addEvents = leafletMapEvents.addEvents;\n\n            scope.mapId = attrs.id;\n            leafletData.setDirectiveControls({}, attrs.id);\n\n            // Set width and height utility functions\n            function updateWidth() {\n                if (isNaN(attrs.width)) {\n                    element.css('width', attrs.width);\n                } else {\n                    element.css('width', attrs.width + 'px');\n                }\n            }\n\n            function updateHeight() {\n                if (isNaN(attrs.height)) {\n                    element.css('height', attrs.height);\n                } else {\n                    element.css('height', attrs.height + 'px');\n                }\n            }\n\n            // Create the Leaflet Map Object with the options\n            var map = new L.Map(element[0], leafletMapDefaults.getMapCreationDefaults(attrs.id));\n            ctrl._leafletMap.resolve(map);\n\n            // If the width attribute defined update css\n            // Then watch if bound property changes and update css\n            if (isDefined(attrs.width)) {\n                updateWidth();\n\n                scope.$watch(function () {\n                    return element[0].getAttribute('width');\n                }, function () {\n                    updateWidth();\n                    map.invalidateSize();\n                });\n            }\n\n            // If the height attribute defined update css\n            // Then watch if bound property changes and update css\n            if (isDefined(attrs.height)) {\n                updateHeight();\n\n                scope.$watch(function () {\n                    return element[0].getAttribute('height');\n                }, function () {\n                    updateHeight();\n                    map.invalidateSize();\n                });\n            }\n\n            if (!isDefined(attrs.center) && !isDefined(attrs.lfCenter)) {\n                map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n            }\n\n            // If no layers nor tiles defined, set the default tileLayer\n            if (!isDefined(attrs.tiles) && !isDefined(attrs.layers)) {\n                var tileLayerObj = L.tileLayer(defaults.tileLayer, defaults.tileLayerOptions);\n                tileLayerObj.addTo(map);\n                leafletData.setTiles(tileLayerObj, attrs.id);\n            }\n\n            // Set zoom control configuration\n            if (isDefined(map.zoomControl) && isDefined(defaults.zoomControlPosition)) {\n                map.zoomControl.setPosition(defaults.zoomControlPosition);\n            }\n\n            if (isDefined(map.zoomControl) && defaults.zoomControl === false) {\n                map.zoomControl.removeFrom(map);\n            }\n\n            if (isDefined(map.zoomsliderControl) && isDefined(defaults.zoomsliderControl) && defaults.zoomsliderControl === false) {\n                map.zoomsliderControl.removeFrom(map);\n            }\n\n            // if no event-broadcast attribute, all events are broadcasted\n            if (!isDefined(attrs.eventBroadcast)) {\n                var logic = \"broadcast\";\n                addEvents(map, attrs.id, mapEvents, \"eventName\", scope, logic);\n            }\n\n            // Resolve the map object to the promises\n            map.whenReady(function () {\n                leafletData.setMap(map, attrs.id);\n            });\n\n            scope.$on('$destroy', function () {\n                leafletMapDefaults.reset();\n                map.remove();\n                leafletData.unresolveMap(attrs.id);\n            });\n\n            //Handle request to invalidate the map size\n            //Up scope using $scope.$emit('invalidateSize')\n            //Down scope using $scope.$broadcast('invalidateSize')\n            scope.$on('invalidateSize', function () {\n                map.invalidateSize();\n            });\n        }\n    };\n});\n\n'use strict';\n\n(function () {\n    angular.module('ui-leaflet').factory('eventManager', [function () {\n        var EventManager = function EventManager() {\n            this.listeners = {};\n        };\n\n        EventManager.prototype = {\n            addEventListener: function addEventListener(type, callback, scope) {\n                var args = [];\n                var numOfArgs = arguments.length;\n                for (var i = 0; i < numOfArgs; i++) {\n                    args.push(arguments[i]);\n                }\n                args = args.length > 3 ? args.splice(3, args.length - 1) : [];\n                if (typeof this.listeners[type] !== \"undefined\") {\n                    this.listeners[type].push({ scope: scope, callback: callback, args: args });\n                } else {\n                    this.listeners[type] = [{ scope: scope, callback: callback, args: args }];\n                }\n            },\n            removeEventListener: function removeEventListener(type, callback, scope) {\n                if (typeof this.listeners[type] !== \"undefined\") {\n                    var numOfCallbacks = this.listeners[type].length;\n                    var newArray = [];\n                    for (var i = 0; i < numOfCallbacks; i++) {\n                        var listener = this.listeners[type][i];\n                        if (listener.scope === scope && listener.callback === callback) {} else {\n                            newArray.push(listener);\n                        }\n                    }\n                    this.listeners[type] = newArray;\n                }\n            },\n            hasEventListener: function hasEventListener(type, callback, scope) {\n                if (typeof this.listeners[type] !== \"undefined\") {\n                    var numOfCallbacks = this.listeners[type].length;\n                    if (callback === undefined && scope === undefined) {\n                        return numOfCallbacks > 0;\n                    }\n                    for (var i = 0; i < numOfCallbacks; i++) {\n                        var listener = this.listeners[type][i];\n                        if ((scope ? listener.scope === scope : true) && listener.callback === callback) {\n                            return true;\n                        }\n                    }\n                }\n                return false;\n            },\n            dispatch: function dispatch(type, target) {\n                var numOfListeners = 0;\n                var event = {\n                    type: type,\n                    target: target\n                };\n                var args = [];\n                var numOfArgs = arguments.length;\n                for (var i = 0; i < numOfArgs; i++) {\n                    args.push(arguments[i]);\n                }\n                args = args.length > 2 ? args.splice(2, args.length - 1) : [];\n                args = [event].concat(args);\n                if (typeof this.listeners[type] !== \"undefined\") {\n                    var numOfCallbacks = this.listeners[type].length;\n                    for (var x = 0; x < numOfCallbacks; x++) {\n                        var listener = this.listeners[type][x];\n                        if (listener && listener.callback) {\n                            var concatArgs = args.concat(listener.args);\n                            listener.callback.apply(listener.scope, concatArgs);\n                            numOfListeners += 1;\n                        }\n                    }\n                }\n            },\n            getEvents: function getEvents() {\n                var str = \"\";\n                for (var type in this.listeners) {\n                    var numOfCallbacks = this.listeners[type].length;\n                    for (var i = 0; i < numOfCallbacks; i++) {\n                        var listener = this.listeners[type][i];\n                        str += listener.scope && listener.scope.className ? listener.scope.className : \"anonymous\";\n                        str += \" listen for '\" + type + \"'\\n\";\n                    }\n                }\n                return str;\n            }\n        };\n        return EventManager;\n    }]).service('eventManager', function (EventManager) {\n        return new EventManager();\n    });\n})();\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletBoundsHelpers', function (leafletLogger, leafletHelpers) {\n\n    var isArray = leafletHelpers.isArray,\n        isNumber = leafletHelpers.isNumber,\n        isFunction = leafletHelpers.isFunction,\n        isDefined = leafletHelpers.isDefined,\n        $log = leafletLogger;\n\n    function _isValidBounds(bounds) {\n        return angular.isDefined(bounds) && angular.isDefined(bounds.southWest) && angular.isDefined(bounds.northEast) && angular.isNumber(bounds.southWest.lat) && angular.isNumber(bounds.southWest.lng) && angular.isNumber(bounds.northEast.lat) && angular.isNumber(bounds.northEast.lng);\n    }\n\n    return {\n        createLeafletBounds: function createLeafletBounds(bounds) {\n            if (_isValidBounds(bounds)) {\n                return L.latLngBounds([bounds.southWest.lat, bounds.southWest.lng], [bounds.northEast.lat, bounds.northEast.lng]);\n            }\n        },\n\n        isValidBounds: _isValidBounds,\n\n        createBoundsFromArray: function createBoundsFromArray(boundsArray) {\n            if (!(isArray(boundsArray) && boundsArray.length === 2 && isArray(boundsArray[0]) && isArray(boundsArray[1]) && boundsArray[0].length === 2 && boundsArray[1].length === 2 && isNumber(boundsArray[0][0]) && isNumber(boundsArray[0][1]) && isNumber(boundsArray[1][0]) && isNumber(boundsArray[1][1]))) {\n                $log.error(\"[AngularJS - Leaflet] The bounds array is not valid.\");\n                return;\n            }\n\n            return {\n                northEast: {\n                    lat: boundsArray[0][0],\n                    lng: boundsArray[0][1]\n                },\n                southWest: {\n                    lat: boundsArray[1][0],\n                    lng: boundsArray[1][1]\n                }\n            };\n        },\n\n        createBoundsFromLeaflet: function createBoundsFromLeaflet(lfBounds) {\n            if (!(isDefined(lfBounds) && isFunction(lfBounds.getNorthEast) && isFunction(lfBounds.getSouthWest))) {\n                $log.error(\"[AngularJS - Leaflet] The leaflet bounds is not valid object.\");\n                return;\n            }\n\n            var northEast = lfBounds.getNorthEast(),\n                southWest = lfBounds.getSouthWest();\n\n            return {\n                northEast: {\n                    lat: northEast.lat,\n                    lng: northEast.lng\n                },\n                southWest: {\n                    lat: southWest.lat,\n                    lng: southWest.lng\n                }\n            };\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletControlHelpers', function ($rootScope, leafletLogger, leafletHelpers, leafletLayerHelpers, leafletMapDefaults) {\n    var isDefined = leafletHelpers.isDefined,\n        isObject = leafletHelpers.isObject,\n        createLayer = leafletLayerHelpers.createLayer,\n        _controls = {},\n        errorHeader = leafletHelpers.errorHeader + ' [Controls] ',\n        $log = leafletLogger;\n\n    var _controlLayersMustBeVisible = function _controlLayersMustBeVisible(baselayers, overlays, mapId) {\n        var defaults = leafletMapDefaults.getDefaults(mapId);\n        if (!defaults.controls.layers.visible) {\n            return false;\n        }\n\n        var atLeastOneControlItemMustBeShown = false;\n\n        if (isObject(baselayers)) {\n            Object.keys(baselayers).forEach(function (key) {\n                var layer = baselayers[key];\n                if (!isDefined(layer.layerOptions) || layer.layerOptions.showOnSelector !== false) {\n                    atLeastOneControlItemMustBeShown = true;\n                }\n            });\n        }\n\n        if (isObject(overlays)) {\n            Object.keys(overlays).forEach(function (key) {\n                var layer = overlays[key];\n                if (!isDefined(layer.layerParams) || layer.layerParams.showOnSelector !== false) {\n                    atLeastOneControlItemMustBeShown = true;\n                }\n            });\n        }\n\n        return atLeastOneControlItemMustBeShown;\n    };\n\n    var _createLayersControl = function _createLayersControl(mapId) {\n        var defaults = leafletMapDefaults.getDefaults(mapId);\n        var controlOptions = {\n            collapsed: defaults.controls.layers.collapsed,\n            position: defaults.controls.layers.position,\n            autoZIndex: false\n        };\n\n        angular.extend(controlOptions, defaults.controls.layers.options);\n\n        var control;\n        if (defaults.controls.layers && isDefined(defaults.controls.layers.control)) {\n            control = defaults.controls.layers.control.apply(this, [[], [], controlOptions]);\n        } else {\n            control = new L.control.layers([], [], controlOptions);\n        }\n\n        return control;\n    };\n\n    var controlTypes = {\n        draw: {\n            isPluginLoaded: function isPluginLoaded() {\n                if (!angular.isDefined(L.Control.Draw)) {\n                    $log.error(errorHeader + ' Draw plugin is not loaded.');\n                    return false;\n                }\n                return true;\n            },\n            checkValidParams: function checkValidParams() /* params */{\n                return true;\n            },\n            createControl: function createControl(params) {\n                return new L.Control.Draw(params);\n            }\n        },\n        scale: {\n            isPluginLoaded: function isPluginLoaded() {\n                return true;\n            },\n            checkValidParams: function checkValidParams() /* params */{\n                return true;\n            },\n            createControl: function createControl(params) {\n                return new L.control.scale(params);\n            }\n        },\n        fullscreen: {\n            isPluginLoaded: function isPluginLoaded() {\n                if (!angular.isDefined(L.Control.Fullscreen)) {\n                    $log.error(errorHeader + ' Fullscreen plugin is not loaded.');\n                    return false;\n                }\n                return true;\n            },\n            checkValidParams: function checkValidParams() /* params */{\n                return true;\n            },\n            createControl: function createControl(params) {\n                return new L.Control.Fullscreen(params);\n            }\n        },\n        search: {\n            isPluginLoaded: function isPluginLoaded() {\n                if (!angular.isDefined(L.Control.Search)) {\n                    $log.error(errorHeader + ' Search plugin is not loaded.');\n                    return false;\n                }\n                return true;\n            },\n            checkValidParams: function checkValidParams() /* params */{\n                return true;\n            },\n            createControl: function createControl(params) {\n                return new L.Control.Search(params);\n            }\n        },\n        custom: {},\n        minimap: {\n            isPluginLoaded: function isPluginLoaded() {\n                if (!angular.isDefined(L.Control.MiniMap)) {\n                    $log.error(errorHeader + ' Minimap plugin is not loaded.');\n                    return false;\n                }\n\n                return true;\n            },\n            checkValidParams: function checkValidParams(params) {\n                if (!isDefined(params.layer)) {\n                    $log.warn(errorHeader + ' minimap \"layer\" option should be defined.');\n                    return false;\n                }\n                return true;\n            },\n            createControl: function createControl(params) {\n                var layer = createLayer(params.layer);\n\n                if (!isDefined(layer)) {\n                    $log.warn(errorHeader + ' minimap control \"layer\" could not be created.');\n                    return;\n                }\n\n                return new L.Control.MiniMap(layer, params);\n            }\n        }\n    };\n\n    return {\n        layersControlMustBeVisible: _controlLayersMustBeVisible,\n\n        isValidControlType: function isValidControlType(type) {\n            return Object.keys(controlTypes).indexOf(type) !== -1;\n        },\n\n        createControl: function createControl(type, params) {\n            if (!controlTypes[type].checkValidParams(params)) {\n                return;\n            }\n\n            return controlTypes[type].createControl(params);\n        },\n\n        updateLayersControl: function updateLayersControl(map, mapId, loaded, baselayers, overlays, leafletLayers) {\n            var i;\n            var _layersControl = _controls[mapId];\n            var mustBeLoaded = _controlLayersMustBeVisible(baselayers, overlays, mapId);\n\n            if (isDefined(_layersControl) && loaded) {\n                for (i in leafletLayers.baselayers) {\n                    _layersControl.removeLayer(leafletLayers.baselayers[i]);\n                }\n                for (i in leafletLayers.overlays) {\n                    _layersControl.removeLayer(leafletLayers.overlays[i]);\n                }\n                map.removeControl(_layersControl);\n                delete _controls[mapId];\n            }\n\n            if (mustBeLoaded) {\n                _layersControl = _createLayersControl(mapId);\n                _controls[mapId] = _layersControl;\n                for (i in baselayers) {\n                    var hideOnSelector = isDefined(baselayers[i].layerOptions) && baselayers[i].layerOptions.showOnSelector === false;\n                    if (!hideOnSelector && isDefined(leafletLayers.baselayers[i])) {\n                        _layersControl.addBaseLayer(leafletLayers.baselayers[i], baselayers[i].name);\n                    }\n                }\n                for (i in overlays) {\n                    var hideOverlayOnSelector = isDefined(overlays[i].layerParams) && overlays[i].layerParams.showOnSelector === false;\n                    if (!hideOverlayOnSelector && isDefined(leafletLayers.overlays[i])) {\n                        _layersControl.addOverlay(leafletLayers.overlays[i], overlays[i].name);\n                    }\n                }\n\n                map.addControl(_layersControl);\n            }\n            return mustBeLoaded;\n        },\n\n        destroyMapLayersControl: function destroyMapLayersControl(mapId) {\n            delete _controls[mapId];\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletData', function (leafletLogger, $q, leafletHelpers) {\n    var getDefer = leafletHelpers.getDefer,\n        getUnresolvedDefer = leafletHelpers.getUnresolvedDefer,\n        setResolvedDefer = leafletHelpers.setResolvedDefer;\n    // $log = leafletLogger;\n\n    var _private = {};\n    var self = this;\n\n    var upperFirst = function upperFirst(string) {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    };\n\n    var _privateItems = ['map', 'tiles', 'layers', 'paths', 'markers', 'geoJSON', 'UTFGrid', //odd ball on naming convention keeping to not break\n    'decorations', 'directiveControls'];\n\n    //init\n    _privateItems.forEach(function (itemName) {\n        _private[itemName] = {};\n    });\n\n    this.unresolveMap = function (scopeId) {\n        var id = leafletHelpers.obtainEffectiveMapId(_private.map, scopeId);\n        _privateItems.forEach(function (itemName) {\n            _private[itemName][id] = undefined;\n        });\n    };\n\n    //int repetitive stuff (get and sets)\n    _privateItems.forEach(function (itemName) {\n        var name = upperFirst(itemName);\n        self['set' + name] = function (lObject, scopeId) {\n            var defer = getUnresolvedDefer(_private[itemName], scopeId);\n            defer.resolve(lObject);\n            setResolvedDefer(_private[itemName], scopeId);\n        };\n\n        self['get' + name] = function (scopeId) {\n            var defer = getDefer(_private[itemName], scopeId);\n            return defer.promise;\n        };\n    });\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletDirectiveControlsHelpers', function (leafletLogger, leafletData, leafletHelpers) {\n    var _isDefined = leafletHelpers.isDefined,\n        _isString = leafletHelpers.isString,\n        _isObject = leafletHelpers.isObject,\n        _mainErrorHeader = leafletHelpers.errorHeader,\n        $log = leafletLogger;\n\n    var _errorHeader = _mainErrorHeader + '[leafletDirectiveControlsHelpers';\n\n    var _extend = function _extend(id, thingToAddName, createFn, cleanFn) {\n        var _fnHeader = _errorHeader + '.extend] ';\n        var extender = {};\n        if (!_isDefined(thingToAddName)) {\n            $log.error(_fnHeader + 'thingToAddName cannot be undefined');\n            return;\n        }\n\n        if (_isString(thingToAddName) && _isDefined(createFn) && _isDefined(cleanFn)) {\n            extender[thingToAddName] = {\n                create: createFn,\n                clean: cleanFn\n            };\n        } else if (_isObject(thingToAddName) && !_isDefined(createFn) && !_isDefined(cleanFn)) {\n            extender = thingToAddName;\n        } else {\n            $log.error(_fnHeader + 'incorrect arguments');\n            return;\n        }\n\n        //add external control to create / destroy markers without a watch\n        leafletData.getDirectiveControls().then(function (controls) {\n            angular.extend(controls, extender);\n            leafletData.setDirectiveControls(controls, id);\n        });\n    };\n\n    return {\n        extend: _extend\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletGeoJsonHelpers', function (leafletHelpers, leafletIterators) {\n    var lHlp = leafletHelpers,\n        lIt = leafletIterators;\n    var Point = function Point(lat, lng) {\n        this.lat = lat;\n        this.lng = lng;\n        return this;\n    };\n\n    var _getLat = function _getLat(value) {\n        if (Array.isArray(value) && value.length === 2) {\n            return value[1];\n        } else if (lHlp.isDefined(value.type) && value.type === 'Point') {\n            return +value.coordinates[1];\n        } else {\n            return +value.lat;\n        }\n    };\n\n    var _getLng = function _getLng(value) {\n        if (Array.isArray(value) && value.length === 2) {\n            return value[0];\n        } else if (lHlp.isDefined(value.type) && value.type === 'Point') {\n            return +value.coordinates[0];\n        } else {\n            return +value.lng;\n        }\n    };\n\n    var _validateCoords = function _validateCoords(coords) {\n        if (lHlp.isUndefined(coords)) {\n            return false;\n        }\n        if (lHlp.isArray(coords)) {\n            if (coords.length === 2 && lHlp.isNumber(coords[0]) && lHlp.isNumber(coords[1])) {\n                return true;\n            }\n        } else if (lHlp.isDefined(coords.type)) {\n            if (coords.type === 'Point' && lHlp.isArray(coords.coordinates) && coords.coordinates.length === 2 && lHlp.isNumber(coords.coordinates[0]) && lHlp.isNumber(coords.coordinates[1])) {\n                return true;\n            }\n        }\n\n        var ret = lIt.all(['lat', 'lng'], function (pos) {\n            return lHlp.isDefined(coords[pos]) && lHlp.isNumber(coords[pos]);\n        });\n        return ret;\n    };\n\n    var _getCoords = function _getCoords(value) {\n        if (!value || !_validateCoords(value)) {\n            return;\n        }\n        var p = null;\n        if (Array.isArray(value) && value.length === 2) {\n            p = new Point(value[1], value[0]);\n        } else if (lHlp.isDefined(value.type) && value.type === 'Point') {\n            p = new Point(value.coordinates[1], value.coordinates[0]);\n        } else {\n            return value;\n        }\n        //note angular.merge is avail in angular 1.4.X we might want to fill it here\n        return angular.extend(value, p); //tap on lat, lng if it doesnt exist\n    };\n\n    return {\n        getLat: _getLat,\n        getLng: _getLng,\n        validateCoords: _validateCoords,\n        getCoords: _getCoords\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletHelpers', function ($q, $log, $timeout) {\n    var _errorHeader = '[ui-leaflet] ';\n    var _copy = angular.copy;\n    var _clone = _copy;\n    /*\n    For parsing paths to a field in an object\n     Example:\n    var obj = {\n        bike:{\n         1: 'hi'\n         2: 'foo'\n        }\n    };\n    _getObjectValue(obj,\"bike.1\") returns 'hi'\n    this is getPath in ui-gmap\n     */\n    var _getObjectValue = function _getObjectValue(object, pathStr) {\n        var obj;\n        if (!object || !angular.isObject(object)) return;\n        //if the key is not a sting then we already have the value\n        if (pathStr === null || !angular.isString(pathStr)) {\n            return pathStr;\n        }\n        obj = object;\n        pathStr.split('.').forEach(function (value) {\n            if (obj) {\n                obj = obj[value];\n            }\n        });\n        return obj;\n    };\n\n    /*\n     Object Array Notation\n     _getObjectArrayPath(\"bike.one.two\")\n     returns:\n     'bike[\"one\"][\"two\"]'\n     */\n    var _getObjectArrayPath = function _getObjectArrayPath(pathStr) {\n        return pathStr.split('.').reduce(function (previous, current) {\n            return previous + '[\"' + current + '\"]';\n        });\n    };\n\n    /* Object Dot Notation\n     _getObjectPath([\"bike\",\"one\",\"two\"])\n     returns:\n     \"bike.one.two\"\n     */\n    var _getObjectDotPath = function _getObjectDotPath(arrayOfStrings) {\n        return arrayOfStrings.reduce(function (previous, current) {\n            return previous + '.' + current;\n        });\n    };\n\n    function _obtainEffectiveMapId(d, mapId) {\n        var id, i;\n        if (!angular.isDefined(mapId)) {\n            if (Object.keys(d).length === 0) {\n                id = \"main\";\n            } else if (Object.keys(d).length >= 1) {\n                for (i in d) {\n                    if (d.hasOwnProperty(i)) {\n                        id = i;\n                    }\n                }\n            } else {\n                $log.error(_errorHeader + \"- You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call\");\n            }\n        } else {\n            id = mapId;\n        }\n\n        return id;\n    }\n\n    function _getUnresolvedDefer(d, mapId) {\n        var id = _obtainEffectiveMapId(d, mapId),\n            defer;\n\n        if (!angular.isDefined(d[id]) || d[id].resolvedDefer === true) {\n            defer = $q.defer();\n            d[id] = {\n                defer: defer,\n                resolvedDefer: false\n            };\n        } else {\n            defer = d[id].defer;\n        }\n\n        return defer;\n    }\n\n    var _isDefined = function _isDefined(value) {\n        return angular.isDefined(value) && value !== null;\n    };\n    var _isUndefined = function _isUndefined(value) {\n        return !_isDefined(value);\n    };\n\n    // BEGIN DIRECT PORT FROM AngularJS code base\n\n    var SPECIAL_CHARS_REGEXP = /([\\:\\-\\_]+(.))/g;\n\n    var MOZ_HACK_REGEXP = /^moz([A-Z])/;\n\n    var PREFIX_REGEXP = /^((?:x|data)[\\:\\-_])/i;\n\n    /**\n    Converts snake_case to camelCase.\n    Also there is special case for Moz prefix starting with upper case letter.\n    @param name Name to normalize\n     */\n\n    var camelCase = function camelCase(name) {\n        return name.replace(SPECIAL_CHARS_REGEXP, function (_, separator, letter, offset) {\n            if (offset) {\n                return letter.toUpperCase();\n            } else {\n                return letter;\n            }\n        }).replace(MOZ_HACK_REGEXP, \"Moz$1\");\n    };\n\n    /**\n        Converts all accepted directives format into proper directive name.\n        @param name Name to normalize\n    */\n\n    var directiveNormalize = function directiveNormalize(name) {\n        return camelCase(name.replace(PREFIX_REGEXP, \"\"));\n    };\n    // END AngularJS port\n\n    var _watchTrapDelayMilliSec = 10;\n\n    var _modelChangeInDirective = function _modelChangeInDirective(trapObj, trapField, cbToExec) {\n        if (!trapObj) throw new Error(_errorHeader + 'trapObj is undefined');\n        if (!trapField) throw new Error(_errorHeader + 'trapField is undefined');\n\n        trapObj[trapField] = true;\n        var ret = cbToExec();\n        $timeout(function () {\n            trapObj[trapField] = false;\n        }, _watchTrapDelayMilliSec);\n        return ret;\n    };\n\n    return {\n        watchTrapDelayMilliSec: _watchTrapDelayMilliSec,\n        modelChangeInDirective: _modelChangeInDirective,\n        camelCase: camelCase,\n        directiveNormalize: directiveNormalize,\n        copy: _copy,\n        clone: _clone,\n        errorHeader: _errorHeader,\n        getObjectValue: _getObjectValue,\n        getObjectArrayPath: _getObjectArrayPath,\n        getObjectDotPath: _getObjectDotPath,\n        defaultTo: function defaultTo(val, _default) {\n            return _isDefined(val) ? val : _default;\n        },\n        //mainly for checking attributes of directives lets keep this minimal (on what we accept)\n        isTruthy: function isTruthy(val) {\n            return val === 'true' || val === true;\n        },\n        //Determine if a reference is {}\n        isEmpty: function isEmpty(value) {\n            return Object.keys(value).length === 0;\n        },\n\n        //Determine if a reference is undefined or {}\n        isUndefinedOrEmpty: function isUndefinedOrEmpty(value) {\n            return angular.isUndefined(value) || value === null || Object.keys(value).length === 0;\n        },\n\n        // Determine if a reference is defined\n        isDefined: _isDefined,\n        isUndefined: _isUndefined,\n        isNumber: angular.isNumber,\n        isString: angular.isString,\n        isArray: angular.isArray,\n        isObject: angular.isObject,\n        isFunction: angular.isFunction,\n        equals: angular.equals,\n\n        isValidCenter: function isValidCenter(center) {\n            return angular.isDefined(center) && angular.isNumber(center.lat) && angular.isNumber(center.lng) && angular.isNumber(center.zoom);\n        },\n\n        isValidPoint: function isValidPoint(point) {\n            if (!angular.isDefined(point)) {\n                return false;\n            }\n            if (angular.isArray(point)) {\n                return point.length === 2 && angular.isNumber(point[0]) && angular.isNumber(point[1]);\n            }\n            return angular.isNumber(point.lat) && angular.isNumber(point.lng);\n        },\n\n        isSameCenterOnMap: function isSameCenterOnMap(centerModel, map) {\n            var mapCenter = map.getCenter();\n            var zoom = map.getZoom();\n            if (centerModel.lat && centerModel.lng && mapCenter.lat.toFixed(4) === centerModel.lat.toFixed(4) && mapCenter.lng.toFixed(4) === centerModel.lng.toFixed(4) && zoom === centerModel.zoom) {\n                return true;\n            }\n            return false;\n        },\n\n        safeApply: function safeApply($scope, fn) {\n            var phase = $scope.$root.$$phase;\n            if (phase === '$apply' || phase === '$digest') {\n                $scope.$eval(fn);\n            } else {\n                $scope.$evalAsync(fn);\n            }\n        },\n\n        obtainEffectiveMapId: _obtainEffectiveMapId,\n\n        getDefer: function getDefer(d, mapId) {\n            var id = _obtainEffectiveMapId(d, mapId),\n                defer;\n            if (!angular.isDefined(d[id]) || d[id].resolvedDefer === false) {\n                defer = _getUnresolvedDefer(d, mapId);\n            } else {\n                defer = d[id].defer;\n            }\n            return defer;\n        },\n\n        getUnresolvedDefer: _getUnresolvedDefer,\n\n        setResolvedDefer: function setResolvedDefer(d, mapId) {\n            var id = _obtainEffectiveMapId(d, mapId);\n            d[id].resolvedDefer = true;\n        },\n\n        rangeIsSupported: function rangeIsSupported() {\n            var testrange = document.createElement('input');\n            testrange.setAttribute('type', 'range');\n            return testrange.type === 'range';\n        },\n\n        FullScreenControlPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.Control.Fullscreen);\n            }\n        },\n\n        MiniMapControlPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.Control.MiniMap);\n            }\n        },\n\n        AwesomeMarkersPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.AwesomeMarkers) && angular.isDefined(L.AwesomeMarkers.Icon);\n            },\n            is: function is(icon) {\n                if (this.isLoaded()) {\n                    return icon instanceof L.AwesomeMarkers.Icon;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(iconA, iconB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(iconA)) {\n                    return angular.equals(iconA, iconB);\n                } else {\n                    return false;\n                }\n            }\n        },\n\n        VectorMarkersPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.VectorMarkers) && angular.isDefined(L.VectorMarkers.Icon);\n            },\n            is: function is(icon) {\n                if (this.isLoaded()) {\n                    return icon instanceof L.VectorMarkers.Icon;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(iconA, iconB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(iconA)) {\n                    return angular.equals(iconA, iconB);\n                } else {\n                    return false;\n                }\n            }\n        },\n\n        DomMarkersPlugin: {\n            isLoaded: function isLoaded() {\n                if (angular.isDefined(L.DomMarkers) && angular.isDefined(L.DomMarkers.Icon)) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            is: function is(icon) {\n                if (this.isLoaded()) {\n                    return icon instanceof L.DomMarkers.Icon;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(iconA, iconB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(iconA)) {\n                    return angular.equals(iconA, iconB);\n                } else {\n                    return false;\n                }\n            }\n        },\n\n        PolylineDecoratorPlugin: {\n            isLoaded: function isLoaded() {\n                if (angular.isDefined(L.PolylineDecorator)) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            is: function is(decoration) {\n                if (this.isLoaded()) {\n                    return decoration instanceof L.PolylineDecorator;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(decorationA, decorationB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(decorationA)) {\n                    return angular.equals(decorationA, decorationB);\n                } else {\n                    return false;\n                }\n            }\n        },\n\n        MakiMarkersPlugin: {\n            isLoaded: function isLoaded() {\n                if (angular.isDefined(L.MakiMarkers) && angular.isDefined(L.MakiMarkers.Icon)) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            is: function is(icon) {\n                if (this.isLoaded()) {\n                    return icon instanceof L.MakiMarkers.Icon;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(iconA, iconB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(iconA)) {\n                    return angular.equals(iconA, iconB);\n                } else {\n                    return false;\n                }\n            }\n        },\n        ExtraMarkersPlugin: {\n            isLoaded: function isLoaded() {\n                if (angular.isDefined(L.ExtraMarkers) && angular.isDefined(L.ExtraMarkers.Icon)) {\n                    return true;\n                } else {\n                    return false;\n                }\n            },\n            is: function is(icon) {\n                if (this.isLoaded()) {\n                    return icon instanceof L.ExtraMarkers.Icon;\n                } else {\n                    return false;\n                }\n            },\n            equal: function equal(iconA, iconB) {\n                if (!this.isLoaded()) {\n                    return false;\n                }\n                if (this.is(iconA)) {\n                    return angular.equals(iconA, iconB);\n                } else {\n                    return false;\n                }\n            }\n        },\n        LabelPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.Label);\n            },\n            is: function is(layer) {\n                if (this.isLoaded()) {\n                    return layer instanceof L.MarkerClusterGroup;\n                } else {\n                    return false;\n                }\n            }\n        },\n        MarkerClusterPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.MarkerClusterGroup);\n            },\n            is: function is(layer) {\n                if (this.isLoaded()) {\n                    return layer instanceof L.MarkerClusterGroup;\n                } else {\n                    return false;\n                }\n            }\n        },\n        GeoJSONPlugin: {\n            isLoaded: function isLoaded() {\n                return angular.isDefined(L.TileLayer.GeoJSON);\n            },\n            is: function is(layer) {\n                if (this.isLoaded()) {\n                    return layer instanceof L.TileLayer.GeoJSON;\n                } else {\n                    return false;\n                }\n            }\n        },\n        CartoDB: {\n            isLoaded: function isLoaded() {\n                return cartodb;\n            },\n            is: function is() /*layer*/{\n                return true;\n                /*\n                if (this.isLoaded()) {\n                    return layer instanceof L.TileLayer.GeoJSON;\n                } else {\n                    return false;\n                }*/\n            }\n        },\n        Leaflet: {\n            DivIcon: {\n                is: function is(icon) {\n                    return icon instanceof L.DivIcon;\n                },\n                equal: function equal(iconA, iconB) {\n                    if (this.is(iconA)) {\n                        return angular.equals(iconA, iconB);\n                    } else {\n                        return false;\n                    }\n                }\n            },\n            Icon: {\n                is: function is(icon) {\n                    return icon instanceof L.Icon;\n                },\n                equal: function equal(iconA, iconB) {\n                    if (this.is(iconA)) {\n                        return angular.equals(iconA, iconB);\n                    } else {\n                        return false;\n                    }\n                }\n            }\n        },\n        /*\n         watchOptions - object to set deep nested watches and turn off watches all together\n         (rely on control / functional updates)\n         watchOptions - Object\n             type: string. //One of ['watch', 'watchCollection', 'watchDeep', null]\n             individual\n                 type: string\n         */\n        //legacy defaults\n        watchOptions: {\n            type: 'watchDeep',\n            individual: {\n                type: 'watchDeep'\n            }\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletIterators', function (leafletLogger, leafletHelpers) {\n\n  var lHlp = leafletHelpers,\n      errorHeader = leafletHelpers.errorHeader + 'leafletIterators: ';\n\n  //BEGIN COPY from underscore\n  var _keys = Object.keys;\n  var _isFunction = lHlp.isFunction;\n  var _isObject = lHlp.isObject;\n  var $log = leafletLogger;\n\n  // Helper for collection methods to determine whether a collection\n  // should be iterated as an array or as an object\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\n\n  var _isArrayLike = function _isArrayLike(collection) {\n    var length = collection !== null && collection.length;\n    return lHlp.isNumber(length) && length >= 0 && length <= MAX_ARRAY_INDEX;\n  };\n\n  // Keep the identity function around for default iteratees.\n  var _identity = function _identity(value) {\n    return value;\n  };\n\n  var _property = function _property(key) {\n    return function (obj) {\n      return obj === null ? void 0 : obj[key];\n    };\n  };\n\n  // Internal function that returns an efficient (for current engines) version\n  // of the passed-in callback, to be repeatedly applied in other Underscore\n  // functions.\n  var optimizeCb = function optimizeCb(func, context, argCount) {\n    if (context === void 0) return func;\n    switch (argCount === null ? 3 : argCount) {\n      case 1:\n        return function (value) {\n          return func.call(context, value);\n        };\n      case 2:\n        return function (value, other) {\n          return func.call(context, value, other);\n        };\n      case 3:\n        return function (value, index, collection) {\n          return func.call(context, value, index, collection);\n        };\n      case 4:\n        return function (accumulator, value, index, collection) {\n          return func.call(context, accumulator, value, index, collection);\n        };\n    }\n    return function () {\n      return func.apply(context, arguments);\n    };\n  };\n\n  // An internal function for creating assigner functions.\n  var createAssigner = function createAssigner(keysFunc, undefinedOnly) {\n    return function (obj) {\n      var length = arguments.length;\n      if (length < 2 || obj === null) return obj;\n      for (var index = 1; index < length; index++) {\n        var source = arguments[index],\n            keys = keysFunc(source),\n            l = keys.length;\n        for (var i = 0; i < l; i++) {\n          var key = keys[i];\n          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];\n        }\n      }\n      return obj;\n    };\n  };\n\n  // Assigns a given object with all the own properties in the passed-in object(s)\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\n  var _extendOwn,\n      _assign = null;\n  _extendOwn = _assign = createAssigner(_keys);\n\n  // Returns whether an object has a given set of `key:value` pairs.\n  var _isMatch = function _isMatch(object, attrs) {\n    var keys = _keys(attrs),\n        length = keys.length;\n    if (object === null) return !length;\n    var obj = Object(object);\n    for (var i = 0; i < length; i++) {\n      var key = keys[i];\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\n    }\n    return true;\n  };\n\n  // Returns a predicate for checking whether an object has a given set of\n  // `key:value` pairs.\n  var _matcher,\n      _matches = null;\n  _matcher = _matches = function _matches(attrs) {\n    attrs = _extendOwn({}, attrs);\n    return function (obj) {\n      return _isMatch(obj, attrs);\n    };\n  };\n\n  // A mostly-internal function to generate callbacks that can be applied\n  // to each element in a collection, returning the desired result — either\n  // identity, an arbitrary callback, a property matcher, or a property accessor.\n  var cb = function cb(value, context, argCount) {\n    if (value === null) return _identity;\n    if (_isFunction(value)) return optimizeCb(value, context, argCount);\n    if (_isObject(value)) return _matcher(value);\n    return _property(value);\n  };\n\n  var _every,\n      _all = null;\n  _every = _all = function _all(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !_isArrayLike(obj) && _keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\n    }\n    return true;\n  };\n\n  //END COPY fron underscore\n\n  var _hasErrors = function _hasErrors(collection, cb, ignoreCollection, cbName) {\n    if (!ignoreCollection) {\n      if (!lHlp.isDefined(collection) || !lHlp.isDefined(cb)) {\n        return true;\n      }\n    }\n    if (!lHlp.isFunction(cb)) {\n      cbName = lHlp.defaultTo(cb, 'cb');\n      $log.error(errorHeader + cbName + ' is not a function');\n      return true;\n    }\n    return false;\n  };\n\n  var _iterate = function _iterate(collection, externalCb, internalCb) {\n    if (_hasErrors(undefined, internalCb, true, 'internalCb')) {\n      return;\n    }\n    if (!_hasErrors(collection, externalCb)) {\n      for (var key in collection) {\n        if (collection.hasOwnProperty(key)) {\n          internalCb(collection[key], key);\n        }\n      }\n    }\n  };\n\n  //see http://jsperf.com/iterators/3\n  //utilizing for in is way faster\n  var _each = function _each(collection, cb) {\n    _iterate(collection, cb, function (val, key) {\n      cb(val, key);\n    });\n  };\n\n  return {\n    each: _each,\n    forEach: _each,\n    every: _every,\n    all: _all\n  };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletLayerHelpers', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletIterators) {\n    var Helpers = leafletHelpers;\n    var isString = leafletHelpers.isString;\n    var isObject = leafletHelpers.isObject;\n    var isArray = leafletHelpers.isArray;\n    var isDefined = leafletHelpers.isDefined;\n    var errorHeader = leafletHelpers.errorHeader;\n    var $it = leafletIterators;\n    var $log = leafletLogger;\n\n    var utfGridCreateLayer = function utfGridCreateLayer(params) {\n        if (!Helpers.UTFGridPlugin.isLoaded()) {\n            $log.error('[AngularJS - Leaflet] The UTFGrid plugin is not loaded.');\n            return;\n        }\n        var utfgrid = new L.UtfGrid(params.url, params.pluginOptions);\n\n        var toSend = {\n            model: params.$parent\n        };\n\n        // TODO Use event manager\n        utfgrid.on('mouseover', function (e) {\n            angular.extend(toSend, {\n                leafletEvent: e,\n                leafletObject: e.target\n            });\n            $rootScope.$broadcast('leafletDirectiveMap.utfgridMouseover', toSend);\n        });\n\n        utfgrid.on('mouseout', function (e) {\n            angular.extend(toSend, {\n                leafletEvent: e,\n                leafletObject: e.target\n            });\n            $rootScope.$broadcast('leafletDirectiveMap.utfgridMouseout', toSend);\n        });\n\n        utfgrid.on('click', function (e) {\n            angular.extend(toSend, {\n                leafletEvent: e,\n                leafletObject: e.target\n            });\n            $rootScope.$broadcast('leafletDirectiveMap.utfgridClick', toSend);\n        });\n\n        utfgrid.on('mousemove', function (e) {\n            angular.extend(toSend, {\n                leafletEvent: e,\n                leafletObject: e.target\n            });\n            $rootScope.$broadcast('leafletDirectiveMap.utfgridMousemove', toSend);\n        });\n\n        return utfgrid;\n    };\n\n    var layerTypes = {\n        xyz: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                return L.tileLayer(params.url, params.options);\n            }\n        },\n        geoJSON: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                if (!Helpers.GeoJSONPlugin.isLoaded()) {\n                    return;\n                }\n                return new L.TileLayer.GeoJSON(params.url, params.pluginOptions, params.options);\n            }\n        },\n        geoJSONShape: {\n            mustHaveUrl: false,\n            createLayer: function createLayer(params) {\n                return new L.GeoJSON(params.data, params.options);\n            }\n        },\n        geoJSONAwesomeMarker: {\n            mustHaveUrl: false,\n            createLayer: function createLayer(params) {\n                return new L.geoJson(params.data, {\n                    pointToLayer: function pointToLayer(feature, latlng) {\n                        return L.marker(latlng, { icon: L.AwesomeMarkers.icon(params.icon) });\n                    }\n                });\n            }\n        },\n        geoJSONVectorMarker: {\n            mustHaveUrl: false,\n            createLayer: function createLayer(params) {\n                return new L.geoJson(params.data, {\n                    pointToLayer: function pointToLayer(feature, latlng) {\n                        return L.marker(latlng, { icon: L.VectorMarkers.icon(params.icon) });\n                    }\n                });\n            }\n        },\n        cartodbTiles: {\n            mustHaveKey: true,\n            createLayer: function createLayer(params) {\n                var url = isDefined(params.url) ? params.url + '/' + params.user : '//' + params.user + '.cartodb.com';\n                url += '/api/v1/map/' + params.key + '/{z}/{x}/{y}.png';\n                return L.tileLayer(url, params.options);\n            }\n        },\n        cartodbUTFGrid: {\n            mustHaveKey: true,\n            mustHaveLayer: true,\n            createLayer: function createLayer(params) {\n                var url = isDefined(params.url) ? params.url + '/' + params.user : '//' + params.user + '.cartodb.com';\n                params.url = url + '/api/v1/map/' + params.key + '/' + params.layer + '/{z}/{x}/{y}.grid.json';\n                return utfGridCreateLayer(params);\n            }\n        },\n        cartodbInteractive: {\n            mustHaveKey: true,\n            mustHaveLayer: true,\n            createLayer: function createLayer(params) {\n                var url = isDefined(params.url) ? params.url + '/' + params.user : '//' + params.user + '.cartodb.com';\n                var tilesURL = url + '/api/v1/map/' + params.key + '/{z}/{x}/{y}.png';\n                var tileLayer = L.tileLayer(tilesURL, params.options);\n                var layers = [tileLayer];\n\n                var addUtfLayer = function addUtfLayer(parent, params, layer) {\n                    var paramsCopy = angular.copy(params);\n                    paramsCopy.url = url + '/api/v1/map/' + paramsCopy.key + '/' + layer + '/{z}/{x}/{y}.grid.json';\n                    parent.push(utfGridCreateLayer(paramsCopy));\n                };\n\n                if (isArray(params.layer)) {\n                    for (var i = 0; i < params.layer.length; i++) {\n                        addUtfLayer(layers, params, params.layer[i]);\n                    }\n                } else {\n                    addUtfLayer(layers, params, params.layer);\n                }\n                return L.layerGroup(layers);\n            }\n        },\n        wms: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                return L.tileLayer.wms(params.url, params.options);\n            }\n        },\n        wmts: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                return L.tileLayer.wmts(params.url, params.options);\n            }\n        },\n        group: {\n            mustHaveUrl: false,\n            createLayer: function createLayer(params) {\n                var lyrs = [];\n                $it.each(params.options.layers, function (l) {\n                    lyrs.push(_createLayer(l));\n                });\n                params.options.loadedDefer = function () {\n                    var defers = [];\n                    if (isDefined(params.options.layers)) {\n                        for (var i = 0; i < params.options.layers.length; i++) {\n                            var d = params.options.layers[i].layerOptions.loadedDefer;\n                            if (isDefined(d)) {\n                                defers.push(d);\n                            }\n                        }\n                    }\n                    return defers;\n                };\n                return L.layerGroup(lyrs);\n            }\n        },\n        featureGroup: {\n            mustHaveUrl: false,\n            createLayer: function createLayer() {\n                return L.featureGroup();\n            }\n        },\n        markercluster: {\n            mustHaveUrl: false,\n            createLayer: function createLayer(params) {\n                if (!Helpers.MarkerClusterPlugin.isLoaded()) {\n                    $log.warn(errorHeader + ' The markercluster plugin is not loaded.');\n                    return;\n                }\n                return new L.MarkerClusterGroup(params.options);\n            }\n        },\n        imageOverlay: {\n            mustHaveUrl: true,\n            mustHaveBounds: true,\n            createLayer: function createLayer(params) {\n                return L.imageOverlay(params.url, params.bounds, params.options);\n            }\n        },\n        iip: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                return L.tileLayer.iip(params.url, params.options);\n            }\n        },\n\n        // This \"custom\" type is used to accept every layer that user want to define himself.\n        // We can wrap these custom layers like heatmap or yandex, but it means a lot of work/code to wrap the world,\n        // so we let user to define their own layer outside the directive,\n        // and pass it on \"createLayer\" result for next processes\n        custom: {\n            createLayer: function createLayer(params) {\n                if (params.layer instanceof L.Class) {\n                    return angular.copy(params.layer);\n                } else {\n                    $log.error('[AngularJS - Leaflet] A custom layer must be a leaflet Class');\n                }\n            }\n        },\n        cartodb: {\n            mustHaveUrl: true,\n            createLayer: function createLayer(params) {\n                return cartodb.createLayer(params.map, params.url);\n            }\n        }\n    };\n\n    function isValidLayerType(layerDefinition) {\n        // Check if the baselayer has a valid type\n        if (!isString(layerDefinition.type)) {\n            $log.error('[AngularJS - Leaflet] A layer must have a valid type defined.');\n            return false;\n        }\n\n        if (Object.keys(layerTypes).indexOf(layerDefinition.type) === -1) {\n            $log.error('[AngularJS - Leaflet] A layer must have a valid type: ' + Object.keys(layerTypes));\n            return false;\n        }\n\n        // Check if the layer must have an URL\n        if (layerTypes[layerDefinition.type].mustHaveUrl && !isString(layerDefinition.url)) {\n            $log.error('[AngularJS - Leaflet] A base layer must have an url');\n            return false;\n        }\n\n        if (layerTypes[layerDefinition.type].mustHaveData && !isDefined(layerDefinition.data)) {\n            $log.error('[AngularJS - Leaflet] The base layer must have a \"data\" array attribute');\n            return false;\n        }\n\n        if (layerTypes[layerDefinition.type].mustHaveLayer && !isDefined(layerDefinition.layer)) {\n            $log.error('[AngularJS - Leaflet] The type of layer ' + layerDefinition.type + ' must have an layer defined');\n            return false;\n        }\n\n        if (layerTypes[layerDefinition.type].mustHaveBounds && !isDefined(layerDefinition.bounds)) {\n            $log.error('[AngularJS - Leaflet] The type of layer ' + layerDefinition.type + ' must have bounds defined');\n            return false;\n        }\n\n        if (layerTypes[layerDefinition.type].mustHaveKey && !isDefined(layerDefinition.key)) {\n            $log.error('[AngularJS - Leaflet] The type of layer ' + layerDefinition.type + ' must have key defined');\n            return false;\n        }\n        return true;\n    }\n\n    function _createLayer(layerDefinition) {\n        if (!isValidLayerType(layerDefinition)) {\n            return;\n        }\n\n        if (!isString(layerDefinition.name)) {\n            $log.error('[AngularJS - Leaflet] A base layer must have a name');\n            return;\n        }\n        if (!isObject(layerDefinition.layerParams)) {\n            layerDefinition.layerParams = {};\n        }\n        if (!isObject(layerDefinition.layerOptions)) {\n            layerDefinition.layerOptions = {};\n        }\n\n        // Mix the layer specific parameters with the general Leaflet options. Although this is an overhead\n        // the definition of a base layers is more 'clean' if the two types of parameters are differentiated\n        for (var attrname in layerDefinition.layerParams) {\n            layerDefinition.layerOptions[attrname] = layerDefinition.layerParams[attrname];\n        }\n\n        var params = {\n            url: layerDefinition.url,\n            data: layerDefinition.data,\n            options: layerDefinition.layerOptions,\n            layer: layerDefinition.layer,\n            icon: layerDefinition.icon,\n            type: layerDefinition.layerType,\n            bounds: layerDefinition.bounds,\n            key: layerDefinition.key,\n            apiKey: layerDefinition.apiKey,\n            pluginOptions: layerDefinition.pluginOptions,\n            user: layerDefinition.user,\n            $parent: layerDefinition\n        };\n\n        //TODO Add $watch to the layer properties\n        return layerTypes[layerDefinition.type].createLayer(params);\n    }\n\n    function safeAddLayer(map, layer) {\n        if (layer && typeof layer.addTo === 'function') {\n            layer.addTo(map);\n        } else {\n            map.addLayer(layer);\n        }\n    }\n\n    function safeRemoveLayer(map, layer, layerOptions) {\n        if (isDefined(layerOptions) && isDefined(layerOptions.loadedDefer)) {\n            if (angular.isFunction(layerOptions.loadedDefer)) {\n                var defers = layerOptions.loadedDefer();\n                $log.debug('Loaded Deferred', defers);\n                var count = defers.length;\n                if (count > 0) {\n                    var resolve = function resolve() {\n                        count--;\n                        if (count === 0) {\n                            map.removeLayer(layer);\n                        }\n                    };\n\n                    for (var i = 0; i < defers.length; i++) {\n                        defers[i].promise.then(resolve);\n                    }\n                } else {\n                    map.removeLayer(layer);\n                }\n            } else {\n                layerOptions.loadedDefer.promise.then(function () {\n                    map.removeLayer(layer);\n                });\n            }\n        } else {\n            map.removeLayer(layer);\n        }\n    }\n\n    var changeOpacityListener = function changeOpacityListener(op) {\n        return function (ly) {\n            if (isDefined(ly.setOpacity)) {\n                ly.setOpacity(op);\n            }\n        };\n    };\n\n    return {\n        createLayer: _createLayer,\n        layerTypes: layerTypes,\n        safeAddLayer: safeAddLayer,\n        safeRemoveLayer: safeRemoveLayer,\n        changeOpacityListener: changeOpacityListener\n    };\n});\n\n'use strict';\n\nangular.module(\"ui-leaflet\").factory('leafletLegendHelpers', function ($http, $q, $log, leafletHelpers) {\n\tvar requestQueue = {},\n\t    isDefined = leafletHelpers.isDefined;\n\n\tvar _execNext = function _execNext(mapId) {\n\t\tvar queue = requestQueue[mapId];\n\t\tvar task = queue[0];\n\t\t$http(task.c).then(function (data) {\n\t\t\tqueue.shift();\n\t\t\ttask.d.resolve(data);\n\t\t\tif (queue.length > 0) {\n\t\t\t\t_execNext(mapId);\n\t\t\t}\n\t\t}, function (err) {\n\t\t\tqueue.shift();\n\t\t\ttask.d.reject(err);\n\t\t\tif (queue.length > 0) {\n\t\t\t\t_execNext(mapId);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar _updateLegend = function _updateLegend(div, legendData, type, url) {\n\t\tdiv.innerHTML = '';\n\t\tif (legendData.error) {\n\t\t\tdiv.innerHTML += '<div class=\"info-title alert alert-danger\">' + legendData.error.message + '</div>';\n\t\t} else {\n\t\t\tif (type === 'arcgis') {\n\t\t\t\tfor (var i = 0; i < legendData.layers.length; i++) {\n\t\t\t\t\tvar layer = legendData.layers[i];\n\t\t\t\t\tdiv.innerHTML += '<div class=\"info-title\" data-layerid=\"' + layer.layerId + '\">' + layer.layerName + '</div>';\n\t\t\t\t\tfor (var j = 0; j < layer.legend.length; j++) {\n\t\t\t\t\t\tvar leg = layer.legend[j];\n\t\t\t\t\t\tdiv.innerHTML += '<div class=\"inline\" data-layerid=\"' + layer.layerId + '\"><img src=\"data:' + leg.contentType + ';base64,' + leg.imageData + '\" /></div>' + '<div class=\"info-label\" data-layerid=\"' + layer.layerId + '\">' + leg.label + '</div>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'image') {\n\t\t\t\tdiv.innerHTML = '<img src=\"' + url + '\"/>';\n\t\t\t}\n\t\t}\n\t};\n\n\tvar _getOnAddLegend = function _getOnAddLegend(legendData, legendClass, type, url) {\n\t\treturn function () /*map*/{\n\t\t\tvar div = L.DomUtil.create('div', legendClass);\n\n\t\t\tif (!L.Browser.touch) {\n\t\t\t\tL.DomEvent.disableClickPropagation(div);\n\t\t\t\tL.DomEvent.on(div, 'mousewheel', L.DomEvent.stopPropagation);\n\t\t\t} else {\n\t\t\t\tL.DomEvent.on(div, 'click', L.DomEvent.stopPropagation);\n\t\t\t}\n\t\t\t_updateLegend(div, legendData, type, url);\n\t\t\treturn div;\n\t\t};\n\t};\n\n\tvar _getOnAddArrayLegend = function _getOnAddArrayLegend(legend, legendClass) {\n\t\treturn function () /*map*/{\n\t\t\tvar div = L.DomUtil.create('div', legendClass);\n\t\t\tfor (var i = 0; i < legend.colors.length; i++) {\n\t\t\t\tdiv.innerHTML += '<div class=\"outline\"><i style=\"background:' + legend.colors[i] + '\"></i></div>' + '<div class=\"info-label\">' + legend.labels[i] + '</div>';\n\t\t\t}\n\t\t\tif (!L.Browser.touch) {\n\t\t\t\tL.DomEvent.disableClickPropagation(div);\n\t\t\t\tL.DomEvent.on(div, 'mousewheel', L.DomEvent.stopPropagation);\n\t\t\t} else {\n\t\t\t\tL.DomEvent.on(div, 'click', L.DomEvent.stopPropagation);\n\t\t\t}\n\t\t\treturn div;\n\t\t};\n\t};\n\n\treturn {\n\t\tgetOnAddLegend: _getOnAddLegend,\n\t\tgetOnAddArrayLegend: _getOnAddArrayLegend,\n\t\tupdateLegend: _updateLegend,\n\t\taddLegendURL: function addLegendURL(mapId, config) {\n\t\t\tvar d = $q.defer();\n\t\t\tif (!isDefined(requestQueue[mapId])) {\n\t\t\t\trequestQueue[mapId] = [];\n\t\t\t}\n\t\t\trequestQueue[mapId].push({ c: config, d: d });\n\t\t\tif (requestQueue[mapId].length === 1) {\n\t\t\t\t_execNext(mapId);\n\t\t\t}\n\t\t\treturn d.promise;\n\t\t}\n\t};\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletMapDefaults', function ($q, leafletHelpers) {\n    function _getDefaults() {\n        return {\n            keyboard: true,\n            dragging: true,\n            worldCopyJump: false,\n            doubleClickZoom: true,\n            scrollWheelZoom: true,\n            tap: true,\n            touchZoom: true,\n            zoomControl: true,\n            zoomsliderControl: false,\n            zoomControlPosition: 'topleft',\n            attributionControl: true,\n            controls: {\n                layers: {\n                    visible: true,\n                    position: 'topright',\n                    collapsed: true\n                }\n            },\n            nominatim: {\n                server: ' http://nominatim.openstreetmap.org/search'\n            },\n            crs: L.CRS.EPSG3857,\n            tileLayer: '//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            tileLayerOptions: {\n                attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            },\n            path: {\n                weight: 10,\n                opacity: 1,\n                color: '#0000ff'\n            },\n            center: {\n                lat: 0,\n                lng: 0,\n                zoom: 1\n            },\n            trackResize: true\n        };\n    }\n\n    var isDefined = leafletHelpers.isDefined,\n        isObject = leafletHelpers.isObject,\n        obtainEffectiveMapId = leafletHelpers.obtainEffectiveMapId,\n        defaults = {};\n\n    // Get the _defaults dictionary, and override the properties defined by the user\n    return {\n        reset: function reset() {\n            defaults = {};\n        },\n        getDefaults: function getDefaults(scopeId) {\n            var mapId = obtainEffectiveMapId(defaults, scopeId);\n            return defaults[mapId];\n        },\n\n        getMapCreationDefaults: function getMapCreationDefaults(scopeId) {\n            var mapId = obtainEffectiveMapId(defaults, scopeId);\n            var d = defaults[mapId];\n\n            var mapDefaults = {\n                maxZoom: d.maxZoom,\n                keyboard: d.keyboard,\n                dragging: d.dragging,\n                zoomControl: d.zoomControl,\n                doubleClickZoom: d.doubleClickZoom,\n                scrollWheelZoom: d.scrollWheelZoom,\n                tap: d.tap,\n                touchZoom: d.touchZoom,\n                attributionControl: d.attributionControl,\n                worldCopyJump: d.worldCopyJump,\n                crs: d.crs,\n                trackResize: d.trackResize\n            };\n\n            if (isDefined(d.minZoom)) {\n                mapDefaults.minZoom = d.minZoom;\n            }\n\n            if (isDefined(d.zoomAnimation)) {\n                mapDefaults.zoomAnimation = d.zoomAnimation;\n            }\n\n            if (isDefined(d.fadeAnimation)) {\n                mapDefaults.fadeAnimation = d.fadeAnimation;\n            }\n\n            if (isDefined(d.markerZoomAnimation)) {\n                mapDefaults.markerZoomAnimation = d.markerZoomAnimation;\n            }\n\n            if (d.map) {\n                for (var option in d.map) {\n                    mapDefaults[option] = d.map[option];\n                }\n            }\n\n            return mapDefaults;\n        },\n\n        setDefaults: function setDefaults(userDefaults, scopeId) {\n            var newDefaults = _getDefaults();\n\n            if (isDefined(userDefaults)) {\n                newDefaults.doubleClickZoom = isDefined(userDefaults.doubleClickZoom) ? userDefaults.doubleClickZoom : newDefaults.doubleClickZoom;\n                newDefaults.scrollWheelZoom = isDefined(userDefaults.scrollWheelZoom) ? userDefaults.scrollWheelZoom : newDefaults.doubleClickZoom;\n                newDefaults.tap = isDefined(userDefaults.tap) ? userDefaults.tap : newDefaults.tap;\n                newDefaults.touchZoom = isDefined(userDefaults.touchZoom) ? userDefaults.touchZoom : newDefaults.doubleClickZoom;\n                newDefaults.zoomControl = isDefined(userDefaults.zoomControl) ? userDefaults.zoomControl : newDefaults.zoomControl;\n                newDefaults.zoomsliderControl = isDefined(userDefaults.zoomsliderControl) ? userDefaults.zoomsliderControl : newDefaults.zoomsliderControl;\n                newDefaults.attributionControl = isDefined(userDefaults.attributionControl) ? userDefaults.attributionControl : newDefaults.attributionControl;\n                newDefaults.tileLayer = isDefined(userDefaults.tileLayer) ? userDefaults.tileLayer : newDefaults.tileLayer;\n                newDefaults.zoomControlPosition = isDefined(userDefaults.zoomControlPosition) ? userDefaults.zoomControlPosition : newDefaults.zoomControlPosition;\n                newDefaults.keyboard = isDefined(userDefaults.keyboard) ? userDefaults.keyboard : newDefaults.keyboard;\n                newDefaults.dragging = isDefined(userDefaults.dragging) ? userDefaults.dragging : newDefaults.dragging;\n                newDefaults.trackResize = isDefined(userDefaults.trackResize) ? userDefaults.trackResize : newDefaults.trackResize;\n\n                if (isDefined(userDefaults.controls)) {\n                    angular.extend(newDefaults.controls, userDefaults.controls);\n                }\n\n                if (isObject(userDefaults.crs)) {\n                    newDefaults.crs = userDefaults.crs;\n                } else if (isDefined(L.CRS[userDefaults.crs])) {\n                    newDefaults.crs = L.CRS[userDefaults.crs];\n                }\n\n                if (isDefined(userDefaults.center)) {\n                    angular.copy(userDefaults.center, newDefaults.center);\n                }\n\n                if (isDefined(userDefaults.tileLayerOptions)) {\n                    angular.copy(userDefaults.tileLayerOptions, newDefaults.tileLayerOptions);\n                }\n\n                if (isDefined(userDefaults.maxZoom)) {\n                    newDefaults.maxZoom = userDefaults.maxZoom;\n                }\n\n                if (isDefined(userDefaults.minZoom)) {\n                    newDefaults.minZoom = userDefaults.minZoom;\n                }\n\n                if (isDefined(userDefaults.zoomAnimation)) {\n                    newDefaults.zoomAnimation = userDefaults.zoomAnimation;\n                }\n\n                if (isDefined(userDefaults.fadeAnimation)) {\n                    newDefaults.fadeAnimation = userDefaults.fadeAnimation;\n                }\n\n                if (isDefined(userDefaults.markerZoomAnimation)) {\n                    newDefaults.markerZoomAnimation = userDefaults.markerZoomAnimation;\n                }\n\n                if (isDefined(userDefaults.worldCopyJump)) {\n                    newDefaults.worldCopyJump = userDefaults.worldCopyJump;\n                }\n\n                if (isDefined(userDefaults.map)) {\n                    newDefaults.map = userDefaults.map;\n                }\n\n                if (isDefined(userDefaults.path)) {\n                    newDefaults.path = userDefaults.path;\n                }\n            }\n\n            var mapId = obtainEffectiveMapId(defaults, scopeId);\n            defaults[mapId] = newDefaults;\n            return newDefaults;\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletMarkersHelpers', function ($rootScope, $timeout, leafletHelpers, leafletLogger, $compile, leafletGeoJsonHelpers, leafletWatchHelpers) {\n    var isDefined = leafletHelpers.isDefined,\n        defaultTo = leafletHelpers.defaultTo,\n        MarkerClusterPlugin = leafletHelpers.MarkerClusterPlugin,\n        AwesomeMarkersPlugin = leafletHelpers.AwesomeMarkersPlugin,\n        VectorMarkersPlugin = leafletHelpers.VectorMarkersPlugin,\n        MakiMarkersPlugin = leafletHelpers.MakiMarkersPlugin,\n        ExtraMarkersPlugin = leafletHelpers.ExtraMarkersPlugin,\n        DomMarkersPlugin = leafletHelpers.DomMarkersPlugin,\n        safeApply = leafletHelpers.safeApply,\n        Helpers = leafletHelpers,\n        isString = leafletHelpers.isString,\n        isNumber = leafletHelpers.isNumber,\n        isObject = leafletHelpers.isObject,\n        groups = {},\n        geoHlp = leafletGeoJsonHelpers,\n        errorHeader = leafletHelpers.errorHeader,\n        maybeWatch = leafletWatchHelpers.maybeWatch,\n        $log = leafletLogger;\n\n    var _string = function _string(marker) {\n        //this exists since JSON.stringify barfs on cyclic\n        var retStr = '';\n        ['_icon', '_latlng', '_leaflet_id', '_map', '_shadow'].forEach(function (prop) {\n            retStr += prop + ': ' + defaultTo(marker[prop], 'undefined') + ' \\n';\n        });\n        return '[leafletMarker] : \\n' + retStr;\n    };\n    var _log = function _log(marker, useConsole) {\n        var logger = useConsole ? console : $log;\n        logger.debug(_string(marker));\n    };\n\n    var existDomContainer = function existDomContainer(groupName) {\n        return angular.element(groups[groupName]._map._container).parent().length > 0;\n    };\n\n    var createLeafletIcon = function createLeafletIcon(iconData) {\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'awesomeMarker') {\n            if (!AwesomeMarkersPlugin.isLoaded()) {\n                $log.error(errorHeader + ' The AwesomeMarkers Plugin is not loaded.');\n            }\n\n            return new L.AwesomeMarkers.icon(iconData);\n        }\n\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'vectorMarker') {\n            if (!VectorMarkersPlugin.isLoaded()) {\n                $log.error(errorHeader + ' The VectorMarkers Plugin is not loaded.');\n            }\n\n            return new L.VectorMarkers.icon(iconData);\n        }\n\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'makiMarker') {\n            if (!MakiMarkersPlugin.isLoaded()) {\n                $log.error(errorHeader + 'The MakiMarkers Plugin is not loaded.');\n            }\n\n            return new L.MakiMarkers.icon(iconData);\n        }\n\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'extraMarker') {\n            if (!ExtraMarkersPlugin.isLoaded()) {\n                $log.error(errorHeader + 'The ExtraMarkers Plugin is not loaded.');\n            }\n            return new L.ExtraMarkers.icon(iconData);\n        }\n\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'div') {\n            return new L.divIcon(iconData);\n        }\n\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'dom') {\n            if (!DomMarkersPlugin.isLoaded()) {\n                $log.error(errorHeader + 'The DomMarkers Plugin is not loaded.');\n            }\n            var markerScope = angular.isFunction(iconData.getMarkerScope) ? iconData.getMarkerScope().$new() : $rootScope,\n                template = $compile(iconData.template)(markerScope),\n                iconDataCopy = angular.copy(iconData);\n            iconDataCopy.ngElement = template;\n            iconDataCopy.element = template[0];\n            if (angular.isFunction(iconData.getMarkerScope)) iconDataCopy.scope = markerScope;\n            return new L.DomMarkers.icon(iconDataCopy);\n        }\n\n        // allow for any custom icon to be used... assumes the icon has already been initialized\n        if (isDefined(iconData) && isDefined(iconData.type) && iconData.type === 'icon') {\n            return iconData.icon;\n        }\n\n        var base64icon = \"data:image/png;base64,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\";\n        var base64shadow = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=\";\n\n        if (!isDefined(iconData) || !isDefined(iconData.iconUrl)) {\n            return new L.Icon.Default({\n                iconUrl: base64icon,\n                shadowUrl: base64shadow,\n                iconSize: [25, 41],\n                iconAnchor: [12, 41],\n                popupAnchor: [1, -34],\n                shadowSize: [41, 41]\n            });\n        }\n\n        return new L.Icon(iconData);\n    };\n\n    var _resetMarkerGroup = function _resetMarkerGroup(groupName) {\n        if (isDefined(groups[groupName])) {\n            delete groups[groupName];\n        }\n    };\n\n    var _resetMarkerGroups = function _resetMarkerGroups() {\n        groups = {};\n    };\n\n    var _resetUnusedMarkerGroups = function _resetUnusedMarkerGroups() {\n        for (var groupName in groups) {\n            if (!existDomContainer(groupName)) {\n                _resetMarkerGroup(groupName);\n            }\n        }\n    };\n\n    var _cleanDomIcon = function _cleanDomIcon(marker) {\n        if (marker.options.icon.options.ngElement) {\n            marker.options.icon.options.ngElement.remove();\n        }\n        if (marker.options.icon.options.scope) {\n            marker.options.icon.options.scope.$destroy();\n        }\n    };\n\n    var _deleteMarker = function _deleteMarker(marker, map, layers) {\n        marker.closePopup();\n\n        // if it's a dom icon, clean it\n        if (marker.options.icon && marker.options.icon.options && marker.options.icon.options.type === 'dom') {\n            _cleanDomIcon(marker);\n        }\n\n        // There is no easy way to know if a marker is added to a layer, so we search for it\n        // if there are overlays\n        if (isDefined(layers) && isDefined(layers.overlays)) {\n            for (var key in layers.overlays) {\n                if (layers.overlays[key] instanceof L.LayerGroup || layers.overlays[key] instanceof L.FeatureGroup) {\n                    if (layers.overlays[key].hasLayer(marker)) {\n                        layers.overlays[key].removeLayer(marker);\n                        return;\n                    }\n                }\n            }\n        }\n\n        if (isDefined(groups)) {\n            for (var groupKey in groups) {\n                if (groups[groupKey].hasLayer(marker)) {\n                    groups[groupKey].removeLayer(marker);\n                }\n            }\n        }\n\n        if (map.hasLayer(marker)) {\n            map.removeLayer(marker);\n        }\n    };\n\n    var adjustPopupPan = function adjustPopupPan(marker, map) {\n        var containerHeight = marker._popup._container.offsetHeight,\n            layerPos = new L.Point(marker._popup._containerLeft, -containerHeight - marker._popup._containerBottom),\n            containerPos = map.layerPointToContainerPoint(layerPos);\n        if (containerPos !== null) {\n            marker._popup._adjustPan();\n        }\n    };\n\n    var compilePopup = function compilePopup(marker, markerScope) {\n        $compile(marker._popup._contentNode)(markerScope);\n    };\n\n    var updatePopup = function updatePopup(marker, markerScope, map) {\n        //The innerText should be more than 1 once angular has compiled.\n        //We need to keep trying until angular has compiled before we _updateLayout and _updatePosition\n        //This should take care of any scenario , eg ngincludes, whatever.\n        //Is there a better way to check for this?\n        var innerText = marker._popup._contentNode.innerText || marker._popup._contentNode.textContent;\n        if (innerText.length < 1) {\n            $timeout(function () {\n                updatePopup(marker, markerScope, map);\n            });\n        }\n\n        //cause a reflow - this is also very important - if we don't do this then the widths are from before $compile\n        var reflow = marker._popup._contentNode.offsetWidth;\n\n        marker._popup._updateLayout();\n        marker._popup._updatePosition();\n\n        if (marker._popup.options.autoPan) {\n            adjustPopupPan(marker, map);\n        }\n\n        //using / returning reflow so jshint doesn't moan\n        return reflow;\n    };\n\n    var _manageOpenPopup = function _manageOpenPopup(marker, markerData, map) {\n        // The marker may provide a scope returning function used to compile the message\n        // default to $rootScope otherwise\n        var markerScope = angular.isFunction(markerData.getMessageScope) ? markerData.getMessageScope() : $rootScope,\n            compileMessage = isDefined(markerData.compileMessage) ? markerData.compileMessage : true;\n\n        if (compileMessage) {\n            if (!isDefined(marker._popup) || !isDefined(marker._popup._contentNode)) {\n                $log.error(errorHeader + 'Popup is invalid or does not have any content.');\n                return false;\n            }\n\n            compilePopup(marker, markerScope);\n            updatePopup(marker, markerData, map);\n        }\n    };\n\n    var _manageOpenLabel = function _manageOpenLabel(marker, markerData) {\n        var markerScope = angular.isFunction(markerData.getMessageScope) ? markerData.getMessageScope() : $rootScope,\n            labelScope = angular.isFunction(markerData.getLabelScope) ? markerData.getLabelScope() : markerScope,\n            compileMessage = isDefined(markerData.compileMessage) ? markerData.compileMessage : true;\n\n        if (Helpers.LabelPlugin.isLoaded() && isDefined(markerData.label)) {\n            if (isDefined(markerData.label.options) && markerData.label.options.noHide === true) {\n                marker.showLabel();\n            }\n            if (compileMessage && isDefined(marker.label)) {\n                $compile(marker.label._container)(labelScope);\n            }\n        }\n    };\n\n    var _updateMarker = function _updateMarker(markerData, oldMarkerData, marker, name, leafletScope, layers, map) {\n        if (!isDefined(oldMarkerData)) {\n            return;\n        }\n\n        // Update the lat-lng property (always present in marker properties)\n        if (!geoHlp.validateCoords(markerData)) {\n            $log.warn('There are problems with lat-lng data, please verify your marker model');\n            _deleteMarker(marker, map, layers);\n            return;\n        }\n\n        // watch is being initialized if old and new object is the same\n        var isInitializing = markerData === oldMarkerData;\n\n        // Update marker rotation\n        if (isDefined(markerData.iconAngle) && oldMarkerData.iconAngle !== markerData.iconAngle) {\n            marker.setIconAngle(markerData.iconAngle);\n        }\n\n        // It is possible that the layer has been removed or the layer marker does not exist\n        // Update the layer group if present or move it to the map if not\n        if (!isString(markerData.layer)) {\n            // There is no layer information, we move the marker to the map if it was in a layer group\n            if (isString(oldMarkerData.layer)) {\n                // Remove from the layer group that is supposed to be\n                if (isDefined(layers.overlays[oldMarkerData.layer]) && layers.overlays[oldMarkerData.layer].hasLayer(marker)) {\n                    layers.overlays[oldMarkerData.layer].removeLayer(marker);\n                    marker.closePopup();\n                }\n                // Test if it is not on the map and add it\n                if (!map.hasLayer(marker)) {\n                    map.addLayer(marker);\n                }\n            }\n        }\n\n        if ((isNumber(markerData.opacity) || isNumber(parseFloat(markerData.opacity))) && markerData.opacity !== oldMarkerData.opacity) {\n            // There was a different opacity so we update it\n            marker.setOpacity(markerData.opacity);\n        }\n\n        if (isString(markerData.layer) && oldMarkerData.layer !== markerData.layer) {\n            // If it was on a layer group we have to remove it\n            if (isString(oldMarkerData.layer) && isDefined(layers.overlays[oldMarkerData.layer]) && layers.overlays[oldMarkerData.layer].hasLayer(marker)) {\n                layers.overlays[oldMarkerData.layer].removeLayer(marker);\n            }\n            marker.closePopup();\n\n            // Remove it from the map in case the new layer is hidden or there is an error in the new layer\n            if (map.hasLayer(marker)) {\n                map.removeLayer(marker);\n            }\n\n            // The markerData.layer is defined so we add the marker to the layer if it is different from the old data\n            if (!isDefined(layers.overlays[markerData.layer])) {\n                $log.error(errorHeader + 'You must use a name of an existing layer');\n                return;\n            }\n            // Is a group layer?\n            var layerGroup = layers.overlays[markerData.layer];\n            if (!(layerGroup instanceof L.LayerGroup || layerGroup instanceof L.FeatureGroup)) {\n                $log.error(errorHeader + 'A marker can only be added to a layer of type \"group\" or \"featureGroup\"');\n                return;\n            }\n            // The marker goes to a correct layer group, so first of all we add it\n            layerGroup.addLayer(marker);\n            // The marker is automatically added to the map depending on the visibility\n            // of the layer, so we only have to open the popup if the marker is in the map\n            if (map.hasLayer(marker) && markerData.focus === true) {\n                marker.openPopup();\n            }\n        }\n\n        // Update the draggable property\n        if (markerData.draggable !== true && oldMarkerData.draggable === true && isDefined(marker.dragging)) {\n            marker.dragging.disable();\n        }\n\n        if (markerData.draggable === true && oldMarkerData.draggable !== true) {\n            // The markerData.draggable property must be true so we update if there wasn't a previous value or it wasn't true\n            if (marker.dragging) {\n                marker.dragging.enable();\n            } else {\n                if (L.Handler.MarkerDrag) {\n                    marker.dragging = new L.Handler.MarkerDrag(marker);\n                    marker.options.draggable = true;\n                    marker.dragging.enable();\n                }\n            }\n        }\n\n        // Update the icon property\n        if (!isObject(markerData.icon)) {\n            // If there is no icon property or it's not an object\n            if (isObject(oldMarkerData.icon)) {\n                if (oldMarkerData.icon.type === 'dom') {\n                    // clean previous icon if it's a dom one\n                    _cleanDomIcon(marker);\n                }\n                // If there was an icon before restore to the default\n                marker.setIcon(createLeafletIcon());\n                marker.closePopup();\n                marker.unbindPopup();\n                if (isString(markerData.message)) {\n                    marker.bindPopup(markerData.message, markerData.popupOptions);\n                }\n            }\n        }\n\n        if (isObject(markerData.icon) && isObject(oldMarkerData.icon) && !angular.equals(markerData.icon, oldMarkerData.icon)) {\n            var dragG = false;\n            if (marker.dragging) {\n                dragG = marker.dragging.enabled();\n            }\n            if (oldMarkerData.icon.type === 'dom') {\n                // clean previous icon if it's a dom one\n                _cleanDomIcon(marker);\n            }\n            marker.setIcon(createLeafletIcon(markerData.icon));\n            if (dragG) {\n                marker.dragging.enable();\n            }\n            marker.closePopup();\n            marker.unbindPopup();\n            if (isString(markerData.message)) {\n                marker.bindPopup(markerData.message, markerData.popupOptions);\n                // if marker has been already focused, reopen popup\n                if (map.hasLayer(marker) && markerData.focus === true) {\n                    marker.openPopup();\n                }\n            }\n        }\n\n        // Update the Popup message property\n        if (!isString(markerData.message) && isString(oldMarkerData.message)) {\n            marker.closePopup();\n            marker.unbindPopup();\n        }\n\n        // Update the label content or bind a new label if the old one has been removed.\n        if (Helpers.LabelPlugin.isLoaded()) {\n            if (isDefined(markerData.label) && isDefined(markerData.label.message)) {\n                if ('label' in oldMarkerData && 'message' in oldMarkerData.label && !angular.equals(markerData.label.message, oldMarkerData.label.message)) {\n                    marker.updateLabelContent(markerData.label.message);\n                } else if (!angular.isFunction(marker.getLabel) || angular.isFunction(marker.getLabel) && !isDefined(marker.getLabel())) {\n                    marker.bindLabel(markerData.label.message, markerData.label.options);\n                    _manageOpenLabel(marker, markerData);\n                } else {\n                    _manageOpenLabel(marker, markerData);\n                }\n            } else if (!('label' in markerData && !('message' in markerData.label))) {\n                if (angular.isFunction(marker.unbindLabel)) {\n                    marker.unbindLabel();\n                }\n            }\n        }\n\n        // There is some text in the popup, so we must show the text or update existing\n        if (isString(markerData.message) && !isString(oldMarkerData.message)) {\n            // There was no message before so we create it\n            marker.bindPopup(markerData.message, markerData.popupOptions);\n        }\n\n        if (isString(markerData.message) && isString(oldMarkerData.message) && markerData.message !== oldMarkerData.message) {\n            // There was a different previous message so we update it\n            marker.setPopupContent(markerData.message);\n        }\n\n        // Update the focus property\n        var updatedFocus = false;\n        if (markerData.focus !== true && oldMarkerData.focus === true) {\n            // If there was a focus property and was true we turn it off\n            marker.closePopup();\n            updatedFocus = true;\n        }\n\n        // The markerData.focus property must be true so we update if there wasn't a previous value or it wasn't true\n        if (markerData.focus === true && (!isDefined(oldMarkerData.focus) || oldMarkerData.focus === false) || isInitializing && markerData.focus === true) {\n            // Reopen the popup when focus is still true\n            marker.openPopup();\n            updatedFocus = true;\n        }\n\n        // zIndexOffset adjustment\n        if (oldMarkerData.zIndexOffset !== markerData.zIndexOffset) {\n            marker.setZIndexOffset(markerData.zIndexOffset);\n        }\n\n        var markerLatLng = marker.getLatLng();\n        var isCluster = isString(markerData.layer) && Helpers.MarkerClusterPlugin.is(layers.overlays[markerData.layer]);\n        // If the marker is in a cluster it has to be removed and added to the layer when the location is changed\n        if (isCluster) {\n            // The focus has changed even by a user click or programatically\n            if (updatedFocus) {\n                // We only have to update the location if it was changed programatically, because it was\n                // changed by a user drag the marker data has already been updated by the internal event\n                // listened by the directive\n                if (markerData.lat !== oldMarkerData.lat || markerData.lng !== oldMarkerData.lng) {\n                    layers.overlays[markerData.layer].removeLayer(marker);\n                    marker.setLatLng([markerData.lat, markerData.lng]);\n                    layers.overlays[markerData.layer].addLayer(marker);\n                }\n            } else {\n                // The marker has possibly moved. It can be moved by a user drag (marker location and data are equal but old\n                // data is diferent) or programatically (marker location and data are diferent)\n                if (markerLatLng.lat !== markerData.lat || markerLatLng.lng !== markerData.lng) {\n                    // The marker was moved by a user drag\n                    layers.overlays[markerData.layer].removeLayer(marker);\n                    marker.setLatLng([markerData.lat, markerData.lng]);\n                    layers.overlays[markerData.layer].addLayer(marker);\n                } else if (markerData.lat !== oldMarkerData.lat || markerData.lng !== oldMarkerData.lng) {\n                    // The marker was moved programatically\n                    layers.overlays[markerData.layer].removeLayer(marker);\n                    marker.setLatLng([markerData.lat, markerData.lng]);\n                    layers.overlays[markerData.layer].addLayer(marker);\n                } else if (isObject(markerData.icon) && isObject(oldMarkerData.icon) && !angular.equals(markerData.icon, oldMarkerData.icon)) {\n                    layers.overlays[markerData.layer].removeLayer(marker);\n                    layers.overlays[markerData.layer].addLayer(marker);\n                }\n            }\n        } else if (markerLatLng.lat !== markerData.lat || markerLatLng.lng !== markerData.lng) {\n            marker.setLatLng([markerData.lat, markerData.lng]);\n        }\n    };\n\n    var _getLayerModels = function _getLayerModels(models, layerName) {\n        if (!isDefined(models)) return;\n        if (layerName) return models[layerName];\n        return models;\n    };\n\n    var _getModelFromModels = function _getModelFromModels(models, id, layerName) {\n        if (!isDefined(models)) return;\n        if (!id) {\n            $log.error(errorHeader + 'marker id missing in getMarker');\n            return;\n        }\n        if (layerName) return models[layerName][id];\n\n        return models[id];\n    };\n    return {\n        resetMarkerGroup: _resetMarkerGroup,\n\n        resetMarkerGroups: _resetMarkerGroups,\n\n        resetUnusedMarkerGroups: _resetUnusedMarkerGroups,\n\n        deleteMarker: _deleteMarker,\n\n        manageOpenPopup: _manageOpenPopup,\n\n        manageOpenLabel: _manageOpenLabel,\n\n        createMarker: function createMarker(markerData) {\n            if (!isDefined(markerData) || !geoHlp.validateCoords(markerData)) {\n                $log.error(errorHeader + 'The marker definition is not valid.');\n                return;\n            }\n            var coords = geoHlp.getCoords(markerData);\n\n            if (!isDefined(coords)) {\n                $log.error(errorHeader + 'Unable to get coordinates from markerData.');\n                return;\n            }\n\n            var markerOptions = {\n                icon: createLeafletIcon(markerData.icon),\n                title: isDefined(markerData.title) ? markerData.title : '',\n                draggable: isDefined(markerData.draggable) ? markerData.draggable : false,\n                clickable: isDefined(markerData.clickable) ? markerData.clickable : true,\n                riseOnHover: isDefined(markerData.riseOnHover) ? markerData.riseOnHover : false,\n                zIndexOffset: isDefined(markerData.zIndexOffset) ? markerData.zIndexOffset : 0,\n                iconAngle: isDefined(markerData.iconAngle) ? markerData.iconAngle : 0\n            };\n            // Add any other options not added above to markerOptions\n            for (var markerDatum in markerData) {\n                if (markerData.hasOwnProperty(markerDatum) && !markerOptions.hasOwnProperty(markerDatum)) {\n                    markerOptions[markerDatum] = markerData[markerDatum];\n                }\n            }\n\n            var marker = new L.marker(coords, markerOptions);\n\n            if (!isString(markerData.message)) {\n                marker.unbindPopup();\n            }\n\n            return marker;\n        },\n\n        addMarkerToGroup: function addMarkerToGroup(marker, groupName, groupOptions, map) {\n            if (!isString(groupName)) {\n                $log.error(errorHeader + 'The marker group you have specified is invalid.');\n                return;\n            }\n\n            if (!MarkerClusterPlugin.isLoaded()) {\n                $log.error(errorHeader + \"The MarkerCluster plugin is not loaded.\");\n                return;\n            }\n            if (!isDefined(groups[groupName])) {\n                groups[groupName] = new L.MarkerClusterGroup(groupOptions);\n                map.addLayer(groups[groupName]);\n            }\n            groups[groupName].addLayer(marker);\n        },\n\n        listenMarkerEvents: function listenMarkerEvents(marker, markerData, leafletScope, watchType, map) {\n            marker.on(\"popupopen\", function () /* event */{\n                safeApply(leafletScope, function () {\n                    if (isDefined(marker._popup) || isDefined(marker._popup._contentNode)) {\n                        markerData.focus = true;\n                        _manageOpenPopup(marker, markerData, map); //needed since markerData is now a copy\n                    }\n                });\n            });\n            marker.on(\"popupclose\", function () /* event */{\n                safeApply(leafletScope, function () {\n                    markerData.focus = false;\n                });\n            });\n            marker.on(\"add\", function () /* event */{\n                safeApply(leafletScope, function () {\n                    if ('label' in markerData) _manageOpenLabel(marker, markerData);\n                });\n            });\n        },\n\n        updateMarker: _updateMarker,\n\n        addMarkerWatcher: function addMarkerWatcher(marker, name, leafletScope, layers, map, watchOptions) {\n            var markerWatchPath = Helpers.getObjectArrayPath(\"markers.\" + name);\n\n            maybeWatch(leafletScope, markerWatchPath, watchOptions, function (markerData, oldMarkerData, clearWatch) {\n                if (!isDefined(markerData)) {\n                    _deleteMarker(marker, map, layers);\n                    clearWatch();\n                    return;\n                }\n                _updateMarker(markerData, oldMarkerData, marker, name, leafletScope, layers, map);\n            });\n        },\n        string: _string,\n        log: _log,\n        getModelFromModels: _getModelFromModels,\n        getLayerModels: _getLayerModels\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletPathsHelpers', function ($rootScope, leafletLogger, leafletHelpers) {\n    var isDefined = leafletHelpers.isDefined,\n        isArray = leafletHelpers.isArray,\n        isNumber = leafletHelpers.isNumber,\n        isValidPoint = leafletHelpers.isValidPoint,\n        $log = leafletLogger;\n\n    var availableOptions = [\n    // Path options\n    'stroke', 'weight', 'color', 'opacity', 'fill', 'fillColor', 'fillOpacity', 'dashArray', 'lineCap', 'lineJoin', 'clickable', 'pointerEvents', 'className',\n\n    // Polyline options\n    'smoothFactor', 'noClip'];\n    function _convertToLeafletLatLngs(latlngs) {\n        return latlngs.filter(function (latlng) {\n            return isValidPoint(latlng);\n        }).map(function (latlng) {\n            return _convertToLeafletLatLng(latlng);\n        });\n    }\n\n    function _convertToLeafletLatLng(latlng) {\n        if (isArray(latlng)) {\n            return new L.LatLng(latlng[0], latlng[1]);\n        } else {\n            return new L.LatLng(latlng.lat, latlng.lng);\n        }\n    }\n\n    function _convertToLeafletMultiLatLngs(paths) {\n        return paths.map(function (latlngs) {\n            return _convertToLeafletLatLngs(latlngs);\n        });\n    }\n\n    function _getOptions(path, defaults) {\n        var options = {};\n        for (var i = 0; i < availableOptions.length; i++) {\n            var optionName = availableOptions[i];\n\n            if (isDefined(path[optionName])) {\n                options[optionName] = path[optionName];\n            } else if (isDefined(defaults.path[optionName])) {\n                options[optionName] = defaults.path[optionName];\n            }\n        }\n\n        return options;\n    }\n\n    var _updatePathOptions = function _updatePathOptions(path, data) {\n        var updatedStyle = {};\n        for (var i = 0; i < availableOptions.length; i++) {\n            var optionName = availableOptions[i];\n            if (isDefined(data[optionName])) {\n                updatedStyle[optionName] = data[optionName];\n            }\n        }\n        path.setStyle(data);\n    };\n\n    var _isValidPolyline = function _isValidPolyline(latlngs) {\n        if (!isArray(latlngs)) {\n            return false;\n        }\n        for (var i = 0; i < latlngs.length; i++) {\n            var point = latlngs[i];\n            if (!isValidPoint(point)) {\n                return false;\n            }\n        }\n        return true;\n    };\n\n    var pathTypes = {\n        polyline: {\n            isValid: function isValid(pathData) {\n                var latlngs = pathData.latlngs;\n                return _isValidPolyline(latlngs);\n            },\n            createPath: function createPath(options) {\n                return new L.Polyline([], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLngs(_convertToLeafletLatLngs(data.latlngs));\n                _updatePathOptions(path, data);\n                return;\n            }\n        },\n        multiPolyline: {\n            isValid: function isValid(pathData) {\n                var latlngs = pathData.latlngs;\n                if (!isArray(latlngs)) {\n                    return false;\n                }\n\n                for (var i in latlngs) {\n                    var polyline = latlngs[i];\n                    if (!_isValidPolyline(polyline)) {\n                        return false;\n                    }\n                }\n\n                return true;\n            },\n            createPath: function createPath(options) {\n                return new L.multiPolyline([[[0, 0], [1, 1]]], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLngs(_convertToLeafletMultiLatLngs(data.latlngs));\n                _updatePathOptions(path, data);\n                return;\n            }\n        },\n        polygon: {\n            isValid: function isValid(pathData) {\n                var latlngs = pathData.latlngs;\n                return _isValidPolyline(latlngs);\n            },\n            createPath: function createPath(options) {\n                return new L.Polygon([], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLngs(_convertToLeafletLatLngs(data.latlngs));\n                _updatePathOptions(path, data);\n                return;\n            }\n        },\n        multiPolygon: {\n            isValid: function isValid(pathData) {\n                var latlngs = pathData.latlngs;\n\n                if (!isArray(latlngs)) {\n                    return false;\n                }\n\n                for (var i in latlngs) {\n                    var polyline = latlngs[i];\n                    if (!_isValidPolyline(polyline)) {\n                        return false;\n                    }\n                }\n\n                return true;\n            },\n            createPath: function createPath(options) {\n                return new L.MultiPolygon([[[0, 0], [1, 1], [0, 1]]], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLngs(_convertToLeafletMultiLatLngs(data.latlngs));\n                _updatePathOptions(path, data);\n                return;\n            }\n        },\n        rectangle: {\n            isValid: function isValid(pathData) {\n                var latlngs = pathData.latlngs;\n\n                if (!isArray(latlngs) || latlngs.length !== 2) {\n                    return false;\n                }\n\n                for (var i in latlngs) {\n                    var point = latlngs[i];\n                    if (!isValidPoint(point)) {\n                        return false;\n                    }\n                }\n\n                return true;\n            },\n            createPath: function createPath(options) {\n                return new L.Rectangle([[0, 0], [1, 1]], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setBounds(new L.LatLngBounds(_convertToLeafletLatLngs(data.latlngs)));\n                _updatePathOptions(path, data);\n            }\n        },\n        circle: {\n            isValid: function isValid(pathData) {\n                var point = pathData.latlngs;\n                return isValidPoint(point) && isNumber(pathData.radius);\n            },\n            createPath: function createPath(options) {\n                return new L.Circle([0, 0], 1, options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLng(_convertToLeafletLatLng(data.latlngs));\n                if (isDefined(data.radius)) {\n                    path.setRadius(data.radius);\n                }\n                _updatePathOptions(path, data);\n            }\n        },\n        circleMarker: {\n            isValid: function isValid(pathData) {\n                var point = pathData.latlngs;\n                return isValidPoint(point) && isNumber(pathData.radius);\n            },\n            createPath: function createPath(options) {\n                return new L.CircleMarker([0, 0], options);\n            },\n            setPath: function setPath(path, data) {\n                path.setLatLng(_convertToLeafletLatLng(data.latlngs));\n                if (isDefined(data.radius)) {\n                    path.setRadius(data.radius);\n                }\n                _updatePathOptions(path, data);\n            }\n        }\n    };\n\n    var _getPathData = function _getPathData(path) {\n        var pathData = {};\n        if (path.latlngs) {\n            pathData.latlngs = path.latlngs;\n        }\n\n        if (path.radius) {\n            pathData.radius = path.radius;\n        }\n\n        return pathData;\n    };\n\n    return {\n        setPathOptions: function setPathOptions(leafletPath, pathType, data) {\n            if (!isDefined(pathType)) {\n                pathType = \"polyline\";\n            }\n            pathTypes[pathType].setPath(leafletPath, data);\n        },\n        createPath: function createPath(name, path, defaults) {\n            if (!isDefined(path.type)) {\n                path.type = \"polyline\";\n            }\n            var options = _getOptions(path, defaults);\n            var pathData = _getPathData(path);\n\n            if (!pathTypes[path.type].isValid(pathData)) {\n                $log.error(\"[AngularJS - Leaflet] Invalid data passed to the \" + path.type + \" path\");\n                return;\n            }\n\n            return pathTypes[path.type].createPath(options);\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletWatchHelpers', function () {\n\n    var _maybe = function _maybe(scope, watchFunctionName, thingToWatchStr, watchOptions, initCb) {\n        var unWatch = scope[watchFunctionName](thingToWatchStr, function (newValue, oldValue) {\n            //make the unWatch function available to the callback as well.\n            initCb(newValue, oldValue, unWatch);\n            if (watchOptions.type === null) unWatch();\n        }, watchOptions.type === 'watchDeep');\n\n        return unWatch;\n    };\n\n    /*\n    @name: maybeWatch\n    @description: Utility to watch something once or forever.\n    @returns unWatch function\n    @param watchOptions - This object is used to determine the type of\n    watch used.\n    */\n    var _maybeWatch = function _maybeWatch(scope, thingToWatchStr, watchOptions, initCb) {\n        var watchMethod;\n\n        if (watchOptions.type === 'watchCollection') {\n            watchMethod = '$watchCollection';\n        } else {\n            watchMethod = '$watch';\n        }\n\n        return _maybe(scope, watchMethod, thingToWatchStr, watchOptions, initCb);\n    };\n\n    return {\n        maybeWatch: _maybeWatch\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').service('leafletLogger', function (nemSimpleLogger) {\n  return nemSimpleLogger.spawn();\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('nominatimService', function ($q, $http, leafletHelpers, leafletMapDefaults) {\n    var isDefined = leafletHelpers.isDefined;\n\n    return {\n        query: function query(address, mapId) {\n            var defaults = leafletMapDefaults.getDefaults(mapId);\n            var url = defaults.nominatim.server;\n            var df = $q.defer();\n\n            $http.get(url, { params: { format: 'json', limit: 1, q: address } }).success(function (data) {\n                if (data.length > 0 && isDefined(data[0].boundingbox)) {\n                    df.resolve(data[0]);\n                } else {\n                    df.reject('[Nominatim] Invalid address');\n                }\n            });\n\n            return df.promise;\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('bounds', function (leafletLogger, $timeout, $http, leafletHelpers, nominatimService, leafletBoundsHelpers) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: ['leaflet'],\n\n        link: function link(scope, element, attrs, controller) {\n            var isDefined = leafletHelpers.isDefined;\n            var createLeafletBounds = leafletBoundsHelpers.createLeafletBounds;\n            var leafletScope = controller[0].getLeafletScope();\n            var mapController = controller[0];\n            var errorHeader = leafletHelpers.errorHeader + ' [Bounds] ';\n\n            var emptyBounds = function emptyBounds(bounds) {\n                return bounds._southWest.lat === 0 && bounds._southWest.lng === 0 && bounds._northEast.lat === 0 && bounds._northEast.lng === 0;\n            };\n\n            mapController.getMap().then(function (map) {\n                leafletScope.$on('boundsChanged', function (event) {\n                    var scope = event.currentScope;\n                    var bounds = map.getBounds();\n\n                    if (emptyBounds(bounds) || scope.settingBoundsFromScope) {\n                        return;\n                    }\n                    scope.settingBoundsFromLeaflet = true;\n                    var newScopeBounds = {\n                        northEast: {\n                            lat: bounds._northEast.lat,\n                            lng: bounds._northEast.lng\n                        },\n                        southWest: {\n                            lat: bounds._southWest.lat,\n                            lng: bounds._southWest.lng\n                        },\n                        options: bounds.options\n                    };\n                    if (!angular.equals(scope.bounds, newScopeBounds)) {\n                        scope.bounds = newScopeBounds;\n                    }\n                    $timeout(function () {\n                        scope.settingBoundsFromLeaflet = false;\n                    });\n                });\n\n                var lastNominatimQuery;\n                leafletScope.$watch('bounds', function (bounds) {\n                    if (scope.settingBoundsFromLeaflet) return;\n                    if (isDefined(bounds.address) && bounds.address !== lastNominatimQuery) {\n                        scope.settingBoundsFromScope = true;\n                        nominatimService.query(bounds.address, attrs.id).then(function (data) {\n                            var b = data.boundingbox;\n                            var newBounds = [[b[0], b[2]], [b[1], b[3]]];\n                            map.fitBounds(newBounds);\n                        }, function (errMsg) {\n                            $log.error(errorHeader + ' ' + errMsg + '.');\n                        });\n                        lastNominatimQuery = bounds.address;\n                        $timeout(function () {\n                            scope.settingBoundsFromScope = false;\n                        });\n                        return;\n                    }\n\n                    var leafletBounds = createLeafletBounds(bounds);\n                    if (leafletBounds && !map.getBounds().equals(leafletBounds)) {\n                        scope.settingBoundsFromScope = true;\n                        map.fitBounds(leafletBounds, bounds.options);\n                        $timeout(function () {\n                            scope.settingBoundsFromScope = false;\n                        });\n                    }\n                }, true);\n            });\n        }\n    };\n});\n\n'use strict';\n\nvar centerDirectiveTypes = ['center', 'lfCenter'],\n    centerDirectives = {};\n\ncenterDirectiveTypes.forEach(function (directiveName) {\n    centerDirectives[directiveName] = ['leafletLogger', '$q', '$location', '$timeout', 'leafletMapDefaults', 'leafletHelpers', 'leafletBoundsHelpers', 'leafletMapEvents', function (leafletLogger, $q, $location, $timeout, leafletMapDefaults, leafletHelpers, leafletBoundsHelpers, leafletMapEvents) {\n\n        var isDefined = leafletHelpers.isDefined,\n            isNumber = leafletHelpers.isNumber,\n            isSameCenterOnMap = leafletHelpers.isSameCenterOnMap,\n            safeApply = leafletHelpers.safeApply,\n            isValidCenter = leafletHelpers.isValidCenter,\n            isValidBounds = leafletBoundsHelpers.isValidBounds,\n            isUndefinedOrEmpty = leafletHelpers.isUndefinedOrEmpty,\n            errorHeader = leafletHelpers.errorHeader,\n            $log = leafletLogger;\n\n        var shouldInitializeMapWithBounds = function shouldInitializeMapWithBounds(bounds, center) {\n            return isDefined(bounds) && isValidBounds(bounds) && isUndefinedOrEmpty(center);\n        };\n\n        var _leafletCenter;\n        return {\n            restrict: \"A\",\n            scope: false,\n            replace: false,\n            require: 'leaflet',\n            controller: function controller() {\n                _leafletCenter = $q.defer();\n                this.getCenter = function () {\n                    return _leafletCenter.promise;\n                };\n            },\n            link: function link(scope, element, attrs, controller) {\n                var leafletScope = controller.getLeafletScope(),\n                    centerModel = leafletScope[directiveName];\n\n                controller.getMap().then(function (map) {\n                    var defaults = leafletMapDefaults.getDefaults(attrs.id);\n\n                    if (attrs[directiveName].search(\"-\") !== -1) {\n                        $log.error(errorHeader + ' The \"center\" variable can\\'t use a \"-\" on its key name: \"' + attrs[directiveName] + '\".');\n                        map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n                        return;\n                    } else if (shouldInitializeMapWithBounds(leafletScope.bounds, centerModel)) {\n                        map.fitBounds(leafletBoundsHelpers.createLeafletBounds(leafletScope.bounds), leafletScope.bounds.options);\n                        centerModel = map.getCenter();\n                        safeApply(leafletScope, function (scope) {\n                            angular.extend(scope[directiveName], {\n                                lat: map.getCenter().lat,\n                                lng: map.getCenter().lng,\n                                zoom: map.getZoom(),\n                                autoDiscover: false\n                            });\n                        });\n                        safeApply(leafletScope, function (scope) {\n                            var mapBounds = map.getBounds();\n                            scope.bounds = {\n                                northEast: {\n                                    lat: mapBounds._northEast.lat,\n                                    lng: mapBounds._northEast.lng\n                                },\n                                southWest: {\n                                    lat: mapBounds._southWest.lat,\n                                    lng: mapBounds._southWest.lng\n                                }\n                            };\n                        });\n                    } else if (!isDefined(centerModel)) {\n                        $log.error(errorHeader + ' The \"center\" property is not defined in the main scope');\n                        map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n                        return;\n                    } else if (!(isDefined(centerModel.lat) && isDefined(centerModel.lng)) && !isDefined(centerModel.autoDiscover)) {\n                        angular.copy(defaults.center, centerModel);\n                    }\n\n                    var urlCenterHash, mapReady;\n                    if (attrs.urlHashCenter === \"yes\") {\n                        var extractCenterFromUrl = function extractCenterFromUrl() {\n                            var search = $location.search();\n                            var centerParam;\n                            var centerKey = attrs.urlHashParam ? attrs.urlHashParam : 'c';\n                            if (isDefined(search[centerKey])) {\n                                var cParam = search[centerKey].split(\":\");\n                                if (cParam.length === 3) {\n                                    centerParam = {\n                                        lat: parseFloat(cParam[0]),\n                                        lng: parseFloat(cParam[1]),\n                                        zoom: parseInt(cParam[2], 10)\n                                    };\n                                }\n                            }\n                            return centerParam;\n                        };\n                        urlCenterHash = extractCenterFromUrl();\n\n                        leafletScope.$on('$locationChangeSuccess', function (event) {\n                            var scope = event.currentScope;\n                            //$log.debug(\"updated location...\");\n                            var urlCenter = extractCenterFromUrl();\n                            if (isDefined(urlCenter) && !isSameCenterOnMap(urlCenter, map)) {\n                                //$log.debug(\"updating center model...\", urlCenter);\n                                angular.extend(scope[directiveName], {\n                                    lat: urlCenter.lat,\n                                    lng: urlCenter.lng,\n                                    zoom: urlCenter.zoom\n                                });\n                            }\n                        });\n                    }\n\n                    leafletScope.$watch(directiveName, function (center) {\n                        if (leafletScope.settingCenterFromLeaflet) return;\n                        //$log.debug(\"updated center model...\");\n                        // The center from the URL has priority\n                        if (isDefined(urlCenterHash)) {\n                            angular.copy(urlCenterHash, center);\n                            urlCenterHash = undefined;\n                        }\n\n                        if (!isValidCenter(center) && center.autoDiscover !== true) {\n                            $log.warn(errorHeader + \" invalid 'center'\");\n                            //map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n                            return;\n                        }\n\n                        if (center.autoDiscover === true) {\n                            if (!isNumber(center.zoom)) {\n                                map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n                            }\n                            if (isNumber(center.zoom) && center.zoom > defaults.center.zoom) {\n                                map.locate({\n                                    setView: true,\n                                    maxZoom: center.zoom\n                                });\n                            } else if (isDefined(defaults.maxZoom)) {\n                                map.locate({\n                                    setView: true,\n                                    maxZoom: defaults.maxZoom\n                                });\n                            } else {\n                                map.locate({\n                                    setView: true\n                                });\n                            }\n                            return;\n                        }\n\n                        if (mapReady && isSameCenterOnMap(center, map)) {\n                            //$log.debug(\"no need to update map again.\");\n                            return;\n                        }\n\n                        //$log.debug(\"updating map center...\", center);\n                        leafletScope.settingCenterFromScope = true;\n                        map.setView([center.lat, center.lng], center.zoom);\n                        leafletMapEvents.notifyCenterChangedToBounds(leafletScope, map);\n                        $timeout(function () {\n                            leafletScope.settingCenterFromScope = false;\n                            //$log.debug(\"allow center scope updates\");\n                        });\n                    }, true);\n\n                    map.whenReady(function () {\n                        mapReady = true;\n                    });\n\n                    map.on('moveend', function () /* event */{\n                        // Resolve the center after the first map position\n                        _leafletCenter.resolve();\n                        leafletMapEvents.notifyCenterUrlHashChanged(leafletScope, map, attrs, $location.search());\n                        //$log.debug(\"updated center on map...\");\n                        if (isSameCenterOnMap(centerModel, map) || leafletScope.settingCenterFromScope) {\n                            //$log.debug(\"same center in model, no need to update again.\");\n                            return;\n                        }\n                        leafletScope.settingCenterFromLeaflet = true;\n                        safeApply(leafletScope, function (scope) {\n                            if (!leafletScope.settingCenterFromScope) {\n                                //$log.debug(\"updating center model...\", map.getCenter(), map.getZoom());\n                                angular.extend(scope[directiveName], {\n                                    lat: map.getCenter().lat,\n                                    lng: map.getCenter().lng,\n                                    zoom: map.getZoom(),\n                                    autoDiscover: false\n                                });\n                            }\n                            leafletMapEvents.notifyCenterChangedToBounds(leafletScope, map);\n                            $timeout(function () {\n                                leafletScope.settingCenterFromLeaflet = false;\n                            });\n                        });\n                    });\n\n                    if (centerModel.autoDiscover === true) {\n                        map.on('locationerror', function () {\n                            $log.warn(errorHeader + \" The Geolocation API is unauthorized on this page.\");\n                            if (isValidCenter(centerModel)) {\n                                map.setView([centerModel.lat, centerModel.lng], centerModel.zoom);\n                                leafletMapEvents.notifyCenterChangedToBounds(leafletScope, map);\n                            } else {\n                                map.setView([defaults.center.lat, defaults.center.lng], defaults.center.zoom);\n                                leafletMapEvents.notifyCenterChangedToBounds(leafletScope, map);\n                            }\n                        });\n                    }\n                });\n            }\n        };\n    }];\n});\n\ncenterDirectiveTypes.forEach(function (dirType) {\n    angular.module('ui-leaflet').directive(dirType, centerDirectives[dirType]);\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('controls', function (leafletLogger, leafletHelpers, leafletControlHelpers) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: '?^leaflet',\n\n        link: function link(scope, element, attrs, controller) {\n            if (!controller) {\n                return;\n            }\n\n            var createControl = leafletControlHelpers.createControl;\n            var isValidControlType = leafletControlHelpers.isValidControlType;\n            var leafletScope = controller.getLeafletScope();\n            var isDefined = leafletHelpers.isDefined;\n            var isArray = leafletHelpers.isArray;\n            var leafletControls = {};\n            var errorHeader = leafletHelpers.errorHeader + ' [Controls] ';\n\n            scope.$on('$destroy', function () {\n                leafletControlHelpers.destroyMapLayersControl(scope.mapId);\n            });\n\n            controller.getMap().then(function (map) {\n\n                leafletScope.$watchCollection('controls', function (newControls) {\n\n                    // Delete controls from the array\n                    for (var name in leafletControls) {\n                        if (!isDefined(newControls[name])) {\n                            if (map.hasControl(leafletControls[name])) {\n                                map.removeControl(leafletControls[name]);\n                            }\n                            delete leafletControls[name];\n                        }\n                    }\n\n                    for (var newName in newControls) {\n                        var control;\n\n                        var controlType = isDefined(newControls[newName].type) ? newControls[newName].type : newName;\n\n                        if (!isValidControlType(controlType)) {\n                            $log.error(errorHeader + ' Invalid control type: ' + controlType + '.');\n                            return;\n                        }\n\n                        if (controlType !== 'custom') {\n                            control = createControl(controlType, newControls[newName]);\n                            map.addControl(control);\n                            leafletControls[newName] = control;\n                        } else {\n                            var customControlValue = newControls[newName];\n                            if (isArray(customControlValue)) {\n                                for (var i = 0; i < customControlValue.length; i++) {\n                                    var customControl = customControlValue[i];\n                                    map.addControl(customControl);\n                                    leafletControls[newName] = !isDefined(leafletControls[newName]) ? [customControl] : leafletControls[newName].concat([customControl]);\n                                }\n                            } else {\n                                map.addControl(customControlValue);\n                                leafletControls[newName] = customControlValue;\n                            }\n                        }\n                    }\n                });\n            });\n        }\n    };\n});\n\n\"use strict\";\n\nangular.module('ui-leaflet').directive(\"decorations\", function (leafletLogger, leafletHelpers) {\n\tvar $log = leafletLogger;\n\treturn {\n\t\trestrict: \"A\",\n\t\tscope: false,\n\t\treplace: false,\n\t\trequire: 'leaflet',\n\n\t\tlink: function link(scope, element, attrs, controller) {\n\t\t\tvar leafletScope = controller.getLeafletScope(),\n\t\t\t    PolylineDecoratorPlugin = leafletHelpers.PolylineDecoratorPlugin,\n\t\t\t    isDefined = leafletHelpers.isDefined,\n\t\t\t    leafletDecorations = {};\n\n\t\t\t/* Creates an \"empty\" decoration with a set of coordinates, but no pattern. */\n\t\t\tfunction createDecoration(options) {\n\t\t\t\tif (isDefined(options) && isDefined(options.coordinates)) {\n\t\t\t\t\tif (!PolylineDecoratorPlugin.isLoaded()) {\n\t\t\t\t\t\t$log.error('[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn L.polylineDecorator(options.coordinates);\n\t\t\t}\n\n\t\t\t/* Updates the path and the patterns for the provided decoration, and returns the decoration. */\n\t\t\tfunction setDecorationOptions(decoration, options) {\n\t\t\t\tif (isDefined(decoration) && isDefined(options)) {\n\t\t\t\t\tif (isDefined(options.coordinates) && isDefined(options.patterns)) {\n\t\t\t\t\t\tdecoration.setPaths(options.coordinates);\n\t\t\t\t\t\tdecoration.setPatterns(options.patterns);\n\t\t\t\t\t\treturn decoration;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontroller.getMap().then(function (map) {\n\t\t\t\tleafletScope.$watch(\"decorations\", function (newDecorations) {\n\t\t\t\t\tfor (var name in leafletDecorations) {\n\t\t\t\t\t\tif (!isDefined(newDecorations[name]) || !angular.equals(newDecorations[name], leafletDecorations)) {\n\t\t\t\t\t\t\tmap.removeLayer(leafletDecorations[name]);\n\t\t\t\t\t\t\tdelete leafletDecorations[name];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var newName in newDecorations) {\n\t\t\t\t\t\tvar decorationData = newDecorations[newName],\n\t\t\t\t\t\t    newDecoration = createDecoration(decorationData);\n\n\t\t\t\t\t\tif (isDefined(newDecoration)) {\n\t\t\t\t\t\t\tleafletDecorations[newName] = newDecoration;\n\t\t\t\t\t\t\tmap.addLayer(newDecoration);\n\t\t\t\t\t\t\tsetDecorationOptions(newDecoration, decorationData);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t});\n\t\t}\n\t};\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('eventBroadcast', function (leafletLogger, $rootScope, leafletHelpers, leafletMapEvents, leafletIterators) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n\n        link: function link(scope, element, attrs, controller) {\n            var isObject = leafletHelpers.isObject,\n                isDefined = leafletHelpers.isDefined,\n                leafletScope = controller.getLeafletScope(),\n                eventBroadcast = leafletScope.eventBroadcast,\n                availableMapEvents = leafletMapEvents.getAvailableMapEvents(),\n                addEvents = leafletMapEvents.addEvents;\n\n            controller.getMap().then(function (map) {\n\n                var mapEvents = [],\n                    logic = \"broadcast\";\n\n                // We have a possible valid object\n                if (!isDefined(eventBroadcast.map)) {\n                    // We do not have events enable/disable do we do nothing (all enabled by default)\n                    mapEvents = availableMapEvents;\n                } else if (!isObject(eventBroadcast.map)) {\n                    // Not a valid object\n                    $log.warn(\"[AngularJS - Leaflet] event-broadcast.map must be an object check your model.\");\n                } else {\n                    // We have a possible valid map object\n                    // Event propadation logic\n                    if (eventBroadcast.map.logic !== \"emit\" && eventBroadcast.map.logic !== \"broadcast\") {\n                        // This is an error\n                        $log.warn(\"[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'.\");\n                    } else {\n                        logic = eventBroadcast.map.logic;\n                    }\n\n                    if (!(isObject(eventBroadcast.map.enable) && eventBroadcast.map.enable.length >= 0)) {\n                        $log.warn(\"[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.\");\n                    } else {\n                        // Enable events\n                        leafletIterators.each(eventBroadcast.map.enable, function (eventName) {\n                            // Do we have already the event enabled?\n                            if (mapEvents.indexOf(eventName) === -1 && availableMapEvents.indexOf(eventName) !== -1) {\n                                mapEvents.push(eventName);\n                            }\n                        });\n                    }\n                }\n                // as long as the map is removed in the root leaflet directive we\n                // do not need ot clean up the events as leaflet does it itself\n                addEvents(map, attrs.id, mapEvents, \"eventName\", leafletScope, logic);\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('geojson', function ($timeout, leafletLogger, leafletData, leafletHelpers, leafletWatchHelpers, leafletDirectiveControlsHelpers, leafletIterators, leafletGeoJsonEvents) {\n    var _maybeWatch = leafletWatchHelpers.maybeWatch,\n        _defaultWatchOptions = leafletHelpers.watchOptions,\n        _extendDirectiveControls = leafletDirectiveControlsHelpers.extend,\n        hlp = leafletHelpers,\n        $it = leafletIterators,\n        watchTrap = { changeFromDirective: false };\n    // $log = leafletLogger;\n\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n\n        link: function link(scope, element, attrs, controller) {\n            var isDefined = leafletHelpers.isDefined,\n                leafletScope = controller.getLeafletScope(),\n                leafletGeoJSON = {},\n                _hasSetLeafletData = false;\n\n            controller.getMap().then(function (map) {\n                var watchOptions;\n                if (leafletScope.watchOptions && leafletScope.watchOptions.geojson) {\n                    watchOptions = leafletScope.watchOptions.geojson;\n                } else {\n                    watchOptions = _defaultWatchOptions;\n                }\n\n                var _hookUpEvents = function _hookUpEvents(geojson, maybeName) {\n                    var onEachFeature;\n\n                    if (angular.isFunction(geojson.onEachFeature)) {\n                        onEachFeature = geojson.onEachFeature;\n                    } else {\n                        onEachFeature = function onEachFeature(feature, layer) {\n                            if (leafletHelpers.LabelPlugin.isLoaded() && isDefined(feature.properties.description)) {\n                                layer.bindLabel(feature.properties.description);\n                            }\n\n                            leafletGeoJsonEvents.bindEvents(attrs.id, layer, null, feature, leafletScope, maybeName, { resetStyleOnMouseout: geojson.resetStyleOnMouseout,\n                                mapId: attrs.id });\n                        };\n                    }\n                    return onEachFeature;\n                };\n\n                var isNested = hlp.isDefined(attrs.geojsonNested) && hlp.isTruthy(attrs.geojsonNested);\n\n                var _clean = function _clean() {\n                    if (!leafletGeoJSON) return;\n                    var _remove = function _remove(lObject) {\n                        if (isDefined(lObject) && map.hasLayer(lObject)) {\n                            map.removeLayer(lObject);\n                        }\n                    };\n                    if (isNested) {\n                        $it.each(leafletGeoJSON, function (lObject) {\n                            _remove(lObject);\n                        });\n                        return;\n                    }\n                    _remove(leafletGeoJSON);\n                };\n\n                var _addGeojson = function _addGeojson(geojson, maybeName) {\n\n                    if (!(isDefined(geojson) && isDefined(geojson.data))) {\n                        return;\n                    }\n                    var onEachFeature = _hookUpEvents(geojson, maybeName);\n\n                    if (!isDefined(geojson.options)) {\n                        hlp.modelChangeInDirective(watchTrap, \"changeFromDirective\", function () {\n                            geojson.options = {\n                                style: geojson.style,\n                                filter: geojson.filter,\n                                onEachFeature: onEachFeature,\n                                pointToLayer: geojson.pointToLayer\n                            };\n                        });\n                    }\n\n                    var lObject = L.geoJson(geojson.data, geojson.options);\n\n                    if (maybeName && hlp.isString(maybeName)) {\n                        leafletGeoJSON[maybeName] = lObject;\n                    } else {\n                        leafletGeoJSON = lObject;\n                    }\n\n                    lObject.addTo(map);\n\n                    if (!_hasSetLeafletData) {\n                        //only do this once and play with the same ref forever\n                        _hasSetLeafletData = true;\n                        leafletData.setGeoJSON(leafletGeoJSON, attrs.id);\n                    }\n                };\n\n                var _create = function _create(model) {\n                    _clean();\n                    if (isNested) {\n                        if (!model || !Object.keys(model).length) return;\n                        $it.each(model, function (m, name) {\n                            //name could be layerName and or groupName\n                            //for now it is not tied to a layer\n                            _addGeojson(m, name);\n                        });\n                        return;\n                    }\n                    _addGeojson(model);\n                };\n\n                _extendDirectiveControls(attrs.id, 'geojson', _create, _clean);\n\n                _maybeWatch(leafletScope, 'geojson', watchOptions, function (geojson) {\n                    if (watchTrap.changeFromDirective) return;\n                    _create(geojson);\n                });\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('layercontrol', function ($filter, leafletLogger, leafletData, leafletHelpers) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"E\",\n        scope: {\n            icons: '=?',\n            autoHideOpacity: '=?', // Hide other opacity controls when one is activated.\n            showGroups: '=?', // Hide other opacity controls when one is activated.\n            title: '@',\n            baseTitle: '@',\n            overlaysTitle: '@'\n        },\n        replace: true,\n        transclude: false,\n        require: '^leaflet',\n        controller: function controller($scope, $element, $sce) {\n            $log.debug('[Angular Directive - Layers] layers', $scope, $element);\n            var safeApply = leafletHelpers.safeApply,\n                isDefined = leafletHelpers.isDefined;\n            angular.extend($scope, {\n                baselayer: '',\n                oldGroup: '',\n                layerProperties: {},\n                groupProperties: {},\n                rangeIsSupported: leafletHelpers.rangeIsSupported(),\n                changeBaseLayer: function changeBaseLayer(key, e) {\n                    leafletHelpers.safeApply($scope, function (scp) {\n                        scp.baselayer = key;\n                        leafletData.getMap().then(function (map) {\n                            leafletData.getLayers().then(function (leafletLayers) {\n                                if (map.hasLayer(leafletLayers.baselayers[key])) {\n                                    return;\n                                }\n                                for (var i in scp.layers.baselayers) {\n                                    scp.layers.baselayers[i].icon = scp.icons.unradio;\n                                    if (map.hasLayer(leafletLayers.baselayers[i])) {\n                                        map.removeLayer(leafletLayers.baselayers[i]);\n                                    }\n                                }\n                                map.addLayer(leafletLayers.baselayers[key]);\n                                scp.layers.baselayers[key].icon = $scope.icons.radio;\n                            });\n                        });\n                    });\n                    e.preventDefault();\n                },\n                moveLayer: function moveLayer(ly, newIndex, e) {\n                    var delta = Object.keys($scope.layers.baselayers).length;\n                    if (newIndex >= 1 + delta && newIndex <= $scope.overlaysArray.length + delta) {\n                        var oldLy;\n                        for (var key in $scope.layers.overlays) {\n                            if ($scope.layers.overlays[key].index === newIndex) {\n                                oldLy = $scope.layers.overlays[key];\n                                break;\n                            }\n                        }\n                        if (oldLy) {\n                            safeApply($scope, function () {\n                                oldLy.index = ly.index;\n                                ly.index = newIndex;\n                            });\n                        }\n                    }\n                    e.stopPropagation();\n                    e.preventDefault();\n                },\n                initIndex: function initIndex(layer, idx) {\n                    var delta = Object.keys($scope.layers.baselayers).length;\n                    layer.index = isDefined(layer.index) ? layer.index : idx + delta + 1;\n                },\n                initGroup: function initGroup(groupName) {\n                    $scope.groupProperties[groupName] = $scope.groupProperties[groupName] ? $scope.groupProperties[groupName] : {};\n                },\n                toggleOpacity: function toggleOpacity(e, layer) {\n                    if (layer.visible) {\n                        if ($scope.autoHideOpacity && !$scope.layerProperties[layer.name].opacityControl) {\n                            for (var k in $scope.layerProperties) {\n                                $scope.layerProperties[k].opacityControl = false;\n                            }\n                        }\n                        $scope.layerProperties[layer.name].opacityControl = !$scope.layerProperties[layer.name].opacityControl;\n                    }\n                    e.stopPropagation();\n                    e.preventDefault();\n                },\n                toggleLegend: function toggleLegend(layer) {\n                    $scope.layerProperties[layer.name].showLegend = !$scope.layerProperties[layer.name].showLegend;\n                },\n                showLegend: function showLegend(layer) {\n                    return layer.legend && $scope.layerProperties[layer.name].showLegend;\n                },\n                unsafeHTML: function unsafeHTML(html) {\n                    return $sce.trustAsHtml(html);\n                },\n                getOpacityIcon: function getOpacityIcon(layer) {\n                    return layer.visible && $scope.layerProperties[layer.name].opacityControl ? $scope.icons.close : $scope.icons.open;\n                },\n                getGroupIcon: function getGroupIcon(group) {\n                    return group.visible ? $scope.icons.check : $scope.icons.uncheck;\n                },\n                changeGroupVisibility: function changeGroupVisibility(groupName) {\n                    if (!isDefined($scope.groupProperties[groupName])) {\n                        return;\n                    }\n                    var visible = $scope.groupProperties[groupName].visible;\n                    for (var k in $scope.layers.overlays) {\n                        var layer = $scope.layers.overlays[k];\n                        if (layer.group === groupName) {\n                            layer.visible = visible;\n                        }\n                    }\n                }\n            });\n\n            var div = $element.get(0);\n            if (!L.Browser.touch) {\n                L.DomEvent.disableClickPropagation(div);\n                L.DomEvent.on(div, 'mousewheel', L.DomEvent.stopPropagation);\n            } else {\n                L.DomEvent.on(div, 'click', L.DomEvent.stopPropagation);\n            }\n        },\n        template: '<div class=\"angular-leaflet-control-layers\" ng-show=\"overlaysArray.length\">' + '<h4 ng-if=\"title\">{{ title }}</h4>' + '<div class=\"lf-baselayers\">' + '<h5 class=\"lf-title\" ng-if=\"baseTitle\">{{ baseTitle }}</h5>' + '<div class=\"lf-row\" ng-repeat=\"(key, layer) in baselayersArray\">' + '<label class=\"lf-icon-bl\" ng-click=\"changeBaseLayer(key, $event)\">' + '<input class=\"leaflet-control-layers-selector\" type=\"radio\" name=\"lf-radio\" ' + 'ng-show=\"false\" ng-checked=\"baselayer === key\" ng-value=\"key\" /> ' + '<i class=\"lf-icon lf-icon-radio\" ng-class=\"layer.icon\"></i>' + '<div class=\"lf-text\">{{layer.name}}</div>' + '</label>' + '</div>' + '</div>' + '<div class=\"lf-overlays\">' + '<h5 class=\"lf-title\" ng-if=\"overlaysTitle\">{{ overlaysTitle }}</h5>' + '<div class=\"lf-container\">' + '<div class=\"lf-row\" ng-repeat=\"layer in (o = (overlaysArray | orderBy:\\'index\\':order))\" ng-init=\"initIndex(layer, $index)\">' + '<label class=\"lf-icon-ol-group\" ng-if=\"showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group\">' + '<input class=\"lf-control-layers-selector\" type=\"checkbox\" ng-show=\"false\" ' + 'ng-change=\"changeGroupVisibility(layer.group)\" ng-model=\"groupProperties[layer.group].visible\"/> ' + '<i class=\"lf-icon lf-icon-check\" ng-class=\"getGroupIcon(groupProperties[layer.group])\"></i>' + '<div class=\"lf-text\">{{ layer.group }}</div>' + '</label>' + '<label class=\"lf-icon-ol\">' + '<input class=\"lf-control-layers-selector\" type=\"checkbox\" ng-show=\"false\" ng-model=\"layer.visible\"/> ' + '<i class=\"lf-icon lf-icon-check\" ng-class=\"layer.icon\"></i>' + '<div class=\"lf-text\">{{layer.name}}</div>' + '</label>' + '<div class=\"lf-icons\">' + '<i class=\"lf-icon lf-up\" ng-class=\"icons.up\" ng-click=\"moveLayer(layer, layer.index - orderNumber, $event)\"></i> ' + '<i class=\"lf-icon lf-down\" ng-class=\"icons.down\" ng-click=\"moveLayer(layer, layer.index + orderNumber, $event)\"></i> ' + '<i class=\"lf-icon lf-toggle-legend\" ng-class=\"icons.toggleLegend\" ng-if=\"layer.legend\" ng-click=\"toggleLegend(layer)\"></i> ' + '<i class=\"lf-icon lf-open\" ng-class=\"getOpacityIcon(layer)\" ng-click=\"toggleOpacity($event, layer)\"></i>' + '</div>' + '<div class=\"lf-legend\" ng-if=\"showLegend(layer)\" ng-bind-html=\"unsafeHTML(layer.legend)\"></div>' + '<div class=\"lf-opacity clearfix\" ng-if=\"layer.visible &amp;&amp; layerProperties[layer.name].opacityControl\">' + '<label ng-if=\"rangeIsSupported\" class=\"pull-left\" style=\"width: 50%\">0</label>' + '<label ng-if=\"rangeIsSupported\" class=\"pull-left text-right\" style=\"width: 50%\">100</label>' + '<input ng-if=\"rangeIsSupported\" class=\"clearfix\" type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" ' + 'class=\"lf-opacity-control\" ng-model=\"layerProperties[layer.name].layerOptions.opacity\"/>' + '<h6 ng-if=\"!rangeIsSupported\">Range is not supported in this browser</h6>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>',\n        link: function link(scope, element, attrs, controller) {\n            var isDefined = leafletHelpers.isDefined,\n                leafletScope = controller.getLeafletScope(),\n                layers = leafletScope.layers;\n\n            scope.$watch('icons', function () {\n                var defaultIcons = {\n                    uncheck: 'fa fa-square-o',\n                    check: 'fa fa-check-square-o',\n                    radio: 'fa fa-dot-circle-o',\n                    unradio: 'fa fa-circle-o',\n                    up: 'fa fa-angle-up',\n                    down: 'fa fa-angle-down',\n                    open: 'fa fa-angle-double-down',\n                    close: 'fa fa-angle-double-up',\n                    toggleLegend: 'fa fa-pencil-square-o'\n                };\n                if (isDefined(scope.icons)) {\n                    angular.extend(defaultIcons, scope.icons);\n                    angular.extend(scope.icons, defaultIcons);\n                } else {\n                    scope.icons = defaultIcons;\n                }\n            });\n\n            // Setting layer stack order.\n            attrs.order = isDefined(attrs.order) && (attrs.order === 'normal' || attrs.order === 'reverse') ? attrs.order : 'normal';\n            scope.order = attrs.order === 'normal';\n            scope.orderNumber = attrs.order === 'normal' ? -1 : 1;\n\n            scope.layers = layers;\n            controller.getMap().then(function (map) {\n                leafletScope.$watch('layers.baselayers', function (newBaseLayers) {\n                    var baselayersArray = {};\n                    leafletData.getLayers().then(function (leafletLayers) {\n                        var key;\n                        for (key in newBaseLayers) {\n                            var layer = newBaseLayers[key];\n                            layer.icon = scope.icons[map.hasLayer(leafletLayers.baselayers[key]) ? 'radio' : 'unradio'];\n                            baselayersArray[key] = layer;\n                        }\n                        scope.baselayersArray = baselayersArray;\n                    });\n                });\n\n                leafletScope.$watch('layers.overlays', function (newOverlayLayers) {\n                    var overlaysArray = [];\n                    var groupVisibleCount = {};\n                    leafletData.getLayers().then(function () {\n                        var key;\n                        for (key in newOverlayLayers) {\n                            var layer = newOverlayLayers[key];\n                            layer.icon = scope.icons[layer.visible ? 'check' : 'uncheck'];\n                            overlaysArray.push(layer);\n\n                            if (!isDefined(scope.layerProperties[layer.name])) {\n                                if (isDefined(layer.layerOptions.opacity)) {\n                                    layer.layerOptions.opacity = 1;\n                                }\n                                scope.layerProperties[layer.name] = {\n                                    opacityControl: false,\n                                    showLegend: true,\n                                    layerOptions: layer.layerOptions\n                                };\n                            }\n                            if (isDefined(layer.group)) {\n                                if (!isDefined(scope.groupProperties[layer.group])) {\n                                    scope.groupProperties[layer.group] = {\n                                        visible: false\n                                    };\n                                }\n                                groupVisibleCount[layer.group] = isDefined(groupVisibleCount[layer.group]) ? groupVisibleCount[layer.group] : {\n                                    count: 0,\n                                    visibles: 0\n                                };\n                                groupVisibleCount[layer.group].count++;\n                                if (layer.visible) {\n                                    groupVisibleCount[layer.group].visibles++;\n                                }\n                            }\n                            /*\n                            if(isDefined(layer.index) && leafletLayers.overlays[key].setZIndex) {\n                                leafletLayers.overlays[key].setZIndex(newOverlayLayers[key].index);\n                            }\n                            */\n                        }\n\n                        for (key in groupVisibleCount) {\n                            scope.groupProperties[key].visible = groupVisibleCount[key].visibles === groupVisibleCount[key].count;\n                        }\n                        scope.overlaysArray = overlaysArray;\n                    });\n                }, true);\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('layers', function (leafletLogger, $q, leafletData, leafletHelpers, leafletLayerHelpers, leafletControlHelpers) {\n    // var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n        controller: function controller($scope) {\n            $scope._leafletLayers = $q.defer();\n            this.getLayers = function () {\n                return $scope._leafletLayers.promise;\n            };\n        },\n        link: function link(scope, element, attrs, controller) {\n            var isDefined = leafletHelpers.isDefined,\n                leafletLayers = {},\n                leafletScope = controller.getLeafletScope(),\n                layers = leafletScope.layers,\n                createLayer = leafletLayerHelpers.createLayer,\n                safeAddLayer = leafletLayerHelpers.safeAddLayer,\n                safeRemoveLayer = leafletLayerHelpers.safeRemoveLayer,\n                changeOpacityListener = leafletLayerHelpers.changeOpacityListener,\n                updateLayersControl = leafletControlHelpers.updateLayersControl,\n                isLayersControlVisible = false;\n\n            scope.$on('$destroy', function () {\n                leafletControlHelpers.destroyMapLayersControl(scope.mapId);\n            });\n\n            controller.getMap().then(function (map) {\n\n                // We have baselayers to add to the map\n                scope._leafletLayers.resolve(leafletLayers);\n                leafletData.setLayers(leafletLayers, attrs.id);\n\n                leafletLayers.baselayers = {};\n                leafletLayers.overlays = {};\n\n                var mapId = attrs.id;\n\n                // Setup all baselayers definitions\n                var oneVisibleLayer = false;\n                for (var layerName in layers.baselayers) {\n                    var newBaseLayer = createLayer(layers.baselayers[layerName]);\n                    if (!isDefined(newBaseLayer)) {\n                        delete layers.baselayers[layerName];\n                        continue;\n                    }\n                    leafletLayers.baselayers[layerName] = newBaseLayer;\n                    // Only add the visible layer to the map, layer control manages the addition to the map\n                    // of layers in its control\n                    if (layers.baselayers[layerName].top === true) {\n                        safeAddLayer(map, leafletLayers.baselayers[layerName]);\n                        oneVisibleLayer = true;\n                    }\n                }\n\n                // If there is no visible layer add first to the map\n                if (!oneVisibleLayer && Object.keys(leafletLayers.baselayers).length > 0) {\n                    safeAddLayer(map, leafletLayers.baselayers[Object.keys(layers.baselayers)[0]]);\n                }\n\n                // Setup the Overlays\n                for (layerName in layers.overlays) {\n                    if (layers.overlays[layerName].type === 'cartodb') {}\n                    var newOverlayLayer = createLayer(layers.overlays[layerName]);\n                    if (!isDefined(newOverlayLayer)) {\n                        delete layers.overlays[layerName];\n                        continue;\n                    }\n                    leafletLayers.overlays[layerName] = newOverlayLayer;\n                    // Only add the visible overlays to the map\n                    if (layers.overlays[layerName].visible === true) {\n                        safeAddLayer(map, leafletLayers.overlays[layerName]);\n                    }\n                }\n\n                // Watch for the base layers\n                leafletScope.$watch('layers.baselayers', function (newBaseLayers, oldBaseLayers) {\n                    if (angular.equals(newBaseLayers, oldBaseLayers)) {\n                        isLayersControlVisible = updateLayersControl(map, mapId, isLayersControlVisible, newBaseLayers, layers.overlays, leafletLayers);\n                        return true;\n                    }\n                    // Delete layers from the array\n                    for (var name in leafletLayers.baselayers) {\n                        if (!isDefined(newBaseLayers[name]) || newBaseLayers[name].doRefresh) {\n                            // Remove from the map if it's on it\n                            if (map.hasLayer(leafletLayers.baselayers[name])) {\n                                map.removeLayer(leafletLayers.baselayers[name]);\n                            }\n                            delete leafletLayers.baselayers[name];\n\n                            if (newBaseLayers[name] && newBaseLayers[name].doRefresh) {\n                                newBaseLayers[name].doRefresh = false;\n                            }\n                        }\n                    }\n                    // add new layers\n                    for (var newName in newBaseLayers) {\n                        if (!isDefined(leafletLayers.baselayers[newName])) {\n                            var testBaseLayer = createLayer(newBaseLayers[newName]);\n                            if (isDefined(testBaseLayer)) {\n                                leafletLayers.baselayers[newName] = testBaseLayer;\n                                // Only add the visible layer to the map\n                                if (newBaseLayers[newName].top === true) {\n                                    safeAddLayer(map, leafletLayers.baselayers[newName]);\n                                }\n                            }\n                        } else {\n                            if (newBaseLayers[newName].top === true && !map.hasLayer(leafletLayers.baselayers[newName])) {\n                                safeAddLayer(map, leafletLayers.baselayers[newName]);\n                            } else if (newBaseLayers[newName].top === false && map.hasLayer(leafletLayers.baselayers[newName])) {\n                                map.removeLayer(leafletLayers.baselayers[newName]);\n                            }\n                        }\n                    }\n\n                    //we have layers, so we need to make, at least, one active\n                    var found = false;\n                    // search for an active layer\n                    for (var key in leafletLayers.baselayers) {\n                        if (map.hasLayer(leafletLayers.baselayers[key])) {\n                            found = true;\n                            break;\n                        }\n                    }\n                    // If there is no active layer make one active\n                    if (!found && Object.keys(leafletLayers.baselayers).length > 0) {\n                        safeAddLayer(map, leafletLayers.baselayers[Object.keys(leafletLayers.baselayers)[0]]);\n                    }\n\n                    // Only show the layers switch selector control if we have more than one baselayer + overlay\n                    isLayersControlVisible = updateLayersControl(map, mapId, isLayersControlVisible, newBaseLayers, layers.overlays, leafletLayers);\n                }, true);\n\n                // Watch for the overlay layers\n                leafletScope.$watch('layers.overlays', function (newOverlayLayers, oldOverlayLayers) {\n                    if (angular.equals(newOverlayLayers, oldOverlayLayers)) {\n                        isLayersControlVisible = updateLayersControl(map, mapId, isLayersControlVisible, layers.baselayers, newOverlayLayers, leafletLayers);\n                        return true;\n                    }\n\n                    // Delete layers from the array\n                    for (var name in leafletLayers.overlays) {\n                        if (!isDefined(newOverlayLayers[name]) || newOverlayLayers[name].doRefresh) {\n                            // Remove from the map if it's on it\n                            if (map.hasLayer(leafletLayers.overlays[name])) {\n                                // Safe remove when ArcGIS layers is loading.\n                                var options = isDefined(newOverlayLayers[name]) ? newOverlayLayers[name].layerOptions : null;\n                                safeRemoveLayer(map, leafletLayers.overlays[name], options);\n                            }\n                            // TODO: Depending on the layer type we will have to delete what's included on it\n                            delete leafletLayers.overlays[name];\n\n                            if (newOverlayLayers[name] && newOverlayLayers[name].doRefresh) {\n                                newOverlayLayers[name].doRefresh = false;\n                            }\n                        }\n                    }\n\n                    // add new overlays\n                    for (var newName in newOverlayLayers) {\n                        if (!isDefined(leafletLayers.overlays[newName])) {\n                            var testOverlayLayer = createLayer(newOverlayLayers[newName]);\n                            if (!isDefined(testOverlayLayer)) {\n                                // If the layer creation fails, continue to the next overlay\n                                continue;\n                            }\n                            leafletLayers.overlays[newName] = testOverlayLayer;\n                            if (newOverlayLayers[newName].visible === true) {\n                                safeAddLayer(map, leafletLayers.overlays[newName]);\n                            }\n\n                            if (isDefined(newOverlayLayers[newName].index) && leafletLayers.overlays[newName].setZIndex) {\n                                leafletLayers.overlays[newName].setZIndex(newOverlayLayers[newName].index);\n                            }\n                        } else {\n                            // check for the .visible property to hide/show overLayers\n                            if (newOverlayLayers[newName].visible && !map.hasLayer(leafletLayers.overlays[newName])) {\n                                safeAddLayer(map, leafletLayers.overlays[newName]);\n                            } else if (newOverlayLayers[newName].visible === false && map.hasLayer(leafletLayers.overlays[newName])) {\n                                // Safe remove when ArcGIS layers is loading.\n                                safeRemoveLayer(map, leafletLayers.overlays[newName], newOverlayLayers[newName].layerOptions);\n                            }\n\n                            // check for the .layerOptions.opacity property has changed.\n                            var ly = leafletLayers.overlays[newName];\n                            if (map.hasLayer(leafletLayers.overlays[newName])) {\n                                if (newOverlayLayers[newName].layerOptions.opacity !== oldOverlayLayers[newName].layerOptions.opacity) {\n\n                                    if (isDefined(ly.setOpacity)) {\n                                        ly.setOpacity(newOverlayLayers[newName].layerOptions.opacity);\n                                    }\n                                    if (isDefined(ly.getLayers) && isDefined(ly.eachLayer)) {\n                                        ly.eachLayer(changeOpacityListener(newOverlayLayers[newName].layerOptions.opacity));\n                                    }\n                                }\n\n                                if (isDefined(newOverlayLayers[newName].index) && ly.setZIndex && newOverlayLayers[newName].index !== oldOverlayLayers[newName].index) {\n                                    ly.setZIndex(newOverlayLayers[newName].index);\n                                }\n                            }\n                        }\n\n                        //refresh heatmap data if present\n                        if (newOverlayLayers[newName].visible && map._loaded && newOverlayLayers[newName].data && newOverlayLayers[newName].type === \"heatmap\") {\n                            leafletLayers.overlays[newName].setData(newOverlayLayers[newName].data);\n                            leafletLayers.overlays[newName].update();\n                        }\n                    }\n\n                    // Only add the layers switch selector control if we have more than one baselayer + overlay\n                    isLayersControlVisible = updateLayersControl(map, mapId, isLayersControlVisible, layers.baselayers, newOverlayLayers, leafletLayers);\n                }, true);\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module(\"ui-leaflet\").directive('legend', function (leafletLogger, $http, $timeout, leafletHelpers, leafletLegendHelpers) {\n    var $log = leafletLogger,\n        errorHeader = leafletHelpers.errorHeader + ' [Legend] ';\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n        transclude: false,\n\n        link: function link(scope, element, attrs, controller) {\n\n            var isArray = leafletHelpers.isArray,\n                isString = leafletHelpers.isString,\n                isDefined = leafletHelpers.isDefined,\n                isFunction = leafletHelpers.isFunction,\n                leafletScope = controller.getLeafletScope(),\n                legend = leafletScope.legend;\n\n            var legendClass;\n            var position;\n            var leafletLegend;\n            var type;\n\n            leafletScope.$watch('legend', function (newLegend) {\n\n                if (isDefined(newLegend)) {\n                    legendClass = newLegend.legendClass ? newLegend.legendClass : \"legend\";\n                    position = newLegend.position || 'bottomright';\n                    // default to arcgis\n                    type = newLegend.type || 'arcgis';\n                }\n            }, true);\n\n            var createLegend = function createLegend(map, legendData, newURL) {\n                if (legendData && legendData.layers && legendData.layers.length > 0) {\n                    if (isDefined(leafletLegend)) {\n                        leafletLegendHelpers.updateLegend(leafletLegend.getContainer(), legendData, type, newURL);\n                    } else {\n                        leafletLegend = L.control({\n                            position: position\n                        });\n                        leafletLegend.onAdd = leafletLegendHelpers.getOnAddLegend(legendData, legendClass, type, newURL);\n                        leafletLegend.addTo(map);\n                    }\n\n                    if (isDefined(legend.loadedData) && isFunction(legend.loadedData)) {\n                        legend.loadedData();\n                    }\n                }\n            };\n\n            controller.getMap().then(function (map) {\n                leafletScope.$watch('legend', function (newLegend) {\n                    if (!isDefined(newLegend)) {\n                        if (isDefined(leafletLegend)) {\n                            leafletLegend.removeFrom(map);\n                            leafletLegend = null;\n                        }\n\n                        return;\n                    }\n\n                    if (!isDefined(newLegend.url) && type === 'arcgis' && (!isArray(newLegend.colors) || !isArray(newLegend.labels) || newLegend.colors.length !== newLegend.labels.length)) {\n                        $log.warn(errorHeader + \" legend.colors and legend.labels must be set.\");\n                        return;\n                    }\n\n                    if (isDefined(newLegend.url)) {\n                        $log.info(errorHeader + \" loading legend service.\");\n                        return;\n                    }\n\n                    if (isDefined(leafletLegend)) {\n                        leafletLegend.removeFrom(map);\n                        leafletLegend = null;\n                    }\n\n                    leafletLegend = L.control({\n                        position: position\n                    });\n\n                    if (type === 'arcgis') {\n                        leafletLegend.onAdd = leafletLegendHelpers.getOnAddArrayLegend(newLegend, legendClass);\n                    }\n                    leafletLegend.addTo(map);\n                });\n\n                leafletScope.$watch('legend.url', function (newURL) {\n                    if (!isDefined(newURL)) {\n                        return;\n                    }\n\n                    if (!isArray(newURL) && !isString(newURL)) {\n                        $log.warn(errorHeader + \" legend.url must be an array or string.\");\n                        return;\n                    }\n\n                    var urls = isString(newURL) ? [newURL] : newURL;\n\n                    var legendData;\n                    var onResult = function onResult(idx, url) {\n                        return function (ld) {\n                            if (isDefined(ld.data.error)) {\n                                $log.warn(errorHeader + 'Error loadin legend from: ' + url, ld.data.error.message);\n                            } else {\n                                if (legendData && legendData.layers && legendData.layers.length > 0) {\n                                    legendData.layers = legendData.layers.concat(ld.data.layers);\n                                } else {\n                                    legendData = ld.data;\n                                }\n                            }\n\n                            if (idx === urls.length - 1) {\n                                createLegend(map, legendData, newURL);\n                            }\n                        };\n                    };\n                    var onError = function onError(err) {\n                        $log.warn(errorHeader + ' legend.url not loaded.', err);\n                    };\n\n                    for (var i = 0; i < urls.length; i++) {\n                        leafletLegendHelpers.addLegendURL(attrs.id, {\n                            url: urls[i],\n                            method: 'GET'\n                        }).then(onResult(i)).catch(onError);\n                    }\n                });\n\n                leafletScope.$watch('legend.legendData', function (legendData) {\n                    $log.debug('legendData', legendData);\n                    if (isDefined(leafletScope.legend.url) || !isDefined(legendData)) {\n                        return;\n                    }\n\n                    createLegend(map, legendData);\n                }, true);\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('markers', function (leafletLogger, $rootScope, $q, leafletData, leafletHelpers, leafletMapDefaults, leafletMarkersHelpers, leafletMarkerEvents, leafletIterators, leafletWatchHelpers, leafletDirectiveControlsHelpers) {\n    //less terse vars to helpers\n    var isDefined = leafletHelpers.isDefined,\n        errorHeader = leafletHelpers.errorHeader,\n        Helpers = leafletHelpers,\n        isString = leafletHelpers.isString,\n        addMarkerWatcher = leafletMarkersHelpers.addMarkerWatcher,\n        updateMarker = leafletMarkersHelpers.updateMarker,\n        listenMarkerEvents = leafletMarkersHelpers.listenMarkerEvents,\n        addMarkerToGroup = leafletMarkersHelpers.addMarkerToGroup,\n        createMarker = leafletMarkersHelpers.createMarker,\n        deleteMarker = leafletMarkersHelpers.deleteMarker,\n        getModelFromModels = leafletMarkersHelpers.getModelFromModels,\n        getLayerModels = leafletMarkersHelpers.getLayerModels,\n        resetUnusedMarkerGroups = leafletMarkersHelpers.resetUnusedMarkerGroups,\n        $it = leafletIterators,\n        _defaultWatchOptions = leafletHelpers.watchOptions,\n        maybeWatch = leafletWatchHelpers.maybeWatch,\n        extendDirectiveControls = leafletDirectiveControlsHelpers.extend,\n        $log = leafletLogger,\n        watchTrap = { changeFromDirective: false };\n\n    var _getLMarker = function _getLMarker(leafletMarkers, name, maybeLayerName) {\n        if (!Object.keys(leafletMarkers).length) return;\n        if (maybeLayerName && isString(maybeLayerName)) {\n            if (!leafletMarkers[maybeLayerName] || !Object.keys(leafletMarkers[maybeLayerName]).length) return;\n            return leafletMarkers[maybeLayerName][name];\n        }\n        return leafletMarkers[name];\n    };\n\n    var _setLMarker = function _setLMarker(lObject, leafletMarkers, name, maybeLayerName) {\n        if (maybeLayerName && isString(maybeLayerName)) {\n            if (!isDefined(leafletMarkers[maybeLayerName])) leafletMarkers[maybeLayerName] = {};\n            leafletMarkers[maybeLayerName][name] = lObject;\n        } else leafletMarkers[name] = lObject;\n        return lObject;\n    };\n\n    var _maybeAddMarkerToLayer = function _maybeAddMarkerToLayer(layerName, layers, model, marker, watchType, map) {\n\n        if (!isString(layerName)) {\n            $log.error(errorHeader + ' A layername must be a string');\n            return false;\n        }\n\n        if (!isDefined(layers)) {\n            $log.error(errorHeader + ' You must add layers to the directive if the markers are going to use this functionality.');\n            return false;\n        }\n\n        if (!isDefined(layers.overlays) || !isDefined(layers.overlays[layerName])) {\n            $log.error(errorHeader + ' A marker can only be added to a layer of type \"group\"');\n            return false;\n        }\n        var layerGroup = layers.overlays[layerName];\n        if (!(layerGroup instanceof L.LayerGroup || layerGroup instanceof L.FeatureGroup)) {\n            $log.error(errorHeader + ' Adding a marker to an overlay needs a overlay of the type \"group\" or \"featureGroup\"');\n            return false;\n        }\n\n        // The marker goes to a correct layer group, so first of all we add it\n        layerGroup.addLayer(marker);\n\n        // The marker is automatically added to the map depending on the visibility\n        // of the layer, so we only have to open the popup if the marker is in the map\n        if (watchType === null && map.hasLayer(marker) && model.focus === true) {\n            marker.openPopup();\n        }\n        return true;\n    };\n    //TODO: move to leafletMarkersHelpers??? or make a new class/function file (leafletMarkersHelpers is large already)\n    var _addMarkers = function _addMarkers(mapId, markersToRender, oldModels, map, layers, leafletMarkers, leafletScope, watchOptions, maybeLayerName, skips) {\n        $it.each(markersToRender, function (model, newName) {\n            if (skips[newName]) return;\n\n            if (newName.search(\"-\") !== -1) {\n                $log.error('The marker can\\'t use a \"-\" on his key name: \"' + newName + '\".');\n                return;\n            }\n\n            var pathToMarker = Helpers.getObjectDotPath(maybeLayerName ? [maybeLayerName, newName] : [newName]);\n            var maybeLMarker = _getLMarker(leafletMarkers, newName, maybeLayerName);\n            Helpers.modelChangeInDirective(watchTrap, \"changeFromDirective\", function () {\n                if (!isDefined(maybeLMarker)) {\n\n                    var marker = createMarker(model);\n                    var layerName = (model ? model.layer : undefined) || maybeLayerName; //original way takes pref\n                    if (!isDefined(marker)) {\n                        $log.error(errorHeader + ' Received invalid data on the marker ' + newName + '.');\n                        return;\n                    }\n                    _setLMarker(marker, leafletMarkers, newName, maybeLayerName);\n\n                    // Bind message\n                    if (isDefined(model.message)) {\n                        marker.bindPopup(model.message, model.popupOptions);\n                    }\n\n                    // Add the marker to a cluster group if needed\n                    if (isDefined(model.group)) {\n                        var groupOptions = isDefined(model.groupOption) ? model.groupOption : null;\n                        addMarkerToGroup(marker, model.group, groupOptions, map);\n                    }\n\n                    // Show label if defined\n                    if (Helpers.LabelPlugin.isLoaded() && isDefined(model.label) && isDefined(model.label.message)) {\n                        marker.bindLabel(model.label.message, model.label.options);\n                    }\n\n                    // Check if the marker should be added to a layer\n                    if (isDefined(model) && (isDefined(model.layer) || isDefined(maybeLayerName))) {\n\n                        var pass = _maybeAddMarkerToLayer(layerName, layers, model, marker, watchOptions.individual.type, map);\n                        if (!pass) return; //something went wrong move on in the loop\n                    } else if (!isDefined(model.group)) {\n                        // We do not have a layer attr, so the marker goes to the map layer\n                        map.addLayer(marker);\n                        if (watchOptions.individual.type === null && model.focus === true) {\n                            marker.openPopup();\n                        }\n                    }\n\n                    if (watchOptions.individual.type !== null) {\n                        addMarkerWatcher(marker, pathToMarker, leafletScope, layers, map, watchOptions.individual);\n                    }\n\n                    listenMarkerEvents(marker, model, leafletScope, watchOptions.individual.type, map);\n                    leafletMarkerEvents.bindEvents(mapId, marker, pathToMarker, model, leafletScope, layerName);\n                } else {\n                    var oldModel = getModelFromModels(oldModels, newName, maybeLayerName);\n                    updateMarker(model, oldModel, maybeLMarker, pathToMarker, leafletScope, layers, map);\n                }\n            });\n        });\n    };\n    var _seeWhatWeAlreadyHave = function _seeWhatWeAlreadyHave(markerModels, oldMarkerModels, lMarkers, isEqual, cb) {\n        var hasLogged = false,\n            equals = false,\n            oldMarker,\n            newMarker;\n\n        var doCheckOldModel = isDefined(oldMarkerModels);\n        for (var name in lMarkers) {\n            if (!hasLogged) {\n                $log.debug(errorHeader + \"[markers] destroy: \");\n                hasLogged = true;\n            }\n\n            if (doCheckOldModel) {\n                //might want to make the option (in watch options) to disable deep checking\n                //ie the options to only check !== (reference check) instead of angular.equals (slow)\n                newMarker = markerModels[name];\n                oldMarker = oldMarkerModels[name];\n                equals = isEqual && angular.equals(newMarker, oldMarker);\n            }\n            if (!isDefined(markerModels) || !Object.keys(markerModels).length || !isDefined(markerModels[name]) || !Object.keys(markerModels[name]).length || equals) {\n                if (cb && Helpers.isFunction(cb)) cb(newMarker, oldMarker, name);\n            }\n        }\n    };\n    var _destroy = function _destroy(markerModels, oldMarkerModels, lMarkers, map, layers) {\n        _seeWhatWeAlreadyHave(markerModels, oldMarkerModels, lMarkers, false, function (newMarker, oldMarker, lMarkerName) {\n            $log.debug(errorHeader + '[marker] is deleting marker: ' + lMarkerName);\n            deleteMarker(lMarkers[lMarkerName], map, layers);\n            delete lMarkers[lMarkerName];\n        });\n    };\n\n    var _getNewModelsToSkipp = function _getNewModelsToSkipp(newModels, oldModels, lMarkers) {\n        var skips = {};\n        _seeWhatWeAlreadyHave(newModels, oldModels, lMarkers, true, function (newMarker, oldMarker, lMarkerName) {\n            $log.debug(errorHeader + '[marker] is already rendered, marker: ' + lMarkerName);\n            skips[lMarkerName] = newMarker;\n        });\n        return skips;\n    };\n\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: ['leaflet', '?layers'],\n\n        link: function link(scope, element, attrs, controller) {\n            var mapController = controller[0],\n                leafletScope = mapController.getLeafletScope();\n\n            mapController.getMap().then(function (map) {\n                var leafletMarkers = {},\n                    getLayers;\n\n                // If the layers attribute is used, we must wait until the layers are created\n                if (isDefined(controller[1])) {\n                    getLayers = controller[1].getLayers;\n                } else {\n                    getLayers = function getLayers() {\n                        var deferred = $q.defer();\n                        deferred.resolve();\n                        return deferred.promise;\n                    };\n                }\n\n                var watchOptions;\n                if (leafletScope.watchOptions && leafletScope.watchOptions.markers) {\n                    watchOptions = leafletScope.watchOptions.markers;\n                } else {\n                    watchOptions = _defaultWatchOptions;\n                }\n\n                var isNested = isDefined(attrs.markersNested) && Helpers.isTruthy(attrs.markersNested);\n\n                getLayers().then(function (layers) {\n                    var _clean = function _clean(models, oldModels) {\n                        resetUnusedMarkerGroups();\n                        if (isNested) {\n                            $it.each(models, function (markerToMaybeDel, layerName) {\n                                var oldLayerModels = getLayerModels(oldModels, layerName);\n                                _destroy(markerToMaybeDel, oldLayerModels, leafletMarkers[layerName], map, layers);\n                            });\n                            return;\n                        }\n                        _destroy(models, oldModels, leafletMarkers, map, layers);\n                    };\n\n                    var _create = function _create(models, oldModels) {\n                        _clean(models, oldModels);\n                        var skips = null;\n                        if (isNested) {\n                            $it.each(models, function (markersToAdd, layerName) {\n                                var oldLayerModels = getLayerModels(oldModels, layerName);\n                                var newlayerModels = getLayerModels(models, layerName);\n                                skips = _getNewModelsToSkipp(newlayerModels, oldLayerModels, leafletMarkers[layerName]);\n                                _addMarkers(attrs.id, markersToAdd, oldModels, map, layers, leafletMarkers, leafletScope, watchOptions, layerName, skips);\n                            });\n                            return;\n                        }\n                        skips = _getNewModelsToSkipp(models, oldModels, leafletMarkers);\n                        _addMarkers(attrs.id, models, oldModels, map, layers, leafletMarkers, leafletScope, watchOptions, undefined, skips);\n                    };\n                    extendDirectiveControls(attrs.id, 'markers', _create, _clean);\n                    leafletData.setMarkers(leafletMarkers, attrs.id);\n\n                    maybeWatch(leafletScope, 'markers', watchOptions, function (newMarkers, oldMarkers) {\n                        if (watchTrap.changeFromDirective) return;\n                        _create(newMarkers, oldMarkers);\n                    });\n                    scope.$on('$destroy', function () {\n                        _destroy(leafletScope.markers, {}, leafletMarkers, map, layers);\n                    });\n                });\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('maxbounds', function (leafletLogger, leafletMapDefaults, leafletBoundsHelpers, leafletHelpers) {\n    // var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n\n        link: function link(scope, element, attrs, controller) {\n            var leafletScope = controller.getLeafletScope(),\n                isValidBounds = leafletBoundsHelpers.isValidBounds,\n                isNumber = leafletHelpers.isNumber;\n\n            controller.getMap().then(function (map) {\n                leafletScope.$watch(\"maxbounds\", function (maxbounds) {\n                    if (!isValidBounds(maxbounds)) {\n                        // Unset any previous maxbounds\n                        map.setMaxBounds();\n                        return;\n                    }\n\n                    var leafletBounds = leafletBoundsHelpers.createLeafletBounds(maxbounds);\n                    if (isNumber(maxbounds.pad)) {\n                        leafletBounds = leafletBounds.pad(maxbounds.pad);\n                    }\n\n                    map.setMaxBounds(leafletBounds);\n                    if (!attrs.center && !attrs.lfCenter) {\n                        map.fitBounds(leafletBounds);\n                    }\n                });\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('paths', function (leafletLogger, $q, leafletData, leafletMapDefaults, leafletHelpers, leafletPathsHelpers, leafletPathEvents, leafletWatchHelpers) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: ['leaflet', '?layers'],\n\n        link: function link(scope, element, attrs, controller) {\n            var mapController = controller[0],\n                isDefined = leafletHelpers.isDefined,\n                isString = leafletHelpers.isString,\n                leafletScope = mapController.getLeafletScope(),\n                paths = leafletScope.paths,\n                createPath = leafletPathsHelpers.createPath,\n                bindPathEvents = leafletPathEvents.bindPathEvents,\n                setPathOptions = leafletPathsHelpers.setPathOptions,\n                maybeWatch = leafletWatchHelpers.maybeWatch;\n\n            mapController.getMap().then(function (map) {\n                var defaults = leafletMapDefaults.getDefaults(attrs.id),\n                    getLayers;\n\n                // If the layers attribute is used, we must wait until the layers are created\n                if (isDefined(controller[1])) {\n                    getLayers = controller[1].getLayers;\n                } else {\n                    getLayers = function getLayers() {\n                        var deferred = $q.defer();\n                        deferred.resolve();\n                        return deferred.promise;\n                    };\n                }\n\n                if (!isDefined(paths)) {\n                    return;\n                }\n\n                //legacy behaviour does a watch collection on the paths\n                var _legacyWatchOptions = {\n                    type: 'watchCollection',\n                    individual: {\n                        type: 'watchDeep'\n                    }\n                };\n\n                var watchOptions;\n                if (leafletScope.watchOptions && leafletScope.watchOptions.paths) {\n                    watchOptions = leafletScope.watchOptions.paths;\n                } else {\n                    watchOptions = _legacyWatchOptions;\n                }\n\n                getLayers().then(function (layers) {\n\n                    var leafletPaths = {};\n                    leafletData.setPaths(leafletPaths, attrs.id);\n\n                    // Function for listening every single path once created\n                    var watchPathFn = function watchPathFn(leafletPath, name, watchOptions) {\n                        var pathWatchPath = \"paths[\\\"\" + name + \"\\\"]\";\n\n                        maybeWatch(leafletScope, pathWatchPath, watchOptions, function (pathData, old, clearWatch) {\n                            if (!isDefined(pathData)) {\n                                if (isDefined(old.layer)) {\n                                    for (var i in layers.overlays) {\n                                        var overlay = layers.overlays[i];\n                                        overlay.removeLayer(leafletPath);\n                                    }\n                                }\n                                map.removeLayer(leafletPath);\n                                clearWatch();\n                                return;\n                            }\n                            setPathOptions(leafletPath, pathData.type, pathData);\n                        });\n                    };\n\n                    var _clean = function _clean(newPaths) {\n                        // Delete paths (by name) from the array\n                        for (var name in leafletPaths) {\n                            if (!isDefined(newPaths[name])) {\n                                map.removeLayer(leafletPaths[name]);\n                                delete leafletPaths[name];\n                            }\n                        }\n                    };\n\n                    var _create = function _create(newPaths) {\n                        _clean(newPaths);\n                        // Create the new paths\n                        for (var newName in newPaths) {\n                            if (newName.search('\\\\$') === 0) {\n                                continue;\n                            }\n                            if (newName.search(\"-\") !== -1) {\n                                $log.error('[AngularJS - Leaflet] The path name \"' + newName + '\" is not valid. It must not include \"-\" and a number.');\n                                continue;\n                            }\n\n                            if (!isDefined(leafletPaths[newName])) {\n                                var pathData = newPaths[newName];\n                                var newPath = createPath(newName, newPaths[newName], defaults);\n\n                                // bind popup if defined\n                                if (isDefined(newPath) && isDefined(pathData.message)) {\n                                    newPath.bindPopup(pathData.message, pathData.popupOptions);\n                                }\n\n                                // Show label if defined\n                                if (leafletHelpers.LabelPlugin.isLoaded() && isDefined(pathData.label) && isDefined(pathData.label.message)) {\n                                    newPath.bindLabel(pathData.label.message, pathData.label.options);\n                                }\n\n                                // Check if the marker should be added to a layer\n                                if (isDefined(pathData) && isDefined(pathData.layer)) {\n\n                                    if (!isString(pathData.layer)) {\n                                        $log.error('[AngularJS - Leaflet] A layername must be a string');\n                                        continue;\n                                    }\n                                    if (!isDefined(layers)) {\n                                        $log.error('[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.');\n                                        continue;\n                                    }\n\n                                    if (!isDefined(layers.overlays) || !isDefined(layers.overlays[pathData.layer])) {\n                                        $log.error('[AngularJS - Leaflet] A path can only be added to a layer of type \"group\"');\n                                        continue;\n                                    }\n                                    var layerGroup = layers.overlays[pathData.layer];\n                                    if (!(layerGroup instanceof L.LayerGroup || layerGroup instanceof L.FeatureGroup)) {\n                                        $log.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type \"group\" or \"featureGroup\"');\n                                        continue;\n                                    }\n\n                                    // Listen for changes on the new path\n                                    leafletPaths[newName] = newPath;\n                                    // The path goes to a correct layer group, so first of all we add it\n                                    layerGroup.addLayer(newPath);\n\n                                    if (watchOptions.individual.type !== null) {\n                                        watchPathFn(newPath, newName, watchOptions.individual);\n                                    } else {\n                                        setPathOptions(newPath, pathData.type, pathData);\n                                    }\n                                } else if (isDefined(newPath)) {\n                                    // Listen for changes on the new path\n                                    leafletPaths[newName] = newPath;\n                                    map.addLayer(newPath);\n\n                                    if (watchOptions.individual.type !== null) {\n                                        watchPathFn(newPath, newName, watchOptions.individual);\n                                    } else {\n                                        setPathOptions(newPath, pathData.type, pathData);\n                                    }\n                                }\n\n                                bindPathEvents(attrs.id, newPath, newName, pathData, leafletScope);\n                            }\n                        }\n                    };\n\n                    maybeWatch(leafletScope, 'paths', watchOptions, function (newPaths) {\n                        _create(newPaths);\n                    });\n                });\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('tiles', function (leafletLogger, leafletData, leafletMapDefaults, leafletHelpers) {\n    var $log = leafletLogger;\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: 'leaflet',\n\n        link: function link(scope, element, attrs, controller) {\n            var isDefined = leafletHelpers.isDefined,\n                leafletScope = controller.getLeafletScope(),\n                tiles = leafletScope.tiles;\n\n            if (!isDefined(tiles) || !isDefined(tiles.url)) {\n                $log.warn(\"[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.\");\n                return;\n            }\n\n            controller.getMap().then(function (map) {\n                var defaults = leafletMapDefaults.getDefaults(attrs.id);\n                var tileLayerObj;\n                leafletScope.$watch(\"tiles\", function (tiles) {\n                    var tileLayerOptions = defaults.tileLayerOptions;\n                    var tileLayerUrl = defaults.tileLayer;\n\n                    // If no valid tiles are in the scope, remove the last layer\n                    if (!isDefined(tiles.url) && isDefined(tileLayerObj)) {\n                        map.removeLayer(tileLayerObj);\n                        return;\n                    }\n\n                    // No leafletTiles object defined yet\n                    if (!isDefined(tileLayerObj)) {\n                        if (isDefined(tiles.options)) {\n                            angular.copy(tiles.options, tileLayerOptions);\n                        }\n\n                        if (isDefined(tiles.url)) {\n                            tileLayerUrl = tiles.url;\n                        }\n\n                        tileLayerObj = L.tileLayer(tileLayerUrl, tileLayerOptions);\n                        tileLayerObj.addTo(map);\n                        leafletData.setTiles(tileLayerObj, attrs.id);\n                        return;\n                    }\n\n                    // If the options of the tilelayer is changed, we need to redraw the layer\n                    if (isDefined(tiles.url) && isDefined(tiles.options) && !angular.equals(tiles.options, tileLayerOptions)) {\n                        map.removeLayer(tileLayerObj);\n                        tileLayerOptions = defaults.tileLayerOptions;\n                        angular.copy(tiles.options, tileLayerOptions);\n                        tileLayerUrl = tiles.url;\n                        tileLayerObj = L.tileLayer(tileLayerUrl, tileLayerOptions);\n                        tileLayerObj.addTo(map);\n                        leafletData.setTiles(tileLayerObj, attrs.id);\n                        return;\n                    }\n\n                    // Only the URL of the layer is changed, update the tiles object\n                    if (isDefined(tiles.url)) {\n                        tileLayerObj.setUrl(tiles.url);\n                    }\n                }, true);\n            });\n        }\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').directive('watchOptions', ['$log', '$rootScope', '$q', 'leafletData', 'leafletHelpers', function (leafletLogger, $rootScope, $q, leafletData, leafletHelpers) {\n\n    var isDefined = leafletHelpers.isDefined,\n        errorHeader = leafletHelpers.errorHeader,\n        isObject = leafletHelpers.isObject,\n        $log = leafletLogger;\n\n    return {\n        restrict: \"A\",\n        scope: false,\n        replace: false,\n        require: ['leaflet'],\n\n        link: function link(scope, element, attrs, controller) {\n            var mapController = controller[0],\n                leafletScope = mapController.getLeafletScope();\n\n            var _isValidWatchType = function _isValidWatchType(type) {\n                return type === 'watch' || type === 'watchCollection' || type === 'watchDeep' || type === null;\n            };\n\n            if (isDefined(leafletScope.watchOptions) && isObject(leafletScope.watchOptions)) {\n                angular.forEach(['markers', 'geojson', 'paths'], function (name) {\n                    if (isDefined(leafletScope.watchOptions[name])) {\n                        if (!_isValidWatchType(leafletScope.watchOptions[name].type)) {\n                            $log.error(errorHeader + ' watchOptions.' + name + '.type is not a valid type.');\n                        }\n                        if (isDefined(leafletScope.watchOptions[name].individual)) {\n                            if (!_isValidWatchType(leafletScope.watchOptions[name].individual.type)) {\n                                $log.error(errorHeader + ' watchOptions.' + name + '.individual.type is not a valid type.');\n                            }\n                        } else {\n                            $log.error(errorHeader + ' watchOptions.' + name + '.type.individual must be defined.');\n                        }\n                    }\n                });\n            }\n        }\n    };\n}]);\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletEventsHelpersFactory', function ($rootScope, $q, leafletLogger, leafletHelpers) {\n    var safeApply = leafletHelpers.safeApply,\n        isDefined = leafletHelpers.isDefined,\n        isObject = leafletHelpers.isObject,\n        isArray = leafletHelpers.isArray,\n        errorHeader = leafletHelpers.errorHeader,\n        $log = leafletLogger;\n\n    var EventsHelper = function EventsHelper(rootBroadcastName, lObjectType) {\n        this.rootBroadcastName = rootBroadcastName;\n        $log.debug(\"leafletEventsHelpersFactory: lObjectType: \" + lObjectType + \"rootBroadcastName: \" + rootBroadcastName);\n        //used to path/key out certain properties based on the type , \"markers\", \"geojson\"\n        this.lObjectType = lObjectType;\n    };\n\n    EventsHelper.prototype.getAvailableEvents = function () {\n        return [];\n    };\n\n    /*\n     argument: name: Note this can be a single string or dot notation\n     Example:\n     markerModel : {\n     m1: { lat:_, lon: _}\n     }\n     //would yield name of\n     name = \"m1\"\n      If nested:\n     markerModel : {\n     cars: {\n     m1: { lat:_, lon: _}\n     }\n     }\n     //would yield name of\n     name = \"cars.m1\"\n     */\n    EventsHelper.prototype.genDispatchEvent = function (maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName, extra) {\n        var _this = this;\n\n        maybeMapId = maybeMapId || '';\n        if (maybeMapId) maybeMapId = '.' + maybeMapId;\n\n        return function (e) {\n            var broadcastName = _this.rootBroadcastName + maybeMapId + '.' + eventName;\n            $log.debug(broadcastName);\n            _this.fire(leafletScope, broadcastName, logic, e, e.target || lObject, model, name, layerName, extra);\n        };\n    };\n\n    EventsHelper.prototype.fire = function (scope, broadcastName, logic, event, lObject, model, modelName, layerName, extra) {\n        // Safely broadcast the event\n        safeApply(scope, function () {\n            var toSend = {\n                leafletEvent: event,\n                leafletObject: lObject,\n                modelName: modelName,\n                model: model\n            };\n            if (isDefined(layerName)) angular.extend(toSend, { layerName: layerName });\n\n            if (logic === \"emit\") {\n                scope.$emit(broadcastName, toSend);\n            } else {\n                $rootScope.$broadcast(broadcastName, toSend);\n            }\n        });\n    };\n\n    EventsHelper.prototype.bindEvents = function (maybeMapId, lObject, name, model, leafletScope, layerName, extra) {\n        var events = [];\n        var logic = 'emit';\n        var _this = this;\n\n        if (!isDefined(leafletScope.eventBroadcast)) {\n            // Backward compatibility, if no event-broadcast attribute, all events are broadcasted\n            events = this.getAvailableEvents();\n        } else if (!isObject(leafletScope.eventBroadcast)) {\n            // Not a valid object\n            $log.error(errorHeader + \"event-broadcast must be an object check your model.\");\n        } else {\n            // We have a possible valid object\n            if (!isDefined(leafletScope.eventBroadcast[_this.lObjectType])) {\n                // We do not have events enable/disable do we do nothing (all enabled by default)\n                events = this.getAvailableEvents();\n            } else if (!isObject(leafletScope.eventBroadcast[_this.lObjectType])) {\n                // Not a valid object\n                $log.warn(errorHeader + 'event-broadcast.' + [_this.lObjectType] + ' must be an object check your model.');\n            } else {\n                // We have a possible valid map object\n                // Event propadation logic\n                if (isDefined(leafletScope.eventBroadcast[this.lObjectType].logic)) {\n                    // We take care of possible propagation logic\n                    if (leafletScope.eventBroadcast[_this.lObjectType].logic !== \"emit\" && leafletScope.eventBroadcast[_this.lObjectType].logic !== \"broadcast\") $log.warn(errorHeader + \"Available event propagation logic are: 'emit' or 'broadcast'.\");\n                }\n                // Enable / Disable\n                var eventsEnable = false,\n                    eventsDisable = false;\n                if (isDefined(leafletScope.eventBroadcast[_this.lObjectType].enable) && isArray(leafletScope.eventBroadcast[_this.lObjectType].enable)) eventsEnable = true;\n                if (isDefined(leafletScope.eventBroadcast[_this.lObjectType].disable) && isArray(leafletScope.eventBroadcast[_this.lObjectType].disable)) eventsDisable = true;\n\n                if (eventsEnable && eventsDisable) {\n                    // Both are active, this is an error\n                    $log.warn(errorHeader + \"can not enable and disable events at the same time\");\n                } else if (!eventsEnable && !eventsDisable) {\n                    // Both are inactive, this is an error\n                    $log.warn(errorHeader + \"must enable or disable events\");\n                } else {\n                    // At this point the object is OK, lets enable or disable events\n                    if (eventsEnable) {\n                        // Enable events\n                        leafletScope.eventBroadcast[this.lObjectType].enable.forEach(function (eventName) {\n                            // Do we have already the event enabled?\n                            if (events.indexOf(eventName) !== -1) {\n                                // Repeated event, this is an error\n                                $log.warn(errorHeader + \"This event \" + eventName + \" is already enabled\");\n                            } else {\n                                // Does the event exists?\n                                if (_this.getAvailableEvents().indexOf(eventName) === -1) {\n                                    // The event does not exists, this is an error\n                                    $log.warn(errorHeader + \"This event \" + eventName + \" does not exist\");\n                                } else {\n                                    // All ok enable the event\n                                    events.push(eventName);\n                                }\n                            }\n                        });\n                    } else {\n                        // Disable events\n                        events = this.getAvailableEvents();\n                        leafletScope.eventBroadcast[_this.lObjectType].disable.forEach(function (eventName) {\n                            var index = events.indexOf(eventName);\n                            if (index === -1) {\n                                // The event does not exist\n                                $log.warn(errorHeader + \"This event \" + eventName + \" does not exist or has been already disabled\");\n                            } else {\n                                events.splice(index, 1);\n                            }\n                        });\n                    }\n                }\n            }\n        }\n\n        events.forEach(function (eventName) {\n            lObject.on(eventName, _this.genDispatchEvent(maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName, extra));\n        });\n        return logic;\n    };\n\n    return EventsHelper;\n}).service('leafletEventsHelpers', function (leafletEventsHelpersFactory) {\n    return new leafletEventsHelpersFactory();\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletGeoJsonEvents', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletEventsHelpersFactory, leafletData) {\n    var safeApply = leafletHelpers.safeApply,\n        EventsHelper = leafletEventsHelpersFactory;\n    // $log = leafletLogger;\n\n    var GeoJsonEvents = function GeoJsonEvents() {\n        EventsHelper.call(this, 'leafletDirectiveGeoJson', 'geojson');\n    };\n\n    GeoJsonEvents.prototype = new EventsHelper();\n\n    GeoJsonEvents.prototype.genDispatchEvent = function (maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName, extra) {\n        var base = EventsHelper.prototype.genDispatchEvent.call(this, maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName),\n            _this = this;\n\n        return function (e) {\n            if (eventName === 'mouseout') {\n                if (extra.resetStyleOnMouseout) {\n                    leafletData.getGeoJSON(extra.mapId).then(function (leafletGeoJSON) {\n                        //this is broken on nested needs to traverse or user layerName (nested)\n                        var lobj = layerName ? leafletGeoJSON[layerName] : leafletGeoJSON;\n                        lobj.resetStyle(e.target);\n                    });\n                }\n                safeApply(leafletScope, function () {\n                    $rootScope.$broadcast(_this.rootBroadcastName + '.mouseout', e);\n                });\n            }\n            base(e); //common\n        };\n    };\n\n    GeoJsonEvents.prototype.getAvailableEvents = function () {\n        return ['click', 'dblclick', 'mouseover', 'mouseout'];\n    };\n\n    return new GeoJsonEvents();\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletLabelEvents', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletEventsHelpersFactory) {\n    var Helpers = leafletHelpers,\n        EventsHelper = leafletEventsHelpersFactory;\n    //$log = leafletLogger;\n\n    var LabelEvents = function LabelEvents() {\n        EventsHelper.call(this, 'leafletDirectiveLabel', 'markers');\n    };\n    LabelEvents.prototype = new EventsHelper();\n\n    LabelEvents.prototype.genDispatchEvent = function (maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName) {\n        var markerName = name.replace('markers.', '');\n        return EventsHelper.prototype.genDispatchEvent.call(this, maybeMapId, eventName, logic, leafletScope, lObject, markerName, model, layerName);\n    };\n\n    LabelEvents.prototype.getAvailableEvents = function () {\n        return ['click', 'dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu'];\n    };\n\n    LabelEvents.prototype.genEvents = function (maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName) {\n        var _this = this;\n        var labelEvents = this.getAvailableEvents();\n        var scopeWatchName = Helpers.getObjectArrayPath(\"markers.\" + name);\n        labelEvents.forEach(function (eventName) {\n            lObject.label.on(eventName, _this.genDispatchEvent(maybeMapId, eventName, logic, leafletScope, lObject.label, scopeWatchName, model, layerName));\n        });\n    };\n\n    LabelEvents.prototype.bindEvents = function (maybeMapId, lObject, name, model, leafletScope, layerName) {};\n\n    return new LabelEvents();\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletMapEvents', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletEventsHelpers, leafletIterators) {\n    var isDefined = leafletHelpers.isDefined,\n        fire = leafletEventsHelpers.fire;\n\n    var _getAvailableMapEvents = function _getAvailableMapEvents() {\n        return ['click', 'dblclick', 'mousedown', 'mouseup', 'mouseover', 'mouseout', 'mousemove', 'contextmenu', 'focus', 'blur', 'preclick', 'load', 'unload', 'viewreset', 'movestart', 'move', 'moveend', 'dragstart', 'drag', 'dragend', 'zoomstart', 'zoomanim', 'zoomend', 'zoomlevelschange', 'resize', 'autopanstart', 'layeradd', 'layerremove', 'baselayerchange', 'overlayadd', 'overlayremove', 'locationfound', 'locationerror', 'popupopen', 'popupclose', 'draw:created', 'draw:edited', 'draw:deleted', 'draw:drawstart', 'draw:drawstop', 'draw:editstart', 'draw:editstop', 'draw:deletestart', 'draw:deletestop'];\n    };\n\n    var _genDispatchMapEvent = function _genDispatchMapEvent(scope, eventName, logic, maybeMapId) {\n        if (maybeMapId) {\n            maybeMapId = maybeMapId + '.';\n        }\n        return function (e) {\n            // Put together broadcast name\n            var broadcastName = 'leafletDirectiveMap.' + maybeMapId + eventName;\n            leafletLogger.debug(broadcastName);\n            // Safely broadcast the event\n            fire(scope, broadcastName, logic, e, e.target, scope);\n        };\n    };\n\n    var _notifyCenterChangedToBounds = function _notifyCenterChangedToBounds(scope) {\n        scope.$broadcast(\"boundsChanged\");\n    };\n\n    var _notifyCenterUrlHashChanged = function _notifyCenterUrlHashChanged(scope, map, attrs, search) {\n        if (!isDefined(attrs.urlHashCenter)) {\n            return;\n        }\n        var center = map.getCenter();\n        var centerUrlHash = center.lat.toFixed(4) + \":\" + center.lng.toFixed(4) + \":\" + map.getZoom();\n        if (!isDefined(search.c) || search.c !== centerUrlHash) {\n            //$log.debug(\"notified new center...\");\n            scope.$emit(\"centerUrlHash\", centerUrlHash);\n        }\n    };\n\n    var _addEvents = function _addEvents(map, mapId, mapEvents, contextName, scope, logic) {\n        leafletIterators.each(mapEvents, function (eventName) {\n            var context = {};\n            context[contextName] = eventName;\n            if (!mapId) {\n                mapId = map._container.id || '';\n            }\n\n            map.on(eventName, _genDispatchMapEvent(scope, eventName, logic, mapId), context);\n        });\n    };\n\n    return {\n        getAvailableMapEvents: _getAvailableMapEvents,\n        genDispatchMapEvent: _genDispatchMapEvent,\n        notifyCenterChangedToBounds: _notifyCenterChangedToBounds,\n        notifyCenterUrlHashChanged: _notifyCenterUrlHashChanged,\n        addEvents: _addEvents\n    };\n});\n\n'use strict';\n\nangular.module('ui-leaflet').factory('leafletMarkerEvents', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletEventsHelpersFactory, leafletLabelEvents) {\n    var safeApply = leafletHelpers.safeApply,\n        isDefined = leafletHelpers.isDefined,\n        Helpers = leafletHelpers,\n        lblHelp = leafletLabelEvents,\n        EventsHelper = leafletEventsHelpersFactory,\n        $log = leafletLogger;\n\n    var MarkerEvents = function MarkerEvents() {\n        EventsHelper.call(this, 'leafletDirectiveMarker', 'markers');\n    };\n\n    MarkerEvents.prototype = new EventsHelper();\n\n    MarkerEvents.prototype.genDispatchEvent = function (maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName) {\n        var handle = EventsHelper.prototype.genDispatchEvent.call(this, maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName);\n        return function (e) {\n            // Broadcast old marker click name for backwards compatibility\n            if (eventName === \"click\") {\n                safeApply(leafletScope, function () {\n                    $rootScope.$broadcast('leafletDirectiveMarkersClick', name);\n                });\n            } else if (eventName === 'dragend') {\n                safeApply(leafletScope, function () {\n                    model.lat = lObject.getLatLng().lat;\n                    model.lng = lObject.getLatLng().lng;\n                });\n                if (model.message && model.focus === true) {\n                    lObject.openPopup();\n                }\n            }\n            handle(e); //common\n        };\n    };\n\n    MarkerEvents.prototype.getAvailableEvents = function () {\n        return ['click', 'dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu', 'dragstart', 'drag', 'dragend', 'move', 'remove', 'popupopen', 'popupclose', 'touchend', 'touchstart', 'touchmove', 'touchcancel', 'touchleave'];\n    };\n\n    MarkerEvents.prototype.bindEvents = function (maybeMapId, lObject, name, model, leafletScope, layerName) {\n        var logic = EventsHelper.prototype.bindEvents.call(this, maybeMapId, lObject, name, model, leafletScope, layerName);\n\n        if (Helpers.LabelPlugin.isLoaded() && isDefined(lObject.label)) {\n            lblHelp.genEvents(maybeMapId, name, logic, leafletScope, lObject, model, layerName);\n        }\n    };\n\n    return new MarkerEvents();\n});\n\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nangular.module('ui-leaflet').factory('leafletPathEvents', function ($rootScope, $q, leafletLogger, leafletHelpers, leafletLabelEvents, leafletEventsHelpers) {\n    var isDefined = leafletHelpers.isDefined,\n        isObject = leafletHelpers.isObject,\n        Helpers = leafletHelpers,\n        errorHeader = leafletHelpers.errorHeader,\n        lblHelp = leafletLabelEvents,\n        fire = leafletEventsHelpers.fire,\n        $log = leafletLogger;\n\n    /*\n    TODO (nmccready) This EventsHelper needs to be derrived from leafletEventsHelpers to elminate copy and paste code.\n    */\n\n    var _genDispatchPathEvent = function _genDispatchPathEvent(maybeMapId, eventName, logic, leafletScope, lObject, name, model, layerName) {\n        maybeMapId = maybeMapId || '';\n\n        if (maybeMapId) maybeMapId = '.' + maybeMapId;\n\n        return function (e) {\n            var broadcastName = 'leafletDirectivePath' + maybeMapId + '.' + eventName;\n            $log.debug(broadcastName);\n            fire(leafletScope, broadcastName, logic, e, e.target || lObject, model, name, layerName);\n        };\n    };\n\n    var _bindPathEvents = function _bindPathEvents(maybeMapId, lObject, name, model, leafletScope) {\n        var pathEvents = [],\n            i,\n            eventName,\n            logic = \"broadcast\";\n\n        if (!isDefined(leafletScope.eventBroadcast)) {\n            // Backward compatibility, if no event-broadcast attribute, all events are broadcasted\n            pathEvents = _getAvailablePathEvents();\n        } else if (!isObject(leafletScope.eventBroadcast)) {\n            // Not a valid object\n            $log.error(errorHeader + \"event-broadcast must be an object check your model.\");\n        } else {\n            // We have a possible valid object\n            if (!isDefined(leafletScope.eventBroadcast.path)) {\n                // We do not have events enable/disable do we do nothing (all enabled by default)\n                pathEvents = _getAvailablePathEvents();\n            } else if (isObject(leafletScope.eventBroadcast.paths)) {\n                // Not a valid object\n                $log.warn(errorHeader + \"event-broadcast.path must be an object check your model.\");\n            } else {\n                // We have a possible valid map object\n                // Event propadation logic\n                if (leafletScope.eventBroadcast.path.logic !== undefined && leafletScope.eventBroadcast.path.logic !== null) {\n                    // We take care of possible propagation logic\n                    if (leafletScope.eventBroadcast.path.logic !== \"emit\" && leafletScope.eventBroadcast.path.logic !== \"broadcast\") {\n                        // This is an error\n                        $log.warn(errorHeader + \"Available event propagation logic are: 'emit' or 'broadcast'.\");\n                    } else if (leafletScope.eventBroadcast.path.logic === \"emit\") {\n                        logic = \"emit\";\n                    }\n                }\n                // Enable / Disable\n                var pathEventsEnable = false,\n                    pathEventsDisable = false;\n                if (leafletScope.eventBroadcast.path.enable !== undefined && leafletScope.eventBroadcast.path.enable !== null) {\n                    if (_typeof(leafletScope.eventBroadcast.path.enable) === 'object') {\n                        pathEventsEnable = true;\n                    }\n                }\n                if (leafletScope.eventBroadcast.path.disable !== undefined && leafletScope.eventBroadcast.path.disable !== null) {\n                    if (_typeof(leafletScope.eventBroadcast.path.disable) === 'object') {\n                        pathEventsDisable = true;\n                    }\n                }\n                if (pathEventsEnable && pathEventsDisable) {\n                    // Both are active, this is an error\n                    $log.warn(errorHeader + \"can not enable and disable events at the same time\");\n                } else if (!pathEventsEnable && !pathEventsDisable) {\n                    // Both are inactive, this is an error\n                    $log.warn(errorHeader + \"must enable or disable events\");\n                } else {\n                    // At this point the path object is OK, lets enable or disable events\n                    if (pathEventsEnable) {\n                        // Enable events\n                        for (i = 0; i < leafletScope.eventBroadcast.path.enable.length; i++) {\n                            eventName = leafletScope.eventBroadcast.path.enable[i];\n                            // Do we have already the event enabled?\n                            if (pathEvents.indexOf(eventName) !== -1) {\n                                // Repeated event, this is an error\n                                $log.warn(errorHeader + \"This event \" + eventName + \" is already enabled\");\n                            } else {\n                                // Does the event exists?\n                                if (_getAvailablePathEvents().indexOf(eventName) === -1) {\n                                    // The event does not exists, this is an error\n                                    $log.warn(errorHeader + \"This event \" + eventName + \" does not exist\");\n                                } else {\n                                    // All ok enable the event\n                                    pathEvents.push(eventName);\n                                }\n                            }\n                        }\n                    } else {\n                        // Disable events\n                        pathEvents = _getAvailablePathEvents();\n                        for (i = 0; i < leafletScope.eventBroadcast.path.disable.length; i++) {\n                            eventName = leafletScope.eventBroadcast.path.disable[i];\n                            var index = pathEvents.indexOf(eventName);\n                            if (index === -1) {\n                                // The event does not exist\n                                $log.warn(errorHeader + \"This event \" + eventName + \" does not exist or has been already disabled\");\n                            } else {\n                                pathEvents.splice(index, 1);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        for (i = 0; i < pathEvents.length; i++) {\n            eventName = pathEvents[i];\n            lObject.on(eventName, _genDispatchPathEvent(maybeMapId, eventName, logic, leafletScope, pathEvents, name));\n        }\n\n        if (Helpers.LabelPlugin.isLoaded() && isDefined(lObject.label)) {\n            lblHelp.genEvents(maybeMapId, name, logic, leafletScope, lObject, model);\n        }\n    };\n\n    var _getAvailablePathEvents = function _getAvailablePathEvents() {\n        return ['click', 'dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu', 'add', 'remove', 'popupopen', 'popupclose'];\n    };\n\n    return {\n        getAvailablePathEvents: _getAvailablePathEvents,\n        bindPathEvents: _bindPathEvents\n    };\n});\n\n}(angular));\n//# sourceMappingURL=ui-leaflet_dev_mapped.js.map"]}