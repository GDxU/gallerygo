{"version":3,"sources":["richmarker.js"],"names":[],"mappings":"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","file":"richmarker-compiled.js","sourcesContent":["// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @externs_url http://closure-compiler.googlecode.com/svn/trunk/contrib/externs/maps/google_maps_api_v3.js\n// @output_wrapper (function() {%output%})();\n// ==/ClosureCompiler==\n\n/**\n * @license\n * Copyright 2013 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A RichMarker that allows any HTML/DOM to be added to a map and be draggable.\n *\n * @param {Object.<string, *>=} opt_options Optional properties to set.\n * @extends {google.maps.OverlayView}\n * @constructor\n */\nfunction RichMarker(opt_options) {\n  var options = opt_options || {};\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.ready_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_ = false;\n\n  if (opt_options['visible'] == undefined) {\n    opt_options['visible'] = true;\n  }\n\n  if (opt_options['shadow'] == undefined) {\n    opt_options['shadow'] = '7px -3px 5px rgba(88,88,88,0.7)';\n  }\n\n  if (opt_options['anchor'] == undefined) {\n    opt_options['anchor'] = RichMarkerPosition['BOTTOM'];\n  }\n\n  this.setValues(options);\n}\nRichMarker.prototype = new google.maps.OverlayView();\nwindow['RichMarker'] = RichMarker;\n\n\n/**\n * Returns the current visibility state of the marker.\n *\n * @return {boolean} The visiblity of the marker.\n */\nRichMarker.prototype.getVisible = function() {\n  return /** @type {boolean} */ (this.get('visible'));\n};\nRichMarker.prototype['getVisible'] = RichMarker.prototype.getVisible;\n\n\n/**\n * Sets the visiblility state of the marker.\n *\n * @param {boolean} visible The visiblilty of the marker.\n */\nRichMarker.prototype.setVisible = function(visible) {\n  this.set('visible', visible);\n};\nRichMarker.prototype['setVisible'] = RichMarker.prototype.setVisible;\n\n\n/**\n *  The visible changed event.\n */\nRichMarker.prototype.visible_changed = function() {\n  if (this.ready_) {\n    this.markerWrapper_.style['display'] = this.getVisible() ? '' : 'none';\n    this.draw();\n  }\n};\nRichMarker.prototype['visible_changed'] = RichMarker.prototype.visible_changed;\n\n\n/**\n * Sets the marker to be flat.\n *\n * @param {boolean} flat If the marker is to be flat or not.\n */\nRichMarker.prototype.setFlat = function(flat) {\n  this.set('flat', !!flat);\n};\nRichMarker.prototype['setFlat'] = RichMarker.prototype.setFlat;\n\n\n/**\n * If the makrer is flat or not.\n *\n * @return {boolean} True the marker is flat.\n */\nRichMarker.prototype.getFlat = function() {\n  return /** @type {boolean} */ (this.get('flat'));\n};\nRichMarker.prototype['getFlat'] = RichMarker.prototype.getFlat;\n\n\n/**\n * Get the width of the marker.\n *\n * @return {Number} The width of the marker.\n */\nRichMarker.prototype.getWidth = function() {\n  return /** @type {Number} */ (this.get('width'));\n};\nRichMarker.prototype['getWidth'] = RichMarker.prototype.getWidth;\n\n\n/**\n * Get the height of the marker.\n *\n * @return {Number} The height of the marker.\n */\nRichMarker.prototype.getHeight = function() {\n  return /** @type {Number} */ (this.get('height'));\n};\nRichMarker.prototype['getHeight'] = RichMarker.prototype.getHeight;\n\n\n/**\n * Sets the marker's box shadow.\n *\n * @param {string} shadow The box shadow to set.\n */\nRichMarker.prototype.setShadow = function(shadow) {\n  this.set('shadow', shadow);\n  this.flat_changed();\n};\nRichMarker.prototype['setShadow'] = RichMarker.prototype.setShadow;\n\n\n/**\n * Gets the marker's box shadow.\n *\n * @return {string} The box shadow.\n */\nRichMarker.prototype.getShadow = function() {\n  return /** @type {string} */ (this.get('shadow'));\n};\nRichMarker.prototype['getShadow'] = RichMarker.prototype.getShadow;\n\n\n/**\n * Flat changed event.\n */\nRichMarker.prototype.flat_changed = function() {\n  if (!this.ready_) {\n    return;\n  }\n\n  this.markerWrapper_.style['boxShadow'] =\n      this.markerWrapper_.style['webkitBoxShadow'] =\n      this.markerWrapper_.style['MozBoxShadow'] =\n      this.getFlat() ? '' : this.getShadow();\n};\nRichMarker.prototype['flat_changed'] = RichMarker.prototype.flat_changed;\n\n\n/**\n * Sets the zIndex of the marker.\n *\n * @param {Number} index The index to set.\n */\nRichMarker.prototype.setZIndex = function(index) {\n  this.set('zIndex', index);\n};\nRichMarker.prototype['setZIndex'] = RichMarker.prototype.setZIndex;\n\n\n/**\n * Gets the zIndex of the marker.\n *\n * @return {Number} The zIndex of the marker.\n */\nRichMarker.prototype.getZIndex = function() {\n  return /** @type {Number} */ (this.get('zIndex'));\n};\nRichMarker.prototype['getZIndex'] = RichMarker.prototype.getZIndex;\n\n\n/**\n * zIndex changed event.\n */\nRichMarker.prototype.zIndex_changed = function() {\n  if (this.getZIndex() && this.ready_) {\n    this.markerWrapper_.style.zIndex = this.getZIndex();\n  }\n};\nRichMarker.prototype['zIndex_changed'] = RichMarker.prototype.zIndex_changed;\n\n/**\n * Whether the marker is draggable or not.\n *\n * @return {boolean} True if the marker is draggable.\n */\nRichMarker.prototype.getDraggable = function() {\n  return /** @type {boolean} */ (this.get('draggable'));\n};\nRichMarker.prototype['getDraggable'] = RichMarker.prototype.getDraggable;\n\n\n/**\n * Sets the marker to be draggable or not.\n *\n * @param {boolean} draggable If the marker is draggable or not.\n */\nRichMarker.prototype.setDraggable = function(draggable) {\n  this.set('draggable', !!draggable);\n};\nRichMarker.prototype['setDraggable'] = RichMarker.prototype.setDraggable;\n\n\n/**\n * Draggable property changed callback.\n */\nRichMarker.prototype.draggable_changed = function() {\n  if (this.ready_) {\n    if (this.getDraggable()) {\n      this.addDragging_(this.markerWrapper_);\n    } else {\n      this.removeDragListeners_();\n    }\n  }\n};\nRichMarker.prototype['draggable_changed'] =\n    RichMarker.prototype.draggable_changed;\n\n\n/**\n * Gets the postiton of the marker.\n *\n * @return {google.maps.LatLng} The position of the marker.\n */\nRichMarker.prototype.getPosition = function() {\n  return /** @type {google.maps.LatLng} */ (this.get('position'));\n};\nRichMarker.prototype['getPosition'] = RichMarker.prototype.getPosition;\n\n\n/**\n * Sets the position of the marker.\n *\n * @param {google.maps.LatLng} position The position to set.\n */\nRichMarker.prototype.setPosition = function(position) {\n  this.set('position', position);\n};\nRichMarker.prototype['setPosition'] = RichMarker.prototype.setPosition;\n\n\n/**\n * Position changed event.\n */\nRichMarker.prototype.position_changed = function() {\n  this.draw();\n};\nRichMarker.prototype['position_changed'] =\n    RichMarker.prototype.position_changed;\n\n\n/**\n * Gets the anchor.\n *\n * @return {google.maps.Size} The position of the anchor.\n */\nRichMarker.prototype.getAnchor = function() {\n  return /** @type {google.maps.Size} */ (this.get('anchor'));\n};\nRichMarker.prototype['getAnchor'] = RichMarker.prototype.getAnchor;\n\n\n/**\n * Sets the anchor.\n *\n * @param {RichMarkerPosition|google.maps.Size} anchor The anchor to set.\n */\nRichMarker.prototype.setAnchor = function(anchor) {\n  this.set('anchor', anchor);\n};\nRichMarker.prototype['setAnchor'] = RichMarker.prototype.setAnchor;\n\n\n/**\n * Anchor changed event.\n */\nRichMarker.prototype.anchor_changed = function() {\n  this.draw();\n};\nRichMarker.prototype['anchor_changed'] = RichMarker.prototype.anchor_changed;\n\n\n/**\n * Converts a HTML string to a document fragment.\n *\n * @param {string} htmlString The HTML string to convert.\n * @return {Node} A HTML document fragment.\n * @private\n */\nRichMarker.prototype.htmlToDocumentFragment_ = function(htmlString) {\n  var tempDiv = document.createElement('DIV');\n  tempDiv.innerHTML = htmlString;\n  if (tempDiv.childNodes.length == 1) {\n    return /** @type {!Node} */ (tempDiv.removeChild(tempDiv.firstChild));\n  } else {\n    var fragment = document.createDocumentFragment();\n    while (tempDiv.firstChild) {\n      fragment.appendChild(tempDiv.firstChild);\n    }\n    return fragment;\n  }\n};\n\n\n/**\n * Removes all children from the node.\n *\n * @param {Node} node The node to remove all children from.\n * @private\n */\nRichMarker.prototype.removeChildren_ = function(node) {\n  if (!node) {\n    return;\n  }\n\n  var child;\n  while (child = node.firstChild) {\n    node.removeChild(child);\n  }\n};\n\n\n/**\n * Sets the content of the marker.\n *\n * @param {string|Node} content The content to set.\n */\nRichMarker.prototype.setContent = function(content) {\n  this.set('content', content);\n};\nRichMarker.prototype['setContent'] = RichMarker.prototype.setContent;\n\n\n/**\n * Get the content of the marker.\n *\n * @return {string|Node} The marker content.\n */\nRichMarker.prototype.getContent = function() {\n  return /** @type {Node|string} */ (this.get('content'));\n};\nRichMarker.prototype['getContent'] = RichMarker.prototype.getContent;\n\n\n/**\n * Sets the marker content and adds loading events to images\n */\nRichMarker.prototype.content_changed = function() {\n  if (!this.markerContent_) {\n    // Marker content area doesnt exist.\n    return;\n  }\n\n  this.removeChildren_(this.markerContent_);\n  var content = this.getContent();\n  if (content) {\n    if (typeof content == 'string') {\n      content = content.replace(/^\\s*([\\S\\s]*)\\b\\s*$/, '$1');\n      content = this.htmlToDocumentFragment_(content);\n    }\n    this.markerContent_.appendChild(content);\n\n    var that = this;\n    var images = this.markerContent_.getElementsByTagName('IMG');\n    for (var i = 0, image; image = images[i]; i++) {\n      // By default, a browser lets a image be dragged outside of the browser,\n      // so by calling preventDefault we stop this behaviour and allow the image\n      // to be dragged around the map and now out of the browser and onto the\n      // desktop.\n      google.maps.event.addDomListener(image, 'mousedown', function(e) {\n        if (that.getDraggable()) {\n          if (e.preventDefault) {\n            e.preventDefault();\n          }\n          e.returnValue = false;\n        }\n      });\n\n      // Because we don't know the size of an image till it loads, add a\n      // listener to the image load so the marker can resize and reposition\n      // itself to be the correct height.\n      google.maps.event.addDomListener(image, 'load', function() {\n        that.draw();\n      });\n    }\n\n    google.maps.event.trigger(this, 'domready');\n  }\n\n  if (this.ready_) {\n    this.draw();\n  }\n};\nRichMarker.prototype['content_changed'] = RichMarker.prototype.content_changed;\n\n/**\n * Sets the cursor.\n *\n * @param {string} whichCursor What cursor to show.\n * @private\n */\nRichMarker.prototype.setCursor_ = function(whichCursor) {\n  if (!this.ready_) {\n    return;\n  }\n\n  var cursor = '';\n  if (navigator.userAgent.indexOf('Gecko/') !== -1) {\n    // Moz has some nice cursors :)\n    if (whichCursor == 'dragging') {\n      cursor = '-moz-grabbing';\n    }\n\n    if (whichCursor == 'dragready') {\n      cursor = '-moz-grab';\n    }\n\n    if (whichCursor == 'draggable') {\n      cursor = 'pointer';\n    }\n  } else {\n    if (whichCursor == 'dragging' || whichCursor == 'dragready') {\n      cursor = 'move';\n    }\n\n    if (whichCursor == 'draggable') {\n      cursor = 'pointer';\n    }\n  }\n\n  if (this.markerWrapper_.style.cursor != cursor) {\n    this.markerWrapper_.style.cursor = cursor;\n  }\n};\n\n/**\n * Start dragging.\n *\n * @param {Event} e The event.\n */\nRichMarker.prototype.startDrag = function(e) {\n  if (!this.getDraggable()) {\n    return;\n  }\n\n  if (!this.dragging_) {\n    this.dragging_ = true;\n    var map = this.getMap();\n    this.mapDraggable_ = map.get('draggable');\n    map.set('draggable', false);\n\n    // Store the current mouse position\n    this.mouseX_ = e.clientX;\n    this.mouseY_ = e.clientY;\n\n    this.setCursor_('dragready');\n\n    // Stop the text from being selectable while being dragged\n    this.markerWrapper_.style['MozUserSelect'] = 'none';\n    this.markerWrapper_.style['KhtmlUserSelect'] = 'none';\n    this.markerWrapper_.style['WebkitUserSelect'] = 'none';\n\n    this.markerWrapper_['unselectable'] = 'on';\n    this.markerWrapper_['onselectstart'] = function() {\n      return false;\n    };\n\n    this.addDraggingListeners_();\n\n    google.maps.event.trigger(this, 'dragstart');\n  }\n};\n\n\n/**\n * Stop dragging.\n */\nRichMarker.prototype.stopDrag = function() {\n  if (!this.getDraggable()) {\n    return;\n  }\n\n  if (this.dragging_) {\n    this.dragging_ = false;\n    this.getMap().set('draggable', this.mapDraggable_);\n    this.mouseX_ = this.mouseY_ = this.mapDraggable_ = null;\n\n    // Allow the text to be selectable again\n    this.markerWrapper_.style['MozUserSelect'] = '';\n    this.markerWrapper_.style['KhtmlUserSelect'] = '';\n    this.markerWrapper_.style['WebkitUserSelect'] = '';\n    this.markerWrapper_['unselectable'] = 'off';\n    this.markerWrapper_['onselectstart'] = function() {};\n\n    this.removeDraggingListeners_();\n\n    this.setCursor_('draggable');\n    google.maps.event.trigger(this, 'dragend');\n\n    this.draw();\n  }\n};\n\n\n/**\n * Handles the drag event.\n *\n * @param {Event} e The event.\n */\nRichMarker.prototype.drag = function(e) {\n  if (!this.getDraggable() || !this.dragging_) {\n    // This object isn't draggable or we have stopped dragging\n    this.stopDrag();\n    return;\n  }\n\n  var dx = this.mouseX_ - e.clientX;\n  var dy = this.mouseY_ - e.clientY;\n\n  this.mouseX_ = e.clientX;\n  this.mouseY_ = e.clientY;\n\n  var left = parseInt(this.markerWrapper_.style['left'], 10) - dx;\n  var top = parseInt(this.markerWrapper_.style['top'], 10) - dy;\n\n  this.markerWrapper_.style['left'] = left + 'px';\n  this.markerWrapper_.style['top'] = top + 'px';\n\n  var offset = this.getOffset_();\n\n  // Set the position property and adjust for the anchor offset\n  var point = new google.maps.Point(left - offset.width, top - offset.height);\n  var projection = this.getProjection();\n  this.setPosition(projection.fromDivPixelToLatLng(point));\n\n  this.setCursor_('dragging');\n  google.maps.event.trigger(this, 'drag');\n};\n\n\n/**\n * Removes the drag listeners associated with the marker.\n *\n * @private\n */\nRichMarker.prototype.removeDragListeners_ = function() {\n  if (this.draggableListener_) {\n    google.maps.event.removeListener(this.draggableListener_);\n    delete this.draggableListener_;\n  }\n  this.setCursor_('');\n};\n\n\n/**\n * Add dragability events to the marker.\n *\n * @param {Node} node The node to apply dragging to.\n * @private\n */\nRichMarker.prototype.addDragging_ = function(node) {\n  if (!node) {\n    return;\n  }\n\n  var that = this;\n  this.draggableListener_ =\n    google.maps.event.addDomListener(node, 'mousedown', function(e) {\n      that.startDrag(e);\n    });\n\n  this.setCursor_('draggable');\n};\n\n\n/**\n * Add dragging listeners.\n *\n * @private\n */\nRichMarker.prototype.addDraggingListeners_ = function() {\n  var that = this;\n  if (this.markerWrapper_.setCapture) {\n    this.markerWrapper_.setCapture(true);\n    this.draggingListeners_ = [\n      google.maps.event.addDomListener(this.markerWrapper_, 'mousemove', function(e) {\n        that.drag(e);\n      }, true),\n      google.maps.event.addDomListener(this.markerWrapper_, 'mouseup', function() {\n        that.stopDrag();\n        that.markerWrapper_.releaseCapture();\n      }, true)\n    ];\n  } else {\n    this.draggingListeners_ = [\n      google.maps.event.addDomListener(window, 'mousemove', function(e) {\n        that.drag(e);\n      }, true),\n      google.maps.event.addDomListener(window, 'mouseup', function() {\n        that.stopDrag();\n      }, true)\n    ];\n  }\n};\n\n\n/**\n * Remove dragging listeners.\n *\n * @private\n */\nRichMarker.prototype.removeDraggingListeners_ = function() {\n  if (this.draggingListeners_) {\n    for (var i = 0, listener; listener = this.draggingListeners_[i]; i++) {\n      google.maps.event.removeListener(listener);\n    }\n    this.draggingListeners_.length = 0;\n  }\n};\n\n\n/**\n * Get the anchor offset.\n *\n * @return {google.maps.Size} The size offset.\n * @private\n */\nRichMarker.prototype.getOffset_ = function() {\n  var anchor = this.getAnchor();\n  if (typeof anchor == 'object') {\n    return /** @type {google.maps.Size} */ (anchor);\n  }\n\n  var offset = new google.maps.Size(0, 0);\n  if (!this.markerContent_) {\n    return offset;\n  }\n\n  var width = this.markerContent_.offsetWidth;\n  var height = this.markerContent_.offsetHeight;\n\n  switch (anchor) {\n   case RichMarkerPosition['TOP_LEFT']:\n     break;\n   case RichMarkerPosition['TOP']:\n     offset.width = -width / 2;\n     break;\n   case RichMarkerPosition['TOP_RIGHT']:\n     offset.width = -width;\n     break;\n   case RichMarkerPosition['LEFT']:\n     offset.height = -height / 2;\n     break;\n   case RichMarkerPosition['MIDDLE']:\n     offset.width = -width / 2;\n     offset.height = -height / 2;\n     break;\n   case RichMarkerPosition['RIGHT']:\n     offset.width = -width;\n     offset.height = -height / 2;\n     break;\n   case RichMarkerPosition['BOTTOM_LEFT']:\n     offset.height = -height;\n     break;\n   case RichMarkerPosition['BOTTOM']:\n     offset.width = -width / 2;\n     offset.height = -height;\n     break;\n   case RichMarkerPosition['BOTTOM_RIGHT']:\n     offset.width = -width;\n     offset.height = -height;\n     break;\n  }\n\n  return offset;\n};\n\n\n/**\n * Adding the marker to a map.\n * Implementing the interface.\n */\nRichMarker.prototype.onAdd = function() {\n  if (!this.markerWrapper_) {\n    this.markerWrapper_ = document.createElement('DIV');\n    this.markerWrapper_.style['position'] = 'absolute';\n  }\n\n  if (this.getZIndex()) {\n    this.markerWrapper_.style['zIndex'] = this.getZIndex();\n  }\n\n  this.markerWrapper_.style['display'] = this.getVisible() ? '' : 'none';\n\n  if (!this.markerContent_) {\n    this.markerContent_ = document.createElement('DIV');\n    this.markerWrapper_.appendChild(this.markerContent_);\n\n    var that = this;\n    google.maps.event.addDomListener(this.markerContent_, 'click', function(e) {\n      google.maps.event.trigger(that, 'click');\n    });\n    google.maps.event.addDomListener(this.markerContent_, 'mouseover', function(e) {\n      google.maps.event.trigger(that, 'mouseover');\n    });\n    google.maps.event.addDomListener(this.markerContent_, 'mouseout', function(e) {\n      google.maps.event.trigger(that, 'mouseout');\n    });\n  }\n\n  this.ready_ = true;\n  this.content_changed();\n  this.flat_changed();\n  this.draggable_changed();\n\n  var panes = this.getPanes();\n  if (panes) {\n    panes.overlayMouseTarget.appendChild(this.markerWrapper_);\n  }\n\n  google.maps.event.trigger(this, 'ready');\n};\nRichMarker.prototype['onAdd'] = RichMarker.prototype.onAdd;\n\n\n/**\n * Impelementing the interface.\n */\nRichMarker.prototype.draw = function() {\n  if (!this.ready_ || this.dragging_) {\n    return;\n  }\n\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  var latLng = /** @type {google.maps.LatLng} */ (this.get('position'));\n  var pos = projection.fromLatLngToDivPixel(latLng);\n\n  var offset = this.getOffset_();\n  this.markerWrapper_.style['top'] = (pos.y + offset.height) + 'px';\n  this.markerWrapper_.style['left'] = (pos.x + offset.width) + 'px';\n\n  var height = this.markerContent_.offsetHeight;\n  var width = this.markerContent_.offsetWidth;\n\n  if (width != this.get('width')) {\n    this.set('width', width);\n  }\n\n  if (height != this.get('height')) {\n    this.set('height', height);\n  }\n};\nRichMarker.prototype['draw'] = RichMarker.prototype.draw;\n\n\n/**\n * Removing a marker from the map.\n * Implementing the interface.\n */\nRichMarker.prototype.onRemove = function() {\n  if (this.markerWrapper_ && this.markerWrapper_.parentNode) {\n    this.markerWrapper_.parentNode.removeChild(this.markerWrapper_);\n  }\n  this.removeDragListeners_();\n};\nRichMarker.prototype['onRemove'] = RichMarker.prototype.onRemove;\n\n\n/**\n * RichMarker Anchor positions\n * @enum {number}\n */\nvar RichMarkerPosition = {\n  'TOP_LEFT': 1,\n  'TOP': 2,\n  'TOP_RIGHT': 3,\n  'LEFT': 4,\n  'MIDDLE': 5,\n  'RIGHT': 6,\n  'BOTTOM_LEFT': 7,\n  'BOTTOM': 8,\n  'BOTTOM_RIGHT': 9\n};\nwindow['RichMarkerPosition'] = RichMarkerPosition;\n"]}